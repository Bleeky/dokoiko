if("undefined"==typeof jQuery)throw new Error("Froala requires jQuery");!function(t){"use strict";var e=function(i,s){this.options=t.extend({},e.DEFAULTS,t(i).data(),"object"==typeof s&&s),this.valid_nodes=t.merge([],e.VALID_NODES),this.valid_nodes=t.merge(this.valid_nodes,t.map(Object.keys(this.options.blockTags),function(t){return t.toUpperCase()})),this.browser=e.browser(),this.disabledList=[],this._id=++e.count,this._events={},this.blurred=!0,this.$original_element=t(i),this.document=i.ownerDocument,this.window="defaultView"in this.document?this.document.defaultView:this.document.parentWindow,this.$document=t(this.document),this.$window=t(this.window),this.br=this.browser.msie&&t.Editable.getIEversion()<=10?"":"<br/>",this.init(i),t(i).on("editable.focus",t.proxy(function(){for(var e=1;e<=t.Editable.count;e++)e!=this._id&&this.$window.trigger("blur."+e)},this))};e.initializers=[],e.count=0,e.VALID_NODES=["P","DIV","LI","TD","TH"],e.LANGS=[],e.INVISIBLE_SPACE="&#x200b;",e.DEFAULTS={allowComments:!0,allowedAttrs:["accept","accept-charset","accesskey","action","align","alt","async","autocomplete","autofocus","autoplay","autosave","background","bgcolor","border","charset","cellpadding","cellspacing","checked","cite","class","color","cols","colspan","contenteditable","contextmenu","controls","coords","data","data-.*","datetime","default","defer","dir","dirname","disabled","download","draggable","dropzone","enctype","for","form","formaction","headers","height","hidden","high","href","hreflang","icon","id","ismap","itemprop","keytype","kind","label","lang","language","list","loop","low","max","maxlength","media","method","min","multiple","name","novalidate","open","optimum","pattern","ping","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","reversed","rows","rowspan","sandbox","scope","scoped","scrolling","seamless","selected","shape","size","sizes","span","src","srcdoc","srclang","srcset","start","step","summary","spellcheck","style","tabindex","target","title","type","translate","usemap","value","valign","width","wrap"],allowedTags:["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","br","button","canvas","caption","cite","code","col","colgroup","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meter","nav","noscript","object","ol","optgroup","option","output","p","param","pre","progress","queue","rp","rt","ruby","s","samp","script","section","select","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],alwaysBlank:!1,alwaysVisible:!1,autosave:!1,autosaveInterval:1e4,beautifyCode:!0,blockTags:{n:"Normal",blockquote:"Quote",pre:"Code",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6"},buttons:["bold","italic","underline","strikeThrough","fontSize","fontFamily","color","sep","formatBlock","blockStyle","align","insertOrderedList","insertUnorderedList","outdent","indent","sep","createLink","insertImage","insertVideo","insertHorizontalRule","undo","redo","html"],crossDomain:!0,convertMailAddresses:!0,customButtons:{},customDropdowns:{},customText:!1,defaultTag:"P",direction:"ltr",disableRightClick:!1,editInPopup:!1,editorClass:"",formatTags:["p","pre","blockquote","h1","h2","h3","h4","h5","h6","div","ul","ol","li","table","tbody","thead","tfoot","tr","th","td"],headers:{},height:"auto",icons:{},inlineMode:!0,initOnClick:!1,language:"en_us",linkList:[],linkText:!1,linkClasses:{},linkAutoPrefix:!1,maxHeight:"auto",minHeight:"auto",multiLine:!0,noFollow:!0,paragraphy:!0,placeholder:"Type something",plainPaste:!1,preloaderSrc:"",saveURL:null,saveParams:{},saveRequestType:"POST",scrollableContainer:"body",simpleAmpersand:!1,shortcuts:!0,shortcutsAvailable:["show","bold","italic","underline","createLink","insertImage","indent","outdent","html","formatBlock n","formatBlock h1","formatBlock h2","formatBlock h3","formatBlock h4","formatBlock h5","formatBlock h6","formatBlock blockquote","formatBlock pre","strikeThrough"],showNextToCursor:!1,spellcheck:!1,theme:null,toolbarFixed:!0,trackScroll:!1,unlinkButton:!0,useClasses:!0,tabSpaces:!0,typingTimer:500,pastedImagesUploadRequestType:"POST",pastedImagesUploadURL:"http://i.froala.com/upload_base64",useFrTag:!1,width:"auto",withCredentials:!1,zIndex:2e3},e.prototype.destroy=function(){this.sync(),this.options.useFrTag&&this.addFrTag(),this.hide(),this.isHTML&&this.html(),this.$bttn_wrapper&&this.$bttn_wrapper.html("").removeData().remove(),this.$editor&&this.$editor.html("").removeData().remove(),this.raiseEvent("destroy"),this.$popup_editor&&this.$popup_editor.html("").removeData().remove(),this.$placeholder&&this.$placeholder.html("").removeData().remove(),clearTimeout(this.ajaxInterval),clearTimeout(this.typingTimer),this.$element.off("mousedown mouseup click keydown keyup cut copy paste focus keypress touchstart touchend touch drop"),this.$element.off("mousedown mouseup click keydown keyup cut copy paste focus keypress touchstart touchend touch drop","**"),this.$window.off("mouseup."+this._id),this.$window.off("keydown."+this._id),this.$window.off("keyup."+this._id),this.$window.off("blur."+this._id),this.$window.off("hide."+this._id),this.$window.off("scroll."+this._id),this.$window.off("orientationchange."+this._id),this.$document.off("selectionchange."+this._id),this.$original_element.off("editable"),void 0!==this.$upload_frame&&this.$upload_frame.remove(),this.$textarea&&(this.$box.remove(),this.$textarea.removeData("fa.editable"),this.$textarea.show());for(var t in this._events)delete this._events[t];this.$placeholder&&this.$placeholder.remove(),this.isLink?this.$element.removeData("fa.editable"):(this.$wrapper?this.$wrapper.replaceWith(this.getHTML(!1,!1)):this.$element.replaceWith(this.getHTML(!1,!1)),this.$box&&!this.editableDisabled&&(this.$box.removeClass("froala-box f-rtl"),this.$box.find(".html-switch").remove(),this.$box.removeData("fa.editable"),clearTimeout(this.typingTimer)))},e.prototype.triggerEvent=function(e,i,s,a){void 0===s&&(s=!0),void 0===a&&(a=!1),s===!0&&(this.isResizing()||this.editableDisabled||this.imageMode||!a||this.cleanify(),this.sync());var o=!0;return i||(i=[]),o=this.$original_element.triggerHandler("editable."+e,t.merge([this],i)),void 0===o?!0:o},e.prototype.syncCleanHTML=function(t,e){var i;if(e)for(i=t.replace(/<span((?!class\s*=\s*["']?f-marker["']?)[^>])*?><\/span>/gi,"");t!=i;)t=i,i=t.replace(/<span((?!class\s*=\s*["']?f-marker["']?)[^>])*?><\/span>/gi,"");else for(i=t.replace(/<span[^>]*?><\/span>/g,"");t!=i;)t=i,i=t.replace(/<span[^>]*?><\/span>/g,"");return t},e.prototype.sync=function(){if(!this.isHTML){this.raiseEvent("sync"),this.disableImageResize(),this.isLink||this.isImage||this.checkPlaceholder();var t=this.getHTML(!1,!1);this.trackHTML!==t&&null!=this.trackHTML?(this.refreshImageList(),this.refreshButtons(),this.trackHTML=t,this.$textarea&&this.$textarea.val(this.getHTML(!1,!0)),this.doingRedo||this.saveUndoStep(),this.triggerEvent("contentChanged",[],!1)):null==this.trackHTML&&(this.trackHTML=t)}},e.prototype.emptyElement=function(e){if("IMG"==e.tagName||t(e).find("img").length>0)return!1;if(t(e).find("input, iframe").length>0)return!1;for(var i=t(e).text(),s=0;s<i.length;s++)if("\n"!==i[s]&&"\r"!==i[s]&&"	"!==i[s]&&8203!=i[s].charCodeAt(0))return!1;return!0},e.prototype.initEvents=function(){this.mobile()?(this.mousedown="touchstart",this.mouseup="touchend",this.move="touchmove"):(this.mousedown="mousedown",this.mouseup="mouseup",this.move="")},e.prototype.continueInit=function(){this.initEvents(),this.browserFixes(),this.handleEnter(),this.editableDisabled||(this.initUndoRedo(),this.enableTyping(),this.initShortcuts()),this.initTabs(),this.initEditor();for(var e=0;e<t.Editable.initializers.length;e++)t.Editable.initializers[e].call(this);this.initOptions(),this.initEditorSelection(),this.initAjaxSaver(),this.setLanguage(),this.setCustomText(),this.editableDisabled||this.registerPaste(),this.refreshDisabledState(),this.refreshUndo(),this.refreshRedo(),this.initPopupSubmit(),this.initialized=!0,this.triggerEvent("initialized",[],!1,!1)},e.prototype.initPopupSubmit=function(){this.$popup_editor.find(".froala-popup input").keydown(function(e){var i=e.which;13==i&&(e.preventDefault(),e.stopPropagation(),t(this).blur(),t(this).parents(".froala-popup").find("button.f-submit").click())})},e.prototype.lateInit=function(){this.saveSelectionByMarkers(),this.continueInit(),this.restoreSelectionByMarkers(),this.$element.focus(),this.hideOtherEditors()},e.prototype.init=function(e){this.options.paragraphy||(this.options.defaultTag="DIV"),this.initElement(e),this.initElementStyle(),(!this.isLink||this.isImage)&&(this.initImageEvents(),this.buildImageMove()),this.options.initOnClick?(this.editableDisabled||(this.$element.attr("contenteditable",!0),this.$element.attr("spellcheck",!1)),this.$element.bind("mousedown.element",t.proxy(function(t){this.isLink||t.stopPropagation(),this.$element.unbind("mousedown.element"),this.lateInit()},this))):this.continueInit()},e.prototype.phone=function(){var t=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)}(navigator.userAgent||navigator.vendor||window.opera),t},e.prototype.mobile=function(){return this.phone()||this.android()||this.iOS()||this.blackberry()},e.prototype.iOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},e.prototype.iOSVersion=function(){if(/iP(hone|od|ad)/.test(navigator.platform)){var t=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),e=[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3]||0,10)];if(e&&e[0])return e[0]}return 0},e.prototype.iPad=function(){return/(iPad)/g.test(navigator.userAgent)},e.prototype.iPhone=function(){return/(iPhone)/g.test(navigator.userAgent)},e.prototype.iPod=function(){return/(iPod)/g.test(navigator.userAgent)},e.prototype.android=function(){return/(Android)/g.test(navigator.userAgent)},e.prototype.blackberry=function(){return/(Blackberry)/g.test(navigator.userAgent)},e.prototype.initOnTextarea=function(e){this.$textarea=t(e),void 0!==this.$textarea.attr("placeholder")&&"Type something"==this.options.placeholder&&(this.options.placeholder=this.$textarea.attr("placeholder")),this.$element=t("<div>").html(this.$textarea.val()),this.$textarea.before(this.$element).hide(),this.$textarea.parents("form").bind("submit",t.proxy(function(){this.isHTML?this.html():this.sync()},this)),this.addListener("destroy",t.proxy(function(){this.$textarea.parents("form").unbind("submit")},this))},e.prototype.initOnLink=function(e){this.isLink=!0,this.options.linkText=!0,this.selectionDisabled=!0,this.editableDisabled=!0,this.options.buttons=[],this.$element=t(e),this.options.paragraphy=!1,this.options.countCharacters=!1,this.$box=this.$element},e.prototype.initOnImage=function(e){var i=t(e).css("float");"A"==t(e).parent().get(0).tagName&&(e=t(e).parent()),this.isImage=!0,this.editableDisabled=!0,this.imageList=[],this.options.buttons=[],this.options.paragraphy=!1,this.options.imageMargin="auto",t(e).wrap("<div>"),this.$element=t(e).parent(),this.$element.css("display","inline-block"),this.$element.css("max-width","100%"),this.$element.css("margin-left","auto"),this.$element.css("margin-right","auto"),this.$element.css("float",i),this.$element.addClass("f-image"),this.$box=t(e)},e.prototype.initForPopup=function(e){this.$element=t(e),this.$box=this.$element,this.editableDisabled=!0,this.options.countCharacters=!1,this.options.buttons=[],this.$element.on("click",t.proxy(function(t){t.preventDefault()},this))},e.prototype.initOnDefault=function(e){"DIV"!=e.tagName&&this.options.buttons.indexOf("formatBlock")>=0&&this.disabledList.push("formatBlock"),this.$element=t(e)},e.prototype.initElement=function(e){"TEXTAREA"==e.tagName?this.initOnTextarea(e):"A"==e.tagName?this.initOnLink(e):"IMG"==e.tagName?this.initOnImage(e):this.options.editInPopup?this.initForPopup(e):this.initOnDefault(e),this.editableDisabled||(this.$box=this.$element.addClass("froala-box"),this.$wrapper=t('<div class="froala-wrapper">'),this.$element=t("<div>"),this.setHTML(this.$box.html(),!1),this.$textarea&&this.$textarea.html(this.$element.html()),this.$box.html(this.$wrapper.html(this.$element)),this.$element.on("keyup",t.proxy(function(){this.$element.find("ul, ol").length>1&&this.cleanupLists()},this))),this.$element.on("drop",t.proxy(function(){setTimeout(t.proxy(function(){t("html").click(),this.$element.find(".f-img-wrap").each(function(e,i){0===t(i).find("img").length&&t(i).remove()}),this.$element.find(this.options.defaultTag+":empty").remove()},this),1)},this)),this.sync()},e.prototype.trim=function(t){return t=String(t).replace(/^\s+|\s+$/g,""),t=t.replace(/\u200B/gi,"")},e.prototype.unwrapText=function(){this.options.paragraphy||this.$element.find(this.options.defaultTag).each(t.proxy(function(e,i){if(0===i.attributes.length){var s=t(i).find("br:last");t(i).replaceWith(s.length&&this.isLastSibling(s.get(0))?t(i).html():t(i).html()+"<br/>")}},this))},e.prototype.wrapTextInElement=function(e,i){void 0===i&&(i=!1);var s=[],a=["SPAN","A","B","I","EM","U","S","STRONG","STRIKE","FONT","IMG","SUB","SUP"],o=this;this.no_verify=!0;var n=function(){if(0===s.length)return!1;var e=t("<"+o.options.defaultTag+">"),i=t(s[0]);if(1==s.length&&"f-marker"==i.attr("class"))return void(s=[]);for(var a=0;a<s.length;a++){var n=t(s[a]);e.append(n.clone()),a==s.length-1?n.replaceWith(e):n.remove()}s=[]},r=!1,l=!1,d=!1;e.contents().filter(function(){var e=t(this);if(e.hasClass("f-marker")||e.find(".f-marker").length){var h=e;e.find(".f-marker").length&&(h=t(e.find(".f-marker")[0]));var p=h.prev();"true"===h.attr("data-type")?p.length&&t(p[0]).hasClass("f-marker")?d=!0:(r=!0,l=!1):l=!0}this.nodeType==Node.TEXT_NODE&&e.text().trim().length>0||a.indexOf(this.tagName)>=0?s.push(this):this.nodeType==Node.TEXT_NODE&&0===e.text().trim().length&&o.options.beautifyCode?e.remove():r||i||d?("BR"===this.tagName&&(s.length>0?e.remove():s.push(this)),n(),l&&(r=!1),d=!1):s=[]}),(r||i||d)&&n(),e.find("> "+this.options.defaultTag).each(function(e,i){0===t(i).text().trim().length&&0===t(i).find("img").length&&0===t(i).find("br").length&&t(i).append(this.br)}),e.find("div:empty:not([class])").remove(),e.is(":empty")&&e.append(o.options.paragraphy===!0?"<"+this.options.defaultTag+">"+this.br+"</"+this.options.defaultTag+">":this.br),this.no_verify=!1},e.prototype.wrapText=function(e){if(this.isImage||this.isLink)return!1;this.allow_div=!0,this.removeBlankSpans();for(var i=this.getSelectionElements(),s=0;s<i.length;s++){var a=t(i[s]);["LI","TH","TD"].indexOf(a.get(0).tagName)>=0?this.wrapTextInElement(a,!0):this.parents(a,"li").length?this.wrapTextInElement(t(this.parents(a,"li")[0]),e):this.wrapTextInElement(this.$element,e)}this.allow_div=!1},e.prototype.setHTML=function(e,i){this.no_verify=!0,this.allow_div=!0,void 0===i&&(i=!0),e=this.clean(e,!0,!1),e=e.replace(/>\s+</g,"><"),this.$element.html(e),this.$element.find("pre").each(function(e,i){var s=t(i),a=t(i).html();a.indexOf("\n")>=0&&s.html(a.replace(/\n/g,"<br>"))}),this.imageList=[],this.refreshImageList(),this.options.paragraphy&&this.wrapText(!0),this.$element.find("li:empty").append(t.Editable.INVISIBLE_SPACE),this.cleanupLists(),this.cleanify(!1,!0,!1),i&&(this.restoreSelectionByMarkers(),this.sync()),this.$element.find("span").attr("data-fr-verified",!0),this.initialized&&(this.hide(),this.closeImageMode(),this.imageMode=!1),this.no_verify=!1,this.allow_div=!1},e.prototype.beforePaste=function(){this.saveSelectionByMarkers(),this.clipboardHTML=null,this.scrollPosition=this.$window.scrollTop(),this.$pasteDiv=t('<div contenteditable="true" style="position: fixed; top: 0; left: -9999px; height: 100%; width: 0; z-index: 99999; line-height: 140%;"></div>').appendTo("body"),this.$pasteDiv.focus(),this.window.setTimeout(t.proxy(this.processPaste,this),1)},e.prototype.processPaste=function(){var i=this.clipboardHTML;null===this.clipboardHTML&&(i=this.$pasteDiv.html(),this.restoreSelectionByMarkers(),this.$window.scrollTop(this.scrollPosition));var s,a=this.triggerEvent("onPaste",[i],!1);"string"==typeof a&&(i=a),i=i.replace(/<img /gi,'<img data-fr-image-pasted="true" '),i.match(/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/gi)?(s=this.wordClean(i),s=this.clean(t("<div>").append(s).html(),!1,!0),s=this.removeEmptyTags(s)):(s=this.clean(i,!1,!0),s=this.removeEmptyTags(s),e.copiedText&&t("<div>").html(s).text().replace(/\u00A0/gi," ")==e.copiedText.replace(/(\u00A0|\r|\n)/gi," ")&&(s=e.copiedHTML)),this.options.plainPaste&&(s=this.plainPasteClean(s)),""!==s&&(this.insertHTML(s,!0,!0),this.saveSelectionByMarkers(),this.removeBlankSpans(),this.$element.find(this.valid_nodes.join(":empty, ")+":empty").remove(),this.restoreSelectionByMarkers(),this.$element.find("li[data-indent]").each(t.proxy(function(e,i){this.indentLi?(t(i).removeAttr("data-indent"),this.indentLi(t(i))):t(i).removeAttr("data-indent")},this)),this.$element.find("li").each(t.proxy(function(e,i){this.wrapTextInElement(t(i),!0)},this)),this.options.paragraphy&&this.wrapText(!0),this.cleanupLists()),this.afterPaste()},e.prototype.afterPaste=function(){this.uploadPastedImages(),this.checkPlaceholder(),this.pasting=!1,this.triggerEvent("afterPaste",[],!0,!0)},e.prototype.getSelectedHTML=function(){function e(e,s){for(;3==s.nodeType||i.valid_nodes.indexOf(s.tagName)<0;)3!=s.nodeType&&t(e).wrapInner("<"+s.tagName+i.attrs(s)+"></"+s.tagName+">"),s=s.parentNode}var i=this,s="";if("undefined"!=typeof window.getSelection)for(var a=this.getRanges(),o=0;o<a.length;o++){var n=document.createElement("div");n.appendChild(a[o].cloneContents()),e(n,this.getSelectionParent()),s+=n.innerHTML}else"undefined"!=typeof document.selection&&"Text"==document.selection.type&&(s=document.selection.createRange().htmlText);return s},e.prototype.registerPaste=function(){this.$element.on("copy cut",t.proxy(function(){e.copiedHTML=this.getSelectedHTML(),e.copiedText=t("<div>").html(e.copiedHTML).text()},this)),this.$element.on("paste",t.proxy(function(e){if(!this.isHTML){if(e.originalEvent&&(e=e.originalEvent),!this.triggerEvent("beforePaste",[],!1))return!1;if(this.clipboardPaste(e))return!1;this.clipboardHTML="",this.pasting=!0,this.scrollPosition=this.$window.scrollTop();var i=!1;if(e&&e.clipboardData&&e.clipboardData.getData){var s="",a=e.clipboardData.types;if(t.Editable.isArray(a))for(var o=0;o<a.length;o++)s+=a[o]+";";else s=a;if(/text\/html/.test(s)?this.clipboardHTML=e.clipboardData.getData("text/html"):/text\/rtf/.test(s)&&this.browser.safari?this.clipboardHTML=e.clipboardData.getData("text/rtf"):/text\/plain/.test(s)&&!this.browser.mozilla&&(this.clipboardHTML=e.clipboardData.getData("text/plain").replace(/\n/g,"<br/>")),""!==this.clipboardHTML?i=!0:this.clipboardHTML=null,i)return this.processPaste(),e.preventDefault&&(e.stopPropagation(),e.preventDefault()),!1}this.beforePaste()}},this))},e.prototype.clipboardPaste=function(e){if(e&&e.clipboardData&&e.clipboardData.items&&e.clipboardData.items[0]){var i=e.clipboardData.items[0].getAsFile();if(i){var s=new FileReader;return s.onload=t.proxy(function(t){var e=t.target.result;this.insertHTML('<img data-fr-image-pasted="true" src="'+e+'" />'),this.afterPaste()},this),s.readAsDataURL(i),!0}}return!1},e.prototype.uploadPastedImages=function(){this.$element.find("img[data-fr-image-pasted]").each(t.proxy(function(e,i){this.options.pasteImage?(0===i.src.indexOf("data:")?(this.options.defaultImageWidth&&t(i).attr("width",this.options.defaultImageWidth),this.options.pastedImagesUploadURL&&(setTimeout(t.proxy(function(){this.showImageLoader(),this.$progress_bar.find("span").css("width","100%").text("Please wait!"),this.showByCoordinates(t(i).offset().left+t(i).width()/2,t(i).offset().top+t(i).height()+10),this.isDisabled=!0},this),10),t.ajax({type:this.options.pastedImagesUploadRequestType,url:this.options.pastedImagesUploadURL,data:t.extend({image:decodeURIComponent(i.src)},this.options.imageUploadParams),crossDomain:this.options.crossDomain,xhrFields:{withCredentials:this.options.withCredentials},headers:this.options.headers,dataType:"json"}).done(t.proxy(function(e){try{if(e.link){var s=new Image;s.onerror=t.proxy(function(){t(i).remove(),this.hide(),this.throwImageError(1)},this),s.onload=t.proxy(function(){i.src=e.link,this.hideImageLoader(),this.hide(),this.enable(),setTimeout(function(){t(i).trigger("touchend")},50),this.triggerEvent("afterUploadPastedImage",[t(i)])},this),s.src=e.link}else e.error?(t(i).remove(),this.hide(),this.throwImageErrorWithMessage(e.error)):(t(i).remove(),this.hide(),this.throwImageError(2))}catch(a){t(i).remove(),this.hide(),this.throwImageError(4)}},this)).fail(t.proxy(function(){t(i).remove(),this.hide(),this.throwImageError(3)},this)))):0!==i.src.indexOf("http")&&t(i).remove(),t(i).removeAttr("data-fr-image-pasted")):t(i).remove()},this))},e.prototype.disable=function(){this.isDisabled=!0,this.$element.blur()},e.prototype.enable=function(){this.isDisabled=!1},e.prototype.wordClean=function(t){t.indexOf("<body")>=0&&(t=t.replace(/[.\s\S\w\W<>]*<body[^>]*>([.\s\S\w\W<>]*)<\/body>[.\s\S\w\W<>]*/g,"$1")),t=t.replace(/<p(.*?)class="?'?MsoListParagraph"?'? ([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ul><li>$3</li></ul>"),t=t.replace(/<p(.*?)class="?'?NumberedText"?'? ([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ol><li>$3</li></ol>"),t=t.replace(/<p(.*?)class="?'?MsoListParagraphCxSpFirst"?'?([\s\S]*?)(level\d)([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ul><li$3>$5</li>"),t=t.replace(/<p(.*?)class="?'?NumberedTextCxSpFirst"?'?([\s\S]*?)(level\d)([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<ol><li$3>$5</li>"),t=t.replace(/<p(.*?)class="?'?MsoListParagraphCxSpMiddle"?'?([\s\S]*?)(level\d)([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li>"),t=t.replace(/<p(.*?)class="?'?NumberedTextCxSpMiddle"?'?([\s\S]*?)(level\d)([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li>"),t=t.replace(/<p(.*?)class="?'?MsoListParagraphCxSpLast"?'?([\s\S]*?)(level\d)([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li></ul>"),t=t.replace(/<p(.*?)class="?'?NumberedTextCxSpLast"?'?([\s\S]*?)(level\d)([\s\S]*?)>([\s\S]*?)<\/p>/gi,"<li$3>$5</li></ol>"),t=t.replace(/<span([^<]*?)style="?'?mso-list:Ignore"?'?([\s\S]*?)>([\s\S]*?)<span/gi,"<span><span"),t=t.replace(/<!--\[if \!supportLists\]-->([\s\S]*?)<!--\[endif\]-->/gi,""),t=t.replace(/(\n|\r| class=(")?Mso[a-zA-Z0-9]+(")?)/gi," "),t=t.replace(/<!--[\s\S]*?-->/gi,""),t=t.replace(/<(\/)*(meta|link|span|\\?xml:|st1:|o:|font)(.*?)>/gi,"");for(var e=["style","script","applet","embed","noframes","noscript"],i=0;i<e.length;i++){var s=new RegExp("<"+e[i]+".*?"+e[i]+"(.*?)>","gi");t=t.replace(s,"")}t=t.replace(/([\w\-]*)=("[^<>"]*"|'[^<>']*'|\w+)/gi,""),t=t.replace(/&nbsp;/gi," ");var a;do a=t,t=t.replace(/<[^\/>][^>]*><\/[^>]+>/gi,"");while(t!=a);return t=t.replace(/<lilevel([^1])([^>]*)>/gi,'<li data-indent="true"$2>'),t=t.replace(/<lilevel1([^>]*)>/gi,"<li$1>"),t=this.clean(t),t=t.replace(/<a>(.[^<]+)<\/a>/gi,"$1")},e.prototype.tabs=function(t){for(var e="",i=0;t>i;i++)e+="  ";return e},e.prototype.cleanTags=function(t,e){void 0===e&&(e=!1);var i,s,a,o,n=this.options.formatTags,r=[],l=[],d=!1;for(s=0;s<t.length;s++)if(i=t.charAt(s),"<"==i){var h=t.indexOf(">",s+1);if(-1!==h){var p=t.substring(s,h+1),f=this.tagName(p);if(this.options.allowedTags.indexOf(f)<0){s=h;continue}if(0===f.indexOf("!")){l.push(p),s=h;continue}var c=this.isClosingTag(p);if("pre"===f&&(d=c?!1:!0),this.isSelfClosingTag(p))l.push("br"===f&&d?"\n":p);else if(c)for(a=!1,o=!0;a===!1&&void 0!==o;)o=r.pop(),void 0!==o&&o.tag_name!==f?l.splice(o.i,1):(a=!0,void 0!==o&&l.push(p));else l.push(p),r.push({tag_name:f,i:l.length-1});s=h}}else"\n"===i&&this.options.beautifyCode?e&&d&&l.push("<br/>"):"	"!==i&&l.push(i);for(;r.length>0;)o=r.pop(),l.splice(o.i,1);var u="\n";this.options.beautifyCode||(u=""),t="",r=0;var m=!0;for(s=0;s<l.length;s++)1==l[s].length?m&&" "===l[s]||(t+=l[s],m=!1):n.indexOf(this.tagName(l[s]).toLowerCase())<0?(t+=l[s],"br"==this.tagName(l[s])&&(t+=u)):this.isSelfClosingTag(l[s])?t+=l[s]:this.isClosingTag(l[s])?(r-=1,0===r&&(m=!0),t.length>0&&t[t.length-1]==u&&(t+=this.tabs(r)),t+=l[s]+u):(t+=u+this.tabs(r)+l[s],r+=1,m=!1);return t[0]==u&&(t=t.substring(1,t.length)),t[t.length-1]==u&&(t=t.substring(0,t.length-1)),t},e.prototype.cleanupLists=function(){this.$element.find("ul, ol").each(function(e,i){var s=t(i);if(s.find(".close-ul, .open-ul, .close-ol, .open-ol, .open-li, .close-li").length>0){var a="<"+i.tagName.toLowerCase()+">"+s.html()+"</"+i.tagName.toLowerCase()+">";a=a.replace(new RegExp('<span class="close-ul" data-fr-verified="true"></span>',"g"),"</ul>"),a=a.replace(new RegExp('<span class="open-ul" data-fr-verified="true"></span>',"g"),"<ul>"),a=a.replace(new RegExp('<span class="close-ol" data-fr-verified="true"></span>',"g"),"</ol>"),a=a.replace(new RegExp('<span class="open-ol" data-fr-verified="true"></span>',"g"),"<ol>"),a=a.replace(new RegExp('<span class="close-li" data-fr-verified="true"></span>',"g"),"</li>"),a=a.replace(new RegExp('<span class="open-li" data-fr-verified="true"></span>',"g"),"<li>"),s.replaceWith(a)}}),this.$element.find("li > td").remove(),this.$element.find("li td:empty").append(t.Editable.INVISIBLE_SPACE),this.$element.find("ul, ol").each(t.proxy(function(e,i){var s=t(i);0===s.find(this.valid_nodes.join(",")).length&&s.remove()},this)),this.$element.find("li > ul, li > ol").each(t.proxy(function(e,i){this.isFirstSibling(i)&&t(i).before("<br/>")},this)),this.$element.find("li:empty").remove();for(var e=this.$element.find("ol + ol, ul + ul"),i=0;i<e.length;i++){var s=t(e[i]);s.prev().append(s.html()),s.remove()}this.$element.find("li > td").remove(),this.$element.find("li td:empty").append(t.Editable.INVISIBLE_SPACE),this.$element.find("li > "+this.options.defaultTag).each(function(e,i){0===i.attributes.length&&t(i).replaceWith(t(i).html())})},e.prototype.clean=function(i,s,a,o,n){n||(n=t.merge([],this.options.allowedAttrs)),o||(o=t.merge([],this.options.allowedTags)),s||n.indexOf("id")>-1&&n.splice(n.indexOf("id"),1),this.options.allowComments?(this.options.allowedTags.push("!--"),this.options.allowedTags.push("!")):i=i.replace(/<!--.*?-->/gi,""),i=i.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""),i=i.replace(/<style\b[^<]*(?:(?!<\/style>)<[^<]*)*<\/style>/gi,"");var r=new RegExp("<\\/?((?!(?:"+o.join(" |")+" |"+o.join(">|")+">|"+o.join("/>|")+"/>))\\w+)[^>]*?>","gi");i=i.replace(r,"");var l=new RegExp("( (?!(?:"+n.join("|")+"))[a-zA-Z0-9-_]+)=((?:.(?!\\s+(?:\\S+)=|[>]|(\\/>)))+.)","gi");if(i=i.replace(/<\/?[^>]*?>/gi,function(t){return t.replace(l,"")}),this.pasting&&e.copiedText===t("<div>").html(i).text()&&(a=!1,s=!0),a){var d=new RegExp("style=(\"[a-zA-Z0-9:;\\.\\s\\(\\)\\-\\,!\\/'%]*\"|'[a-zA-Z0-9:;\\.\\s\\(\\)\\-\\,!\\/\"%]*')","gi");i=i.replace(d,""),i=i.replace(/<style\b[^<]*(?:(?!<\/style>)<[^<]*)*<\/style>/gi,"")}i=this.cleanTags(i,!0),i=i.replace(/(\r|\n)/gi,"");var h=new RegExp("<([^>]*)( src| href)=('[^']*'|\"[^\"]*\"|[^\\s>]+)([^>]*)>","gi");if(i=i.replace(h,t.proxy(function(t,e,i,s,a){return"<"+e+i+'="'+this.sanitizeURL(s.replace(/^["'](.*)["']\/?$/gi,"$1"))+'"'+a+">"},this)),!s){var p=t("<div>").append(i);p.find('[class]:not([class^="fr-"])').each(function(e,i){t(i).removeAttr("class")}),i=p.html()}return i},e.prototype.removeBlankSpans=function(){this.no_verify=!0,this.$element.find("span").removeAttr("data-fr-verified"),this.$element.find("span").each(t.proxy(function(e,i){0===this.attrs(i).length&&t(i).replaceWith(t(i).html())},this)),this.$element.find("span").attr("data-fr-verified",!0),this.no_verify=!1},e.prototype.plainPasteClean=function(e){var i=t("<div>").html(e);i.find("h1, h2, h3, h4, h5, h6, pre, blockquote").each(function(e,i){t(i).replaceWith("<"+this.options.defaultTag+">"+t(i).html()+"</"+this.options.defaultTag+">")});for(var s=function(e,i){t(i).replaceWith(t(i).html())};i.find("strong, em, strike, b, u, i, sup, sub, span, a").length;)i.find("strong, em, strike, b, u, i, sup, sub, span, a").each(s);return i.html()},e.prototype.removeEmptyTags=function(e){for(var i,s=t("<div>").html(e),a=s.find("*:empty:not(br, img, td, th)");a.length;){for(i=0;i<a.length;i++)t(a[i]).remove();a=s.find("*:empty:not(br, img, td, th)")}s.find("> div").each(function(e,i){t(i).replaceWith(t(i).html()+"<br/>")});for(var o=s.find("div");o.length;){for(i=0;i<o.length;i++){var n=t(o[i]),r=n.html().replace(/\u0009/gi,"").trim();n.replaceWith(r)}o=s.find("div")}return s.html()},e.prototype.initElementStyle=function(){this.editableDisabled||this.$element.attr("contenteditable",!0);var t="froala-view froala-element "+this.options.editorClass;this.browser.msie&&e.getIEversion()<9&&(t+=" ie8"),this.$element.css("outline",0),this.browser.msie||(t+=" not-msie"),this.$element.addClass(t)},e.prototype.CJKclean=function(t){var e=/[\u3041-\u3096\u30A0-\u30FF\u4E00-\u9FFF\u3130-\u318F\uAC00-\uD7AF]/gi;return t.replace(e,"")},e.prototype.enableTyping=function(){this.typingTimer=null,this.$element.on("keydown cut",t.proxy(function(e){if(!this.isHTML){if(!this.options.multiLine&&13==e.which)return e.preventDefault(),e.stopPropagation(),!1;if("keydown"===e.type&&!this.triggerEvent("keydown",[e],!1))return!1;clearTimeout(this.typingTimer),this.ajaxSave=!1,this.oldHTML=this.getHTML(!0,!1),this.typingTimer=setTimeout(t.proxy(function(){var t=this.getHTML(!0,!1);this.ime||this.CJKclean(t)===this.CJKclean(this.oldHTML)||this.CJKclean(t)!==t||this.sync()},this),Math.max(this.options.typingTimer,500))}},this))},e.prototype.removeMarkersByRegex=function(t){return t.replace(/<span[^>]*? class\s*=\s*["']?f-marker["']?[^>]+>([\S\s][^\/])*<\/span>/gi,"")},e.prototype.getImageHTML=function(){return JSON.stringify({src:this.$element.find("img").attr("src"),style:this.$element.find("img").attr("style"),alt:this.$element.find("img").attr("alt"),width:this.$element.find("img").attr("width"),link:this.$element.find("a").attr("href"),link_title:this.$element.find("a").attr("title"),link_target:this.$element.find("a").attr("target")})
},e.prototype.getLinkHTML=function(){return JSON.stringify({body:this.$element.html(),href:this.$element.attr("href"),title:this.$element.attr("title"),popout:this.$element.hasClass("popout"),nofollow:"nofollow"==this.$element.attr("ref"),blank:"_blank"==this.$element.attr("target"),cls:this.$element.attr("class")?this.$element.attr("class").replace(/froala-element ?|not-msie ?|froala-view ?/gi,"").trim():""})},e.prototype.addFrTag=function(){this.$element.find(this.valid_nodes.join(",")+", table, ul, ol, img").addClass("fr-tag")},e.prototype.removeFrTag=function(){this.$element.find(this.valid_nodes.join(",")+", table, ul, ol, img").removeClass("fr-tag")},e.prototype.getHTML=function(e,i,s){if(void 0===e&&(e=!1),void 0===i&&(i=this.options.useFrTag),void 0===s&&(s=!0),this.$element.hasClass("f-placeholder")&&!e)return"";if(this.isHTML)return this.$html_area.val();if(this.isImage)return this.getImageHTML();if(this.isLink)return this.getLinkHTML();this.$element.find("a").data("fr-link",!0),i&&this.addFrTag(),this.$element.find(".f-img-editor > img").each(t.proxy(function(e,i){t(i).removeClass("fr-fin fr-fil fr-fir fr-dib fr-dii").addClass(this.getImageClass(t(i).parent().attr("class")))},this)),this.options.useClasses||this.$element.find("img").each(t.proxy(function(e,i){var s=t(i);s.attr("data-style",this.getImageStyle(s))},this)),this.$element.find("pre").each(t.proxy(function(e,i){var s=t(i),a=s.html(),o=a.replace(/\&nbsp;/gi," ");a!=o&&(this.saveSelectionByMarkers(),s.html(o),this.restoreSelectionByMarkers())},this)),this.$element.find('[class=""]').removeAttr("class");var a=this.$element.html();if(this.removeFrTag(),a=this.syncCleanHTML(a,e),a=a.replace(/<a[^>]*?><\/a>/g,""),e||(a=this.removeMarkersByRegex(a)),a=a.replace(/<span[^>]*? class\s*=\s*["']?f-img-handle[^>]+><\/span>/gi,""),a=a.replace(/^([\S\s]*)<span[^>]*? class\s*=\s*["']?f-img-editor[^>]+>([\S\s]*)<\/span>([\S\s]*)$/gi,"$1$2$3"),a=a.replace(/^([\S\s]*)<span[^>]*? class\s*=\s*["']?f-img-wrap[^>]+>([\S\s]*)<\/span>([\S\s]*)$/gi,"$1$2$3"),this.options.useClasses||(a=a.replace(/data-style/gi,"style"),a=a.replace(/(<img[^>]*)( class\s*=['"]?[a-zA-Z0-9- ]+['"]?)([^>]*\/?>)/gi,"$1$3")),this.options.simpleAmpersand&&(a=a.replace(/\&amp;/gi,"&")),s&&(a=a.replace(/ data-fr-verified="true"/gi,"")),this.options.beautifyCode&&(a=a.replace(/\n/gi,"")),a=a.replace(/\u200B/gi,""),i){var o=this.triggerEvent("getHTML",[a],!1);if("string"==typeof o)return o}return a},e.prototype.getText=function(){return this.$element.text()},e.prototype.setDirty=function(t){this.dirty=t,t||(clearTimeout(this.ajaxInterval),this.ajaxHTML=this.getHTML(!1,!1))},e.prototype.initAjaxSaver=function(){this.ajaxHTML=this.getHTML(!1,!1),this.ajaxSave=!0,this.ajaxInterval=setInterval(t.proxy(function(){var t=this.getHTML(!1,!1);(this.ajaxHTML!=t||this.dirty)&&this.ajaxSave&&(this.options.autosave&&this.save(),this.dirty=!1,this.ajaxHTML=t),this.ajaxSave=!0},this),Math.max(this.options.autosaveInterval,100))},e.prototype.disableBrowserUndo=function(){this.$element.keydown(t.proxy(function(t){var e=t.which,i=(t.ctrlKey||t.metaKey)&&!t.altKey;if(!this.isHTML&&i){if(90==e&&t.shiftKey)return t.preventDefault(),!1;if(90==e)return t.preventDefault(),!1}},this))},e.prototype.shortcutEnabled=function(t){return this.options.shortcutsAvailable.indexOf(t)>=0},e.prototype.shortcuts_map={69:{cmd:"show",params:[null],id:"show"},66:{cmd:"exec",params:["bold"],id:"bold"},73:{cmd:"exec",params:["italic"],id:"italic"},85:{cmd:"exec",params:["underline"],id:"underline"},83:{cmd:"exec",params:["strikeThrough"],id:"strikeThrough"},75:{cmd:"exec",params:["createLink"],id:"createLink"},80:{cmd:"exec",params:["insertImage"],id:"insertImage"},221:{cmd:"exec",params:["indent"],id:"indent"},219:{cmd:"exec",params:["outdent"],id:"outdent"},72:{cmd:"exec",params:["html"],id:"html"},48:{cmd:"exec",params:["formatBlock","n"],id:"formatBlock n"},49:{cmd:"exec",params:["formatBlock","h1"],id:"formatBlock h1"},50:{cmd:"exec",params:["formatBlock","h2"],id:"formatBlock h2"},51:{cmd:"exec",params:["formatBlock","h3"],id:"formatBlock h3"},52:{cmd:"exec",params:["formatBlock","h4"],id:"formatBlock h4"},53:{cmd:"exec",params:["formatBlock","h5"],id:"formatBlock h5"},54:{cmd:"exec",params:["formatBlock","h6"],id:"formatBlock h6"},222:{cmd:"exec",params:["formatBlock","blockquote"],id:"formatBlock blockquote"},220:{cmd:"exec",params:["formatBlock","pre"],id:"formatBlock pre"}},e.prototype.ctrlKey=function(t){if(-1!=navigator.userAgent.indexOf("Mac OS X")){if(t.metaKey&&!t.altKey)return!0}else if(t.ctrlKey&&!t.altKey)return!0;return!1},e.prototype.initShortcuts=function(){this.options.shortcuts&&this.$element.on("keydown",t.proxy(function(t){var e=t.which,i=this.ctrlKey(t);if(!this.isHTML&&i){if(this.shortcuts_map[e]&&this.shortcutEnabled(this.shortcuts_map[e].id))return this.execDefaultShortcut(this.shortcuts_map[e].cmd,this.shortcuts_map[e].params);if(90==e&&t.shiftKey)return t.preventDefault(),t.stopPropagation(),this.redo(),!1;if(90==e)return t.preventDefault(),t.stopPropagation(),this.undo(),!1}},this))},e.prototype.initTabs=function(){this.$element.on("keydown",t.proxy(function(t){var e=t.which;if(9!=e||t.shiftKey)9==e&&t.shiftKey&&(this.raiseEvent("shift+tab")?this.options.tabSpaces?t.preventDefault():this.blur():t.preventDefault());else if(this.raiseEvent("tab"))if(this.options.tabSpaces){t.preventDefault();var i="&nbsp;&nbsp;&nbsp;&nbsp;",s=this.getSelectionElements()[0];"PRE"===s.tagName&&(i="    "),this.insertHTML(i,!1)}else this.blur();else t.preventDefault()},this))},e.prototype.textEmpty=function(e){var i=t(e).text().replace(/(\r\n|\n|\r|\t)/gm,"");return(""===i||e===this.$element.get(0))&&0===t(e).find("br").length},e.prototype.inEditor=function(t){for(;t&&"BODY"!==t.tagName;){if(t===this.$element.get(0))return!0;t=t.parentNode}return!1},e.prototype.focus=function(e){if(void 0===e&&(e=!0),""!==this.text()&&!this.$element.is(":focus"))return void(this.browser.msie||this.$element.focus());if(!this.isHTML){if(e&&!this.pasting&&this.$element.focus(),this.pasting&&!this.$element.is(":focus")&&this.$element.focus(),this.$element.hasClass("f-placeholder"))return void this.setSelection(this.$element.find(this.options.defaultTag).length>0?this.$element.find(this.options.defaultTag)[0]:this.$element.get(0));var i=this.getRange();if(""===this.text()&&i&&(0===i.startOffset||i.startContainer===this.$element.get(0)||!this.inEditor(i.startContainer))){var s,a,o=this.getSelectionElements();if(t.merge(["IMG","BR"],this.valid_nodes).indexOf(this.getSelectionElement().tagName)<0)return!1;if(i.startOffset>0&&this.valid_nodes.indexOf(this.getSelectionElement().tagName)>=0||i.startContainer&&3===i.startContainer.nodeType)return;if(!this.options.paragraphy&&o.length>=1&&o[0]===this.$element.get(0)){var n=function(e){if(!e)return null;if(3==e.nodeType&&e.textContent.length>0)return e;if(1==e.nodeType&&"BR"==e.tagName)return e;for(var i=t(e).contents(),s=0;s<i.length;s++){var a=n(i[s]);if(null!=a)return a}return null};if(0===i.startOffset&&this.$element.contents().length>0&&3!=this.$element.contents()[0].nodeType){var r=n(this.$element.get(0));null!=r&&("BR"==r.tagName?this.$element.is(":focus")&&(t(r).before(this.markers_html),this.restoreSelectionByMarkers()):this.setSelection(r))}return!1}if(o.length>=1&&o[0]!==this.$element.get(0))for(s=0;s<o.length;s++){if(a=o[s],!this.textEmpty(a)||this.browser.msie)return void this.setSelection(a);if(this.textEmpty(a)&&["LI","TD"].indexOf(a.tagName)>=0)return}if(i.startContainer===this.$element.get(0)&&i.startOffset>0&&!this.options.paragraphy)return void this.setSelection(this.$element.get(0),i.startOffset);for(o=this.$element.find(this.valid_nodes.join(",")),s=0;s<o.length;s++)if(a=o[s],!this.textEmpty(a)&&0===t(a).find(this.valid_nodes.join(",")).length)return void this.setSelection(a);this.setSelection(this.$element.get(0))}}},e.prototype.addMarkersAtEnd=function(e){var i=e.find(this.valid_nodes.join(", "));0===i.length&&i.push(e.get(0));var s=i[i.length-1];t(s).append(this.markers_html)},e.prototype.setFocusAtEnd=function(t){void 0===t&&(t=this.$element),this.addMarkersAtEnd(t),this.restoreSelectionByMarkers()},e.prototype.breakHTML=function(e){this.removeMarkers(),0===this.$element.find("break").length&&this.insertSimpleHTML("<break></break>");var i=this.parents(this.$element.find("break"),t.merge(["UL","OL"],this.valid_nodes).join(","))[0];if(this.parents(t(i),"ul, ol").length&&(i=this.parents(t(i),"ul, ol")[0]),void 0===i&&(i=this.$element.get(0)),["UL","OL"].indexOf(i.tagName)>=0){var s=t("<div>").html(e);s.find("> li").wrap("<"+i.tagName+">"),e=s.html()}if(i==this.$element.get(0)){if(this.$element.find("break").next().length){this.insertSimpleHTML('<div id="inserted-div">'+e+"</div>");var a=this.$element.find("div#inserted-div");this.setFocusAtEnd(a),this.saveSelectionByMarkers(),a.replaceWith(a.contents()),this.restoreSelectionByMarkers()}else this.insertSimpleHTML(e),this.setFocusAtEnd();return this.$element.find("break").remove(),this.checkPlaceholder(),!0}if("TD"===i.tagName)return this.$element.find("break").remove(),this.insertSimpleHTML(e),!0;var o=t("<div>").html(e);if(this.addMarkersAtEnd(o),e=o.html(),this.emptyElement(t(i)))return t(i).replaceWith(e),this.restoreSelectionByMarkers(),this.checkPlaceholder(),!0;this.$element.find("li").each(t.proxy(function(e,i){this.emptyElement(i)&&t(i).addClass("empty-li")},this));for(var n,r,l=t("<div></div>").append(t(i).clone()).html(),d=[],h={},p=[],f=0,c=0;c<l.length;c++)if(r=l.charAt(c),"<"==r){var u=l.indexOf(">",c+1);if(-1!==u){n=l.substring(c,u+1);var m=this.tagName(n);if(c=u,"break"==m){if(!this.isClosingTag(n)){for(var g=d.length-1;g>=0;g--){var v=this.tagName(d[g]);p.push("</"+v+">")}p.push(e);for(var b=0;b<d.length;b++)p.push(d[b])}}else if(p.push(n),!this.isSelfClosingTag(n))if(this.isClosingTag(n)){var y=h[m].pop();d.splice(y,1)}else d.push(n),void 0===h[m]&&(h[m]=[]),h[m].push(d.length-1)}}else f++,p.push(r);t(i).replaceWith(p.join("")),this.$element.find("li").each(t.proxy(function(e,i){var s=t(i);s.hasClass("empty-li")?s.removeClass("empty-li"):this.emptyElement(i)&&s.remove()},this)),this.cleanupLists(),this.restoreSelectionByMarkers()},e.prototype.insertSimpleHTML=function(t){var e,i;if(this.no_verify=!0,this.window.getSelection){if(e=this.window.getSelection(),e.getRangeAt&&e.rangeCount){i=e.getRangeAt(0),i.deleteContents();var s=this.document.createElement("div");s.innerHTML=t;for(var a,o,n=this.document.createDocumentFragment();a=s.firstChild;)o=n.appendChild(a);i.insertNode(n),o&&(i=i.cloneRange(),i.setStartAfter(o),i.collapse(!0),e.removeAllRanges(),e.addRange(i))}}else if((e=this.document.selection)&&"Control"!=e.type){var r=e.createRange();r.collapse(!0),e.createRange().pasteHTML(t)}this.no_verify=!1},e.prototype.insertHTML=function(e,i,s){if(void 0===i&&(i=!0),void 0===s&&(s=!1),!this.isHTML&&i&&this.focus(),this.removeMarkers(),this.insertSimpleHTML("<break></break>"),this.checkPlaceholder(!0),this.$element.hasClass("f-placeholder"))return this.$element.html(e),this.options.paragraphy&&this.wrapText(!0),this.$element.find("break").remove(),this.setFocusAtEnd(),this.checkPlaceholder(),!1;for(var a=t("<div>").append(e).find("*"),o=0;o<a.length;o++)if(this.valid_nodes.indexOf(a[o].tagName)>=0)return this.breakHTML(e),this.$element.find("break").remove(),!1;this.$element.find("break").remove(),this.insertSimpleHTML(e)},e.prototype.execDefaultShortcut=function(t,e){return this[t].apply(this,e),!1},e.prototype.initEditor=function(){var i="froala-editor";this.mobile()&&(i+=" touch"),this.browser.msie&&e.getIEversion()<9&&(i+=" ie8"),this.$editor=t('<div class="'+i+'" style="display: none;">');var s=this.$document.find(this.options.scrollableContainer);s.append(this.$editor),this.options.inlineMode?this.initInlineEditor():this.initBasicEditor()},e.prototype.refreshToolbarPosition=function(){this.$window.scrollTop()>this.$box.offset().top&&this.$window.scrollTop()<this.$box.offset().top+this.$box.outerHeight()-this.$editor.outerHeight()?(this.$element.css("padding-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$placeholder.css("margin-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$editor.addClass("f-scroll").removeClass("f-scroll-abs").css("bottom","").css("left",this.$box.offset().left+parseFloat(this.$box.css("padding-left"),10)-this.$window.scrollLeft()).width(this.$box.width()-parseFloat(this.$editor.css("border-left-width"),10)-parseFloat(this.$editor.css("border-right-width"),10)),this.iOS()&&(this.$element.is(":focus")?this.$editor.css("top",this.$window.scrollTop()):this.$editor.css("top",""))):this.$window.scrollTop()<this.$box.offset().top?this.iOS()&&this.$element.is(":focus")?(this.$element.css("padding-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$placeholder.css("margin-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$editor.addClass("f-scroll").removeClass("f-scroll-abs").css("bottom","").css("left",this.$box.offset().left+parseFloat(this.$box.css("padding-left"),10)-this.$window.scrollLeft()).width(this.$box.width()-parseFloat(this.$editor.css("border-left-width"),10)-parseFloat(this.$editor.css("border-right-width"),10)),this.$editor.css("top",this.$box.offset().top)):(this.$editor.removeClass("f-scroll f-scroll-abs").css("bottom","").css("top","").width(""),this.$element.css("padding-top",""),this.$placeholder.css("margin-top","")):this.$window.scrollTop()>this.$box.offset().top+this.$box.outerHeight()-this.$editor.outerHeight()&&!this.$editor.hasClass("f-scroll-abs")&&(this.$element.css("padding-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$placeholder.css("margin-top",this.$editor.outerHeight()+this.$element.data("padding-top")),this.$editor.removeClass("f-scroll").addClass("f-scroll-abs"),this.$editor.css("bottom",0).css("top","").css("left",""))},e.prototype.toolbarTop=function(){this.options.toolbarFixed||this.options.inlineMode||(this.$element.data("padding-top",parseInt(this.$element.css("padding-top"),10)),this.$window.on("scroll resize load",t.proxy(function(){this.refreshToolbarPosition()},this)),this.iOS()&&this.$element.on("focus blur",t.proxy(function(){this.refreshToolbarPosition()},this)))},e.prototype.initBasicEditor=function(){this.$element.addClass("f-basic"),this.$wrapper.addClass("f-basic"),this.$popup_editor=this.$editor.clone();var t=this.$document.find(this.options.scrollableContainer);this.$popup_editor.appendTo(t).addClass("f-inline"),this.$editor.addClass("f-basic").show(),this.$editor.insertBefore(this.$wrapper),this.toolbarTop()},e.prototype.initInlineEditor=function(){this.$editor.addClass("f-inline"),this.$element.addClass("f-inline"),this.$popup_editor=this.$editor},e.prototype.initDrag=function(){this.drag_support={filereader:"undefined"!=typeof FileReader,formdata:!!this.window.FormData,progress:"upload"in new XMLHttpRequest}},e.prototype.initOptions=function(){this.setDimensions(),this.setSpellcheck(),this.setImageUploadURL(),this.setButtons(),this.setDirection(),this.setZIndex(),this.setTheme(),this.options.editInPopup&&this.buildEditPopup(),this.editableDisabled||(this.setPlaceholder(),this.setPlaceholderEvents())},e.prototype.isTouch=function(){return WYSIWYGModernizr.touch&&void 0!==this.window.Touch},e.prototype.initEditorSelection=function(){this.$element.on("keyup",t.proxy(function(t){return this.triggerEvent("keyup",[t],!1)},this)),this.$element.on("focus",t.proxy(function(){this.blurred&&(this.blurred=!1,this.pasting||""!==this.text()||this.focus(!1),this.triggerEvent("focus",[],!1))},this)),this.$element.on("mousedown touchstart",t.proxy(function(){return this.isDisabled?!1:void(this.isResizing()||(this.closeImageMode(),this.hide()))},this)),this.options.disableRightClick&&this.$element.contextmenu(t.proxy(function(t){return t.preventDefault(),this.options.inlineMode&&this.$element.focus(),!1},this)),this.$element.on(this.mouseup,t.proxy(function(e){if(this.isDisabled)return!1;if(!this.isResizing()){var i=this.text();e.stopPropagation(),this.imageMode=!1,!(""!==i||this.options.alwaysVisible||this.options.editInPopup||(3==e.which||2==e.button)&&this.options.inlineMode&&!this.isImage&&this.options.disableRightClick)||this.link||this.imageMode?this.options.inlineMode||this.refreshButtons():setTimeout(t.proxy(function(){i=this.text(),!(""!==i||this.options.alwaysVisible||this.options.editInPopup||(3==e.which||2==e.button)&&this.options.inlineMode&&!this.isImage&&this.options.disableRightClick)||this.link||this.imageMode||(this.show(e),this.options.editInPopup&&this.showEditPopup())},this),0)}this.hideDropdowns(),this.hideOtherEditors()},this)),this.$editor.on(this.mouseup,t.proxy(function(t){return this.isDisabled?!1:void(this.isResizing()||(t.stopPropagation(),this.options.inlineMode===!1&&this.hide()))},this)),this.$editor.on("mousedown",".fr-dropdown-menu",t.proxy(function(t){return this.isDisabled?!1:(t.stopPropagation(),void(this.noHide=!0))},this)),this.$popup_editor.on("mousedown",".fr-dropdown-menu",t.proxy(function(t){return this.isDisabled?!1:(t.stopPropagation(),void(this.noHide=!0))},this)),this.$popup_editor.on("mouseup",t.proxy(function(t){return this.isDisabled?!1:void(this.isResizing()||t.stopPropagation())},this)),this.$edit_popup_wrapper&&this.$edit_popup_wrapper.on("mouseup",t.proxy(function(t){return this.isDisabled?!1:void(this.isResizing()||t.stopPropagation())},this)),this.setDocumentSelectionChangeEvent(),this.setWindowMouseUpEvent(),this.setWindowKeyDownEvent(),this.setWindowKeyUpEvent(),this.setWindowOrientationChangeEvent(),this.setWindowHideEvent(),this.setWindowBlurEvent(),this.options.trackScroll&&this.setWindowScrollEvent()},e.prototype.blur=function(e){this.blurred||this.pasting||(this.selectionDisabled=!0,this.triggerEvent("blur",[]),e&&0===t("*:focus").length&&this.clearSelection(),this.isLink||this.isImage||(this.selectionDisabled=!1),this.blurred=!0)},e.prototype.setWindowBlurEvent=function(){this.$window.on("blur."+this._id,t.proxy(function(t,e){this.blur(e)},this))},e.prototype.setWindowHideEvent=function(){this.$window.on("hide."+this._id,t.proxy(function(){this.isResizing()?this.$element.find(".f-img-handle").trigger("moveend"):this.hide(!1)},this))},e.prototype.setWindowOrientationChangeEvent=function(){this.$window.on("orientationchange."+this._id,t.proxy(function(){setTimeout(t.proxy(function(){this.hide()},this),10)},this))},e.prototype.setDocumentSelectionChangeEvent=function(){this.$document.on("selectionchange."+this._id,t.proxy(function(e){return this.isDisabled?!1:void(this.isResizing()||this.isScrolling||(clearTimeout(this.selectionChangedTimeout),this.selectionChangedTimeout=setTimeout(t.proxy(function(){if(this.options.inlineMode&&this.selectionInEditor()&&this.link!==!0&&this.isTouch()){var t=this.text();""!==t?(this.iPod()?this.options.alwaysVisible&&this.hide():this.show(null),e.stopPropagation()):this.options.alwaysVisible?this.show(null):(this.hide(),this.closeImageMode(),this.imageMode=!1)}},this),75)))},this))},e.prototype.setWindowMouseUpEvent=function(){this.$window.on(this.mouseup+"."+this._id,t.proxy(function(){return this.isDisabled?!1:(this.isResizing()||this.isScrolling||(this.$bttn_wrapper.find("button.fr-trigger").removeClass("active"),this.selectionInEditor()&&""!==this.text()&&!this.isTouch()?this.show(null):this.$popup_editor.is(":visible")&&(this.hide(),this.closeImageMode(),this.imageMode=!1),this.blur(!0)),void t("[data-down]").removeAttr("data-down"))},this))},e.prototype.setWindowKeyDownEvent=function(){this.$window.on("keydown."+this._id,t.proxy(function(e){var i=e.which;if(27==i&&(this.focus(),this.restoreSelection(),this.hide(),this.closeImageMode(),this.imageMode=!1),this.imageMode){if(13==i)return this.$element.find(".f-img-editor").parents(".f-img-wrap").before("<br/>"),this.sync(),this.$element.find(".f-img-editor img").click(),!1;if(46==i||8==i)return e.stopPropagation(),e.preventDefault(),setTimeout(t.proxy(function(){this.removeImage(this.$element.find(".f-img-editor img"))},this),0),!1}else if(this.selectionInEditor()){if(this.isDisabled)return!0;var s=(e.ctrlKey||e.metaKey)&&!e.altKey;!s&&this.$popup_editor.is(":visible")&&this.$bttn_wrapper.is(":visible")&&this.options.inlineMode&&(this.hide(),this.closeImageMode(),this.imageMode=!1)}},this))},e.prototype.setWindowKeyUpEvent=function(){this.$window.on("keyup."+this._id,t.proxy(function(){return this.isDisabled?!1:void(this.selectionInEditor()&&""!==this.text()&&!this.$popup_editor.is(":visible")&&this.repositionEditor())},this))},e.prototype.setWindowScrollEvent=function(){t.merge(this.$window,t(this.options.scrollableContainer)).on("scroll."+this._id,t.proxy(function(){return this.isDisabled?!1:(clearTimeout(this.scrollTimer),this.isScrolling=!0,void(this.scrollTimer=setTimeout(t.proxy(function(){this.isScrolling=!1},this),2500)))},this))},e.prototype.setPlaceholder=function(e){e&&(this.options.placeholder=e),this.$textarea&&this.$textarea.attr("placeholder",this.options.placeholder),this.$placeholder||(this.$placeholder=t('<span class="fr-placeholder" unselectable="on"></span>').bind("click",t.proxy(function(){this.focus()},this)),this.$element.after(this.$placeholder)),this.$placeholder.text(this.options.placeholder)},e.prototype.isEmpty=function(){var e=this.$element.text().replace(/(\r\n|\n|\r|\t|\u200B|\u0020)/gm,"");return""===e&&0===this.$element.find("img, table, iframe, input, hr, li").length&&0===this.$element.find(this.options.defaultTag+" > br, br").length&&0===this.$element.find(t.map(this.valid_nodes,t.proxy(function(t){return this.options.defaultTag==t?null:t},this)).join(", ")).length},e.prototype.checkPlaceholder=function(i){if(this.isDisabled&&!i)return!1;if(this.pasting&&!i)return!1;if(this.$element.find("td:empty, th:empty").append(t.Editable.INVISIBLE_SPACE),this.$element.find(this.valid_nodes.join(":empty, ")+":empty").append(this.br),!this.isHTML)if(this.isEmpty()&&!this.fakeEmpty()){var s,a=this.selectionInEditor()||this.$element.is(":focus");this.options.paragraphy?(s=t("<"+this.options.defaultTag+">"+this.br+"</"+this.options.defaultTag+">"),this.$element.html(s),a&&this.setSelection(s.get(0)),this.$element.addClass("f-placeholder")):(0!==this.$element.find("br").length||this.browser.msie&&e.getIEversion()<=10||(this.$element.append(this.br),a&&this.browser.msie&&this.focus()),this.$element.addClass("f-placeholder"))}else!this.$element.find(this.options.defaultTag+", li").length&&this.options.paragraphy?(this.wrapText(!0),this.$element.find(this.options.defaultTag).length&&""===this.text()?this.setSelection(this.$element.find(this.options.defaultTag)[0],this.$element.find(this.options.defaultTag).text().length,null,this.$element.find(this.options.defaultTag).text().length):this.$element.removeClass("f-placeholder")):this.fakeEmpty()===!1&&(!this.options.paragraphy||this.$element.find(this.valid_nodes.join(",")).length>=1)?this.$element.removeClass("f-placeholder"):!this.options.paragraphy&&this.$element.find(this.valid_nodes.join(",")).length>=1?this.$element.removeClass("f-placeholder"):this.$element.addClass("f-placeholder");return!0},e.prototype.fakeEmpty=function(t){void 0===t&&(t=this.$element);var e=!0;this.options.paragraphy&&(e=1==t.find(this.options.defaultTag).length?!0:!1);var i=t.text().replace(/(\r\n|\n|\r|\t|\u200B)/gm,"");return""===i&&e&&1==t.find("br, li").length&&0===t.find("img, table, iframe, input, hr, li").length},e.prototype.setPlaceholderEvents=function(){this.browser.msie&&e.getIEversion()<9||(this.$element.on("focus click",t.proxy(function(t){return this.isDisabled?!1:void(""!==this.$element.text()||this.pasting||(this.$element.data("focused")||"click"!==t.type?"focus"==t.type&&this.focus(!1):this.$element.focus(),this.$element.data("focused",!0)))},this)),this.$element.on("keyup keydown input focus placeholderCheck",t.proxy(function(){return this.checkPlaceholder()},this)),this.$element.trigger("placeholderCheck"))},e.prototype.setDimensions=function(t,e,i,s){t&&(this.options.height=t),e&&(this.options.width=e),i&&(this.options.minHeight=i),s&&(this.options.maxHeight=s),"auto"!=this.options.height&&(this.$wrapper.css("height",this.options.height),this.$element.css("minHeight",this.options.height-parseInt(this.$element.css("padding-top"),10)-parseInt(this.$element.css("padding-bottom"),10))),"auto"!=this.options.minHeight&&(this.$wrapper.css("minHeight",this.options.minHeight),this.$element.css("minHeight",this.options.minHeight)),"auto"!=this.options.maxHeight&&this.$wrapper.css("maxHeight",this.options.maxHeight),"auto"!=this.options.width&&this.$box.css("width",this.options.width)},e.prototype.setDirection=function(t){t&&(this.options.direction=t),"ltr"!=this.options.direction&&"rtl"!=this.options.direction&&(this.options.direction="ltr"),"rtl"==this.options.direction?(this.$box.addClass("f-rtl"),this.$element.addClass("f-rtl"),this.$editor.addClass("f-rtl"),this.$popup_editor.addClass("f-rtl"),this.$image_modal&&this.$image_modal.addClass("f-rtl")):(this.$box.removeClass("f-rtl"),this.$element.removeClass("f-rtl"),this.$editor.removeClass("f-rtl"),this.$popup_editor.removeClass("f-rtl"),this.$image_modal&&this.$image_modal.removeClass("f-rtl"))},e.prototype.setZIndex=function(t){t&&(this.options.zIndex=t),this.$editor.css("z-index",this.options.zIndex),this.$popup_editor.css("z-index",this.options.zIndex+1),this.$overlay&&this.$overlay.css("z-index",this.options.zIndex+2),this.$image_modal&&this.$image_modal.css("z-index",this.options.zIndex+3)},e.prototype.setTheme=function(t){t&&(this.options.theme=t),null!=this.options.theme&&(this.$editor.addClass(this.options.theme+"-theme"),this.$popup_editor.addClass(this.options.theme+"-theme"),this.$box&&this.$box.addClass(this.options.theme+"-theme"),this.$image_modal&&this.$image_modal.addClass(this.options.theme+"-theme"))},e.prototype.setSpellcheck=function(t){void 0!==t&&(this.options.spellcheck=t),this.$element.attr("spellcheck",this.options.spellcheck)},e.prototype.customizeText=function(e){if(e){var i=this.$editor.find("[title]").add(this.$popup_editor.find("[title]"));this.$image_modal&&(i=i.add(this.$image_modal.find("[title]"))),i.each(t.proxy(function(i,s){for(var a in e)t(s).attr("title").toLowerCase()==a.toLowerCase()&&t(s).attr("title",e[a])},this)),i=this.$editor.find('[data-text="true"]').add(this.$popup_editor.find('[data-text="true"]')),this.$image_modal&&(i=i.add(this.$image_modal.find('[data-text="true"]'))),i.each(t.proxy(function(i,s){for(var a in e)t(s).text().toLowerCase()==a.toLowerCase()&&t(s).text(e[a])},this))}},e.prototype.setLanguage=function(e){void 0!==e&&(this.options.language=e),t.Editable.LANGS[this.options.language]&&(this.customizeText(t.Editable.LANGS[this.options.language].translation),t.Editable.LANGS[this.options.language].direction&&this.setDirection(t.Editable.LANGS[this.options.language].direction),t.Editable.LANGS[this.options.language].translation[this.options.placeholder]&&this.setPlaceholder(t.Editable.LANGS[this.options.language].translation[this.options.placeholder]))},e.prototype.setCustomText=function(t){t&&(this.options.customText=t),this.options.customText&&this.customizeText(this.options.customText)},e.prototype.execHTML=function(){this.html()},e.prototype.initHTMLArea=function(){this.$html_area=t('<textarea wrap="hard">').keydown(function(e){var i=e.keyCode||e.which;if(9==i){e.preventDefault();var s=t(this).get(0).selectionStart,a=t(this).get(0).selectionEnd;t(this).val(t(this).val().substring(0,s)+"	"+t(this).val().substring(a)),t(this).get(0).selectionStart=t(this).get(0).selectionEnd=s+1}}).focus(t.proxy(function(){this.blurred&&(this.blurred=!1,this.triggerEvent("focus",[],!1))},this)).mouseup(t.proxy(function(){this.blurred&&(this.blurred=!1,this.triggerEvent("focus",[],!1))},this))},e.prototype.command_dispatcher={align:function(t){var e=this.buildDropdownAlign(t),i=this.buildDropdownButton(t,e);return i},formatBlock:function(t){var e=this.buildDropdownFormatBlock(t),i=this.buildDropdownButton(t,e);return i},html:function(e){var i=this.buildDefaultButton(e);return this.options.inlineMode&&this.$box.append(t(i).clone(!0).addClass("html-switch").attr("title","Hide HTML").click(t.proxy(this.execHTML,this))),this.initHTMLArea(),i}},e.prototype.setButtons=function(t){t&&(this.options.buttons=t),this.$editor.append('<div class="bttn-wrapper" id="bttn-wrapper-'+this._id+'">'),this.$bttn_wrapper=this.$editor.find("#bttn-wrapper-"+this._id),this.mobile()&&this.$bttn_wrapper.addClass("touch");for(var i,s,a="",o=0;o<this.options.buttons.length;o++){var n=this.options.buttons[o];if("sep"!=n){var r=e.commands[n];if(void 0!==r){r.cmd=n;var l=this.command_dispatcher[r.cmd];l?a+=l.apply(this,[r]):r.seed?(i=this.buildDefaultDropdown(r),s=this.buildDropdownButton(r,i),a+=s):(s=this.buildDefaultButton(r),a+=s,this.bindRefreshListener(r))}else{if(r=this.options.customButtons[n],void 0===r){if(r=this.options.customDropdowns[n],void 0===r)continue;s=this.buildCustomDropdown(r,n),a+=s,this.bindRefreshListener(r);continue}s=this.buildCustomButton(r,n),a+=s,this.bindRefreshListener(r)}}else a+=this.options.inlineMode?'<div class="f-clear"></div><hr/>':'<span class="f-sep"></span>'}this.$bttn_wrapper.html(a),this.$bttn_wrapper.find('button[data-cmd="undo"], button[data-cmd="redo"]').prop("disabled",!0),this.bindButtonEvents()},e.prototype.bindRefreshListener=function(e){e.refresh&&this.addListener("refresh",t.proxy(function(){e.refresh.apply(this,[e.cmd])},this))},e.prototype.buildDefaultButton=function(t){var e='<button tabIndex="-1" type="button" class="fr-bttn" title="'+t.title+'" data-cmd="'+t.cmd+'">';return e+=void 0===this.options.icons[t.cmd]?this.addButtonIcon(t):this.prepareIcon(this.options.icons[t.cmd],t.title),e+="</button>"},e.prototype.prepareIcon=function(t,e){switch(t.type){case"font":return this.addButtonIcon({icon:t.value});case"img":return this.addButtonIcon({icon_img:t.value,title:e});case"txt":return this.addButtonIcon({icon_txt:t.value})}},e.prototype.addButtonIcon=function(t){return t.icon?'<i class="'+t.icon+'"></i>':t.icon_alt?'<i class="for-text">'+t.icon_alt+"</i>":t.icon_img?'<img src="'+t.icon_img+'" alt="'+t.title+'"/>':t.icon_txt?"<i>"+t.icon_txt+"</i>":t.title},e.prototype.buildCustomButton=function(t,e){this["call_"+e]=t.callback;var i='<button tabIndex="-1" type="button" class="fr-bttn" data-callback="call_'+e+'" data-cmd="button_name" data-name="'+e+'" title="'+t.title+'">'+this.prepareIcon(t.icon,t.title)+"</button>";return i},e.prototype.callDropdown=function(e,i){this.$bttn_wrapper.on("click touch",'[data-name="'+e+'"]',t.proxy(function(t){t.preventDefault(),t.stopPropagation(),i.apply(this)},this))},e.prototype.buildCustomDropdown=function(t,e){var i='<div class="fr-bttn fr-dropdown">';i+='<button tabIndex="-1" type="button" class="fr-trigger" title="'+t.title+'" data-name="'+e+'">'+this.prepareIcon(t.icon,t.title)+"</button>",i+='<ul class="fr-dropdown-menu">';var s=0;for(var a in t.options){this["call_"+e+s]=t.options[a];var o='<li data-callback="call_'+e+s+'" data-cmd="'+e+s+'" data-name="'+e+s+'"><a href="#">'+a+"</a></li>";i+=o,s++}return i+="</ul></div>"},e.prototype.buildDropdownButton=function(t,e,i){i=i||"";var s='<div class="fr-bttn fr-dropdown '+i+'">',a="";a+=void 0===this.options.icons[t.cmd]?this.addButtonIcon(t):this.prepareIcon(this.options.icons[t.cmd],t.title);var o='<button tabIndex="-1" type="button" data-name="'+t.cmd+'" class="fr-trigger" title="'+t.title+'">'+a+"</button>";return s+=o,s+=e,s+="</div>"},e.prototype.buildDropdownAlign=function(t){this.bindRefreshListener(t);for(var e='<ul class="fr-dropdown-menu f-align">',i=0;i<t.seed.length;i++){var s=t.seed[i];e+='<li data-cmd="align" data-val="'+s.cmd+'" title="'+s.title+'"><a href="#"><i class="'+s.icon+'"></i></a></li>'}return e+="</ul>"},e.prototype.buildDropdownFormatBlock=function(t){var e='<ul class="fr-dropdown-menu">';
for(var i in this.options.blockTags){var s='<li data-cmd="'+t.cmd+'" data-val="'+i+'">';s+='<a href="#" data-text="true" class="format-'+i+'" title="'+this.options.blockTags[i]+'">'+this.options.blockTags[i]+"</a></li>",e+=s}return e+="</ul>"},e.prototype.buildDefaultDropdown=function(t){for(var e='<ul class="fr-dropdown-menu">',i=0;i<t.seed.length;i++){var s=t.seed[i],a='<li data-namespace="'+t.namespace+'" data-cmd="'+(s.cmd||t.cmd)+'" data-val="'+s.value+'" data-param="'+(s.param||t.param)+'">';a+='<a href="#" data-text="true" class="'+s.value+'" title="'+s.title+'">'+s.title+"</a></li>",e+=a}return e+="</ul>"},e.prototype.createEditPopupHTML=function(){var t='<div class="froala-popup froala-text-popup" style="display:none;">';return t+='<h4><span data-text="true">Edit text</span><i title="Cancel" class="fa fa-times" id="f-text-close-'+this._id+'"></i></h4></h4>',t+='<div class="f-popup-line"><input type="text" placeholder="http://www.example.com" class="f-lu" id="f-ti-'+this._id+'">',t+='<button data-text="true" type="button" class="f-ok" id="f-edit-popup-ok-'+this._id+'">OK</button>',t+="</div>",t+="</div>"},e.prototype.buildEditPopup=function(){this.$edit_popup_wrapper=t(this.createEditPopupHTML()),this.$popup_editor.append(this.$edit_popup_wrapper),this.$edit_popup_wrapper.find("#f-ti-"+this._id).on("mouseup keydown",function(t){t.stopPropagation()}),this.addListener("hidePopups",t.proxy(function(){this.$edit_popup_wrapper.hide()},this)),this.$edit_popup_wrapper.on("click","#f-edit-popup-ok-"+this._id,t.proxy(function(){this.$element.text(this.$edit_popup_wrapper.find("#f-ti-"+this._id).val()),this.sync(),this.hide()},this)),this.$edit_popup_wrapper.on("click","i#f-text-close-"+this._id,t.proxy(function(){this.hide()},this))},e.prototype.createCORSRequest=function(t,e){var i=new XMLHttpRequest;if("withCredentials"in i){i.open(t,e,!0),this.options.withCredentials&&(i.withCredentials=!0);for(var s in this.options.headers)i.setRequestHeader(s,this.options.headers[s])}else"undefined"!=typeof XDomainRequest?(i=new XDomainRequest,i.open(t,e)):i=null;return i},e.prototype.isEnabled=function(e){return t.inArray(e,this.options.buttons)>=0},e.prototype.bindButtonEvents=function(){this.bindDropdownEvents(this.$bttn_wrapper),this.bindCommandEvents(this.$bttn_wrapper)},e.prototype.bindDropdownEvents=function(i){var s=this;i.on(this.mousedown,".fr-dropdown .fr-trigger:not([disabled])",function(e){return"mousedown"===e.type&&1!==e.which?!0:("LI"===this.tagName&&"touchstart"===e.type&&s.android()||s.iOS()||e.preventDefault(),void t(this).attr("data-down",!0))}),i.on(this.mouseup,".fr-dropdown .fr-trigger:not([disabled])",function(a){if(s.isDisabled)return!1;if(a.stopPropagation(),a.preventDefault(),!t(this).attr("data-down"))return t("[data-down]").removeAttr("data-down"),!1;t("[data-down]").removeAttr("data-down"),s.options.inlineMode===!1&&0===t(this).parents(".froala-popup").length&&(s.hide(),s.closeImageMode(),s.imageMode=!1),t(this).toggleClass("active").trigger("blur");var o,n=t(this).attr("data-name");return e.commands[n]?o=e.commands[n].refreshOnShow:s.options.customDropdowns[n]?o=s.options.customDropdowns[n].refreshOnShow:e.image_commands[n]&&(o=e.image_commands[n].refreshOnShow),o&&o.call(s),i.find("button.fr-trigger").not(this).removeClass("active"),!1}),i.on(this.mouseup,".fr-dropdown",function(t){t.stopPropagation(),t.preventDefault()}),this.$element.on("mouseup","img, a",t.proxy(function(){return this.isDisabled?!1:void i.find(".fr-dropdown .fr-trigger").removeClass("active")},this)),i.on("click","li[data-cmd] > a",function(t){t.preventDefault()})},e.prototype.bindCommandEvents=function(e){var i=this;e.on(this.mousedown,"button[data-cmd], li[data-cmd], span[data-cmd], a[data-cmd]",function(e){return"mousedown"===e.type&&1!==e.which?!0:("LI"===this.tagName&&"touchstart"===e.type&&i.android()||i.iOS()||e.preventDefault(),void t(this).attr("data-down",!0))}),e.on(this.mouseup+" "+this.move,"button[data-cmd], li[data-cmd], span[data-cmd], a[data-cmd]",t.proxy(function(e){if(i.isDisabled)return!1;if("mouseup"===e.type&&1!==e.which)return!0;var s=e.currentTarget;if("touchmove"!=e.type){if(e.stopPropagation(),e.preventDefault(),!t(s).attr("data-down"))return t("[data-down]").removeAttr("data-down"),!1;if(t("[data-down]").removeAttr("data-down"),t(s).data("dragging")||t(s).attr("disabled"))return t(s).removeData("dragging"),!1;var a=t(s).data("timeout");a&&(clearTimeout(a),t(s).removeData("timeout"));var o=t(s).attr("data-callback");if(i.options.inlineMode===!1&&0===t(s).parents(".froala-popup").length&&(i.hide(),i.closeImageMode(),i.imageMode=!1),o)t(s).parents(".fr-dropdown").find(".fr-trigger.active").removeClass("active"),i[o]();else{var n=t(s).attr("data-namespace"),r=t(s).attr("data-cmd"),l=t(s).attr("data-val"),d=t(s).attr("data-param");n?i["exec"+n](r,l,d):(i.exec(r,l,d),i.$bttn_wrapper.find(".fr-dropdown .fr-trigger").removeClass("active"))}return!1}t(s).data("timeout")||t(s).data("timeout",setTimeout(function(){t(s).data("dragging",!0)},200))},this))},e.prototype.save=function(){if(!this.triggerEvent("beforeSave",[],!1))return!1;if(this.options.saveURL){var e={};for(var i in this.options.saveParams){var s=this.options.saveParams[i];e[i]="function"==typeof s?s.call(this):s}t.ajax({type:this.options.saveRequestType,url:this.options.saveURL,data:t.extend({body:this.getHTML(!1,!0)},this.options.saveParams),crossDomain:this.options.crossDomain,xhrFields:{withCredentials:this.options.withCredentials},headers:this.options.headers}).done(t.proxy(function(t){this.triggerEvent("afterSave",[t])},this)).fail(t.proxy(function(){this.triggerEvent("saveError",["Save request failed on the server."])},this))}else this.triggerEvent("saveError",["Missing save URL."])},e.prototype.isURL=function(t){if(!/^(https?:|ftps?:|)\/\//.test(t))return!1;t=String(t).replace(/</g,"%3C").replace(/>/g,"%3E").replace(/"/g,"%22").replace(/ /g,"%20");var e=/\(?(?:(https?:|ftps?:|)\/\/)?(?:((?:[^\W\s]|\.|-|[:]{1})+)@{1})?((?:www.)?(?:[^\W\s]|\.|-)+[\.][^\W\s]{2,4}|(?:www.)?(?:[^\W\s]|\.|-)|localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?::(\d*))?([\/]?[^\s\?]*[\/]{1})*(?:\/?([^\s\n\?\[\]\{\}\#]*(?:(?=\.)){1}|[^\s\n\?\[\]\{\}\.\#]*)?([\.]{1}[^\s\?\#]*)?)?(?:\?{1}([^\s\n\#\[\]]*))?([\#][^\s\n]*)?\)?/gi;return e.test(t)},e.prototype.sanitizeURL=function(t){if(/^(https?:|ftps?:|)\/\//.test(t)){if(!this.isURL(t))return""}else t=encodeURIComponent(t).replace(/%23/g,"#").replace(/%2F/g,"/").replace(/%25/g,"%").replace(/mailto%3A/g,"mailto:").replace(/tel%3A/g,"tel:").replace(/data%3Aimage/g,"data:image").replace(/webkit-fake-url%3A/g,"webkit-fake-url:").replace(/%3F/g,"?").replace(/%3D/g,"=").replace(/%26/g,"&").replace(/&amp;/g,"&").replace(/%2C/g,",").replace(/%3B/g,";").replace(/%2B/g,"+").replace(/%40/g,"@");return t},e.prototype.parents=function(t,e){return t.get(0)!=this.$element.get(0)?t.parentsUntil(this.$element,e):[]},e.prototype.option=function(e,i){if(void 0===e)return this.options;if(e instanceof Object)this.options=t.extend({},this.options,e),this.initOptions(),this.setCustomText(),this.setLanguage();else{if(void 0===i)return this.options[e];switch(this.options[e]=i,e){case"direction":this.setDirection();break;case"height":case"width":case"minHeight":case"maxHeight":this.setDimensions();break;case"spellcheck":this.setSpellcheck();break;case"placeholder":this.setPlaceholder();break;case"customText":this.setCustomText();break;case"language":this.setLanguage();break;case"textNearImage":this.setTextNearImage();break;case"zIndex":this.setZIndex();break;case"theme":this.setTheme()}}};var i=t.fn.editable;t.fn.editable=function(i){for(var s=[],a=0;a<arguments.length;a++)s.push(arguments[a]);if("string"==typeof i){var o=[];return this.each(function(){var e=t(this),a=e.data("fa.editable");if(!a[i])return t.error("Method "+i+" does not exist in Froala Editor.");var n=a[i].apply(a,s.slice(1));void 0===n?o.push(this):0===o.length&&o.push(n)}),1==o.length?o[0]:o}return"object"!=typeof i&&i?void 0:this.each(function(){var s=this,a=t(s),o=a.data("fa.editable");o||a.data("fa.editable",o=new e(s,i))})},t.fn.editable.Constructor=e,t.Editable=e,t.fn.editable.noConflict=function(){return t.fn.editable=i,this}}(window.jQuery),function(t){t.Editable.prototype.initUndoRedo=function(){this.undoStack=[],this.undoIndex=0,this.saveUndoStep(),this.disableBrowserUndo()},t.Editable.prototype.undo=function(){if(this.no_verify=!0,this.undoIndex>1){clearTimeout(this.typingTimer),this.triggerEvent("beforeUndo",[],!1);var t=this.undoStack[--this.undoIndex-1];this.restoreSnapshot(t),this.doingRedo=!0,this.triggerEvent("afterUndo",[]),this.doingRedo=!1,""!==this.text()?this.repositionEditor():this.hide(),this.$element.trigger("placeholderCheck"),this.focus(),this.refreshButtons()}this.no_verify=!1},t.Editable.prototype.redo=function(){if(this.no_verify=!0,this.undoIndex<this.undoStack.length){clearTimeout(this.typingTimer),this.triggerEvent("beforeRedo",[],!1);var t=this.undoStack[this.undoIndex++];this.restoreSnapshot(t),this.doingRedo=!0,this.triggerEvent("afterRedo",[]),this.doingRedo=!1,""!==this.text()?this.repositionEditor():this.hide(),this.$element.trigger("placeholderCheck"),this.focus(),this.refreshButtons()}this.no_verify=!1},t.Editable.prototype.saveUndoStep=function(){if(!this.undoStack)return!1;for(;this.undoStack.length>this.undoIndex;)this.undoStack.pop();var t=this.getSnapshot();this.undoStack[this.undoIndex-1]&&this.identicSnapshots(this.undoStack[this.undoIndex-1],t)||(this.undoStack.push(t),this.undoIndex++),this.refreshUndo(),this.refreshRedo()},t.Editable.prototype.refreshUndo=function(){if(this.isEnabled("undo")){if(void 0===this.$editor)return;this.$bttn_wrapper.find('[data-cmd="undo"]').removeAttr("disabled"),(0===this.undoStack.length||this.undoIndex<=1||this.isHTML)&&this.$bttn_wrapper.find('[data-cmd="undo"]').attr("disabled",!0)}},t.Editable.prototype.refreshRedo=function(){if(this.isEnabled("redo")){if(void 0===this.$editor)return;this.$bttn_wrapper.find('[data-cmd="redo"]').removeAttr("disabled"),(this.undoIndex==this.undoStack.length||this.isHTML)&&this.$bttn_wrapper.find('[data-cmd="redo"]').prop("disabled",!0)}},t.Editable.prototype.getNodeIndex=function(t){for(var e=t.parentNode.childNodes,i=0,s=null,a=0;a<e.length;a++){if(s){var o=3===e[a].nodeType&&""===e[a].textContent,n=3===s.nodeType&&3===e[a].nodeType;o||n||i++}if(e[a]==t)return i;s=e[a]}},t.Editable.prototype.getNodeLocation=function(t){var e=[];if(!t.parentNode)return[];for(;t!=this.$element.get(0);)e.push(this.getNodeIndex(t)),t=t.parentNode;return e.reverse()},t.Editable.prototype.getNodeByLocation=function(t){for(var e=this.$element.get(0),i=0;i<t.length;i++)e=e.childNodes[t[i]];return e},t.Editable.prototype.getRealNodeOffset=function(t,e){for(;t&&3===t.nodeType;){var i=t.previousSibling;i&&3==i.nodeType&&(e+=i.textContent.length),t=i}return e},t.Editable.prototype.getRangeSnapshot=function(t){return{scLoc:this.getNodeLocation(t.startContainer),scOffset:this.getRealNodeOffset(t.startContainer,t.startOffset),ecLoc:this.getNodeLocation(t.endContainer),ecOffset:this.getRealNodeOffset(t.endContainer,t.endOffset)}},t.Editable.prototype.getSnapshot=function(){var t={};if(t.html=this.$element.html(),t.ranges=[],this.selectionInEditor()&&this.$element.is(":focus"))for(var e=this.getRanges(),i=0;i<e.length;i++)t.ranges.push(this.getRangeSnapshot(e[i]));return t},t.Editable.prototype.identicSnapshots=function(t,e){return t.html!=e.html?!1:JSON.stringify(t.ranges)!=JSON.stringify(e.ranges)?!1:!0},t.Editable.prototype.restoreRangeSnapshot=function(t,e){try{var i=this.getNodeByLocation(t.scLoc),s=t.scOffset,a=this.getNodeByLocation(t.ecLoc),o=t.ecOffset,n=this.document.createRange();n.setStart(i,s),n.setEnd(a,o),e.addRange(n)}catch(r){}},t.Editable.prototype.restoreSnapshot=function(e){this.$element.html()!=e.html&&this.$element.html(e.html);var i=this.getSelection();this.clearSelection(),this.$element.focus();for(var s=0;s<e.ranges.length;s++)this.restoreRangeSnapshot(e.ranges[s],i);setTimeout(t.proxy(function(){this.$element.find(".f-img-wrap img").click()},this),0)}}(jQuery),function(t){t.Editable.prototype.refreshButtons=function(e){return this.initialized&&(this.selectionInEditor()&&!this.isHTML||this.browser.msie&&t.Editable.getIEversion()<9||e)?(this.$editor.find("button[data-cmd]").removeClass("active"),this.refreshDisabledState(),void this.raiseEvent("refresh")):!1},t.Editable.prototype.refreshDisabledState=function(){if(this.isHTML)return!1;if(this.$editor){for(var e=0;e<this.options.buttons.length;e++){var i=this.options.buttons[e];if(void 0!==t.Editable.commands[i]){var s=!1;t.isFunction(t.Editable.commands[i].disabled)?s=t.Editable.commands[i].disabled.apply(this):void 0!==t.Editable.commands[i].disabled&&(s=!0),s?(this.$editor.find('button[data-cmd="'+i+'"]').prop("disabled",!0),this.$editor.find('button[data-name="'+i+'"]').prop("disabled",!0)):(this.$editor.find('button[data-cmd="'+i+'"]').removeAttr("disabled"),this.$editor.find('button[data-name="'+i+'"]').removeAttr("disabled"))}}this.refreshUndo(),this.refreshRedo()}},t.Editable.prototype.refreshFormatBlocks=function(){var t=this.getSelectionElements()[0],e=t.tagName.toLowerCase();this.options.paragraphy&&e===this.options.defaultTag.toLowerCase()&&(e="n"),this.$editor.find('.fr-bttn > button[data-name="formatBlock"] + ul li').removeClass("active"),this.$bttn_wrapper.find('.fr-bttn > button[data-name="formatBlock"] + ul li[data-val="'+e+'"]').addClass("active")},t.Editable.prototype.refreshDefault=function(t){try{this.document.queryCommandState(t)===!0&&this.$editor.find('[data-cmd="'+t+'"]').addClass("active")}catch(e){}},t.Editable.prototype.refreshAlign=function(){var e=t(this.getSelectionElements()[0]);this.$editor.find('.fr-dropdown > button[data-name="align"] + ul li').removeClass("active");var i,s=e.css("text-align");["left","right","justify","center"].indexOf(s)<0&&(s="left"),"left"==s?i="justifyLeft":"right"==s?i="justifyRight":"justify"==s?i="justifyFull":"center"==s&&(i="justifyCenter"),this.$editor.find('.fr-dropdown > button[data-name="align"].fr-trigger i').attr("class","fa fa-align-"+s),this.$editor.find('.fr-dropdown > button[data-name="align"] + ul li[data-val="'+i+'"]').addClass("active")},t.Editable.prototype.refreshHTML=function(){this.isActive("html")?this.$editor.find('[data-cmd="html"]').addClass("active"):this.$editor.find('[data-cmd="html"]').removeClass("active")}}(jQuery),function(t){t.Editable.commands={bold:{title:"Bold",icon:"fa fa-bold",shortcut:"(Ctrl + B)",refresh:t.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(t){this._startInDefault(t)}},italic:{title:"Italic",icon:"fa fa-italic",shortcut:"(Ctrl + I)",refresh:t.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(t){this._startInDefault(t)}},underline:{cmd:"underline",title:"Underline",icon:"fa fa-underline",shortcut:"(Ctrl + U)",refresh:t.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(t){this._startInDefault(t)}},strikeThrough:{title:"Strikethrough",icon:"fa fa-strikethrough",refresh:t.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(t){this._startInDefault(t)}},subscript:{title:"Subscript",icon:"fa fa-subscript",refresh:t.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(t){this._startInDefault(t)}},superscript:{title:"Superscript",icon:"fa fa-superscript",refresh:t.Editable.prototype.refreshDefault,undo:!0,callbackWithoutSelection:function(t){this._startInDefault(t)}},formatBlock:{title:"Format Block",icon:"fa fa-paragraph",refreshOnShow:t.Editable.prototype.refreshFormatBlocks,callback:function(t,e){this.formatBlock(e)},undo:!0},align:{title:"Alignment",icon:"fa fa-align-left",refresh:t.Editable.prototype.refreshAlign,refreshOnShow:t.Editable.prototype.refreshAlign,seed:[{cmd:"justifyLeft",title:"Align Left",icon:"fa fa-align-left"},{cmd:"justifyCenter",title:"Align Center",icon:"fa fa-align-center"},{cmd:"justifyRight",title:"Align Right",icon:"fa fa-align-right"},{cmd:"justifyFull",title:"Justify",icon:"fa fa-align-justify"}],callback:function(t,e){this.align(e)},undo:!0},outdent:{title:"Indent Less",icon:"fa fa-dedent",activeless:!0,shortcut:"(Ctrl + <)",callback:function(){this.outdent(!0)},undo:!0},indent:{title:"Indent More",icon:"fa fa-indent",activeless:!0,shortcut:"(Ctrl + >)",callback:function(){this.indent()},undo:!0},selectAll:{title:"Select All",icon:"fa fa-file-text",shortcut:"(Ctrl + A)",callback:function(t,e){this.$element.focus(),this.execDefault(t,e)},undo:!1},createLink:{title:"Insert Link",icon:"fa fa-link",shortcut:"(Ctrl + K)",callback:function(){this.insertLink()},undo:!1},insertImage:{title:"Insert Image",icon:"fa fa-picture-o",activeless:!0,shortcut:"(Ctrl + P)",callback:function(){this.insertImage()},undo:!1},undo:{title:"Undo",icon:"fa fa-undo",activeless:!0,shortcut:"(Ctrl+Z)",refresh:t.Editable.prototype.refreshUndo,callback:function(){this.undo()},undo:!1},redo:{title:"Redo",icon:"fa fa-repeat",activeless:!0,shortcut:"(Shift+Ctrl+Z)",refresh:t.Editable.prototype.refreshRedo,callback:function(){this.redo()},undo:!1},html:{title:"Show HTML",icon:"fa fa-code",refresh:t.Editable.prototype.refreshHTML,callback:function(){this.html()},undo:!1},save:{title:"Save",icon:"fa fa-floppy-o",callback:function(){this.save()},undo:!1},insertHorizontalRule:{title:"Insert Horizontal Line",icon:"fa fa-minus",callback:function(t){this.insertHR(t)},undo:!0},removeFormat:{title:"Clear formatting",icon:"fa fa-eraser",activeless:!0,callback:function(){this.removeFormat()},undo:!0}},t.Editable.prototype.exec=function(e,i,s){return!this.selectionInEditor()&&t.Editable.commands[e].undo&&this.focus(),this.selectionInEditor()&&""===this.text()&&t.Editable.commands[e].callbackWithoutSelection?(t.Editable.commands[e].callbackWithoutSelection.apply(this,[e,i,s]),!1):void(t.Editable.commands[e].callback?t.Editable.commands[e].callback.apply(this,[e,i,s]):this.execDefault(e,i))},t.Editable.prototype.html=function(){var t;this.isHTML?(this.isHTML=!1,t=this.$html_area.val(),this.$box.removeClass("f-html"),this.$element.attr("contenteditable",!0),this.setHTML(t,!1),this.$editor.find('.fr-bttn:not([data-cmd="html"]), .fr-trigger').removeAttr("disabled"),this.$editor.find('.fr-bttn[data-cmd="html"]').removeClass("active"),this.$element.blur(),this.focus(),this.refreshButtons(),this.triggerEvent("htmlHide",[t],!0,!1)):(this.$box.removeClass("f-placeholder"),this.clearSelection(),this.cleanify(!1,!0,!1),t=this.cleanTags(this.getHTML(!1,!1)),this.$html_area.val(t).trigger("resize"),this.$html_area.css("height",this.$element.height()-1),this.$element.html("").append(this.$html_area).removeAttr("contenteditable"),this.$box.addClass("f-html"),this.$editor.find('button.fr-bttn:not([data-cmd="html"]), button.fr-trigger').attr("disabled",!0),this.$editor.find('.fr-bttn[data-cmd="html"]').addClass("active"),this.isHTML=!0,this.hide(),this.imageMode=!1,this.$element.blur(),this.$element.removeAttr("contenteditable"),this.triggerEvent("htmlShow",[t],!0,!1))},t.Editable.prototype.insertHR=function(e){this.$element.find("hr").addClass("fr-tag"),this.$element.hasClass("f-placeholder")?t(this.$element.find("> "+this.valid_nodes.join(", >"))[0]).before("<hr/>"):this.document.execCommand(e),this.hide();var i=this.$element.find("hr:not(.fr-tag)").next(this.valid_nodes.join(","));i.length>0?t(i[0]).prepend(this.markers_html):this.$element.find("hr:not(.fr-tag)").after(this.options.paragraphy?"<p>"+this.markers_html+"<br/></p>":this.markers_html),this.restoreSelectionByMarkers(),this.triggerEvent(e,[],!0,!1)},t.Editable.prototype.formatBlock=function(e){if(this.disabledList.indexOf("formatBlock")>=0)return!1;if(this.browser.msie&&t.Editable.getIEversion()<9)return"n"==e&&(e=this.options.defaultTag),this.document.execCommand("formatBlock",!1,"<"+e+">"),this.triggerEvent("formatBlock"),!1;if(this.$element.hasClass("f-placeholder")){if(this.options.paragraphy||"n"!=e){"n"==e&&(e=this.options.defaultTag);var i=t("<"+e+"><br/></"+e+">");this.$element.html(i),this.setSelection(i.get(0),0),this.$element.removeClass("f-placeholder")}}else{this.saveSelectionByMarkers(),this.wrapText(),this.restoreSelectionByMarkers();var s=this.getSelectionElements();s[0]==this.$element.get(0)&&(s=this.$element.find("> "+this.valid_nodes.join(", >"))),this.saveSelectionByMarkers();for(var a,o=function(e){if("PRE"==e.get(0).tagName)for(;e.find("br + br").length>0;){var i=t(e.find("br + br")[0]);i.prev().remove(),i.replaceWith("\n\n")}},n=0;n<s.length;n++){var r=t(s[n]);if(!this.fakeEmpty(r)){if(o(r),!this.options.paragraphy&&this.emptyElement(r.get(0))&&r.append("<br/>"),"n"==e)if(this.options.paragraphy){var l="<"+this.options.defaultTag+this.attrs(r.get(0))+">"+r.html()+"</"+this.options.defaultTag+">";a=t(l)}else a=r.html()+"<br/>";else a=t("<"+e+this.attrs(r.get(0))+">").html(r.html());r.get(0)!=this.$element.get(0)?r.replaceWith(a):r.html(a)}}this.unwrapText(),this.$element.find("pre + pre").each(function(){t(this).prepend(t(this).prev().html()+"<br/><br/>"),t(this).prev().remove()});var d=this;this.$element.find(this.valid_nodes.join(",")).each(function(){"PRE"!=this.tagName&&t(this).replaceWith("<"+this.tagName+d.attrs(this)+">"+t(this).html().replace(/\n\n/gi,"</"+this.tagName+"><"+this.tagName+">")+"</"+this.tagName+">")}),this.$element.find(this.valid_nodes.join(":empty ,")+":empty").append("<br/>"),this.cleanupLists(),this.restoreSelectionByMarkers()}this.triggerEvent("formatBlock"),this.repositionEditor()},t.Editable.prototype.align=function(e){if(this.browser.msie&&t.Editable.getIEversion()<9)return this.document.execCommand(e,!1,!1),this.triggerEvent("align",[e]),!1;this.saveSelectionByMarkers(),this.wrapText(),this.restoreSelectionByMarkers(),this.saveSelectionByMarkers();var i=this.getSelectionElements();"justifyLeft"==e?e="left":"justifyRight"==e?e="right":"justifyCenter"==e?e="center":"justifyFull"==e&&(e="justify");for(var s=0;s<i.length;s++)this.parents(t(i[s]),"LI").length>0&&(i[s]=t(i[s]).parents("LI").get(0)),t(i[s]).css("text-align",e);this.cleanupLists(),this.unwrapText(),this.restoreSelectionByMarkers(),this.repositionEditor(),this.triggerEvent("align",[e])},t.Editable.prototype.indent=function(e,i){if(void 0===i&&(i=!0),this.browser.msie&&t.Editable.getIEversion()<9)return e?this.document.execCommand("outdent",!1,!1):this.document.execCommand("indent",!1,!1),!1;var s=20;e&&(s=-20),this.saveSelectionByMarkers(),this.wrapText(),this.restoreSelectionByMarkers();var a=this.getSelectionElements();this.saveSelectionByMarkers();for(var o=0;o<a.length;o++){var n=t(a[o]);if(n.parentsUntil(this.$element,"li").length>0&&(n=n.closest("li")),this.raiseEvent("indent",[n,e]))if(n.get(0)!=this.$element.get(0)){var r=parseInt(n.css("margin-left").replace(/px/,""),10),l=Math.max(0,r+s);n.css("marginLeft",l)}else{var d=t("<div>").html(n.html());n.html(d),d.css("marginLeft",Math.max(0,s))}}this.unwrapText(),this.restoreSelectionByMarkers(),i&&this.repositionEditor(),e||this.triggerEvent("indent")},t.Editable.prototype.outdent=function(t){this.indent(!0,t),this.triggerEvent("outdent")},t.Editable.prototype.execDefault=function(t,e){this.saveUndoStep(),this.document.execCommand(t,!1,e),this.triggerEvent(t,[],!0,!0)},t.Editable.prototype._startInDefault=function(t){this.focus(),this.document.execCommand(t,!1,!1),this.refreshButtons()},t.Editable.prototype._startInFontExec=function(e,i,s){this.focus();try{var a=this.getRange(),o=a.cloneRange();o.collapse(!1);var n=t('<span data-inserted="true" data-fr-verified="true" style="'+e+": "+s+';">'+t.Editable.INVISIBLE_SPACE+"</span>",this.document);o.insertNode(n[0]),n=this.$element.find("[data-inserted]"),n.removeAttr("data-inserted"),this.setSelection(n.get(0),1)}catch(r){}},t.Editable.prototype.removeFormat=function(){this.document.execCommand("removeFormat",!1,!1),this.document.execCommand("unlink",!1,!1)},t.Editable.prototype.inlineStyle=function(e,i,s){if(this.browser.webkit&&"font-size"!=e){var a=function(t){return t.attr("style").indexOf("font-size")>=0};this.$element.find("span").each(function(e,i){var s=t(i);s.attr("style")&&a(s)&&(s.data("font-size",s.css("font-size")),s.css("font-size",""))})}this.document.execCommand("fontSize",!1,4),this.saveSelectionByMarkers(),this.browser.webkit&&"font-size"!=e&&this.$element.find("span").each(function(e,i){var s=t(i);s.data("font-size")&&(s.css("font-size",s.data("font-size")),s.removeData("font-size"))});var o=function(i){var a=t(i);a.css(e)!=s&&a.css(e,""),""===a.attr("style")&&a.replaceWith(a.html())};this.$element.find("font").each(function(i,a){var n=t('<span data-fr-verified="true" style="'+e+": "+s+';">'+t(a).html()+"</span>");t(a).replaceWith(n);for(var r=n.find("span"),l=r.length-1;l>=0;l--)o(r[l])}),this.removeBlankSpans(),this.restoreSelectionByMarkers(),this.repositionEditor(),null!=i&&this.triggerEvent(i,[s],!0,!0)}}(jQuery),function(t){t.Editable.prototype.addListener=function(t,e){var i=this._events,s=i[t]=i[t]||[];s.push(e)},t.Editable.prototype.raiseEvent=function(t,e){void 0===e&&(e=[]);var i=!0,s=this._events[t];if(s)for(var a=0,o=s.length;o>a;a++){var n=s[a].apply(this,e);void 0!==n&&i!==!1&&(i=n)}return void 0===i&&(i=!0),i}}(jQuery),function(t){t.Editable.prototype.start_marker='<span class="f-marker" data-id="0" data-fr-verified="true" data-type="true"></span>',t.Editable.prototype.end_marker='<span class="f-marker" data-id="0" data-fr-verified="true" data-type="false"></span>',t.Editable.prototype.markers_html='<span class="f-marker" data-id="0" data-fr-verified="true" data-type="false"></span><span class="f-marker" data-id="0" data-fr-verified="true" data-type="true"></span>',t.Editable.prototype.text=function(){var t="";return this.window.getSelection?t=this.window.getSelection():this.document.getSelection?t=this.document.getSelection():this.document.selection&&(t=this.document.selection.createRange().text),t.toString()},t.Editable.prototype.selectionInEditor=function(){var e=this.getSelectionParent(),i=!1;return e==this.$element.get(0)&&(i=!0),i===!1&&t(e).parents().each(t.proxy(function(t,e){e==this.$element.get(0)&&(i=!0)},this)),i},t.Editable.prototype.getSelection=function(){var t="";return t=this.window.getSelection?this.window.getSelection():this.document.getSelection?this.document.getSelection():this.document.selection.createRange()},t.Editable.prototype.getRange=function(){var t=this.getRanges();return t.length>0?t[0]:null},t.Editable.prototype.getRanges=function(){var t=this.getSelection();if(t.getRangeAt&&t.rangeCount){for(var e=[],i=0;i<t.rangeCount;i++)e.push(t.getRangeAt(i));return e}return this.document.createRange?[this.document.createRange()]:[]},t.Editable.prototype.clearSelection=function(){var t=this.getSelection();try{t.removeAllRanges?t.removeAllRanges():t.empty?t.empty():t.clear&&t.clear()}catch(e){}},t.Editable.prototype.getSelectionElement=function(){var e=this.getSelection();if(e.rangeCount){var i=this.getRange(),s=i.startContainer;if(1==s.nodeType){var a=!1;s.childNodes.length>0&&s.childNodes[i.startOffset]&&t(s.childNodes[i.startOffset]).text()===this.text()&&(s=s.childNodes[i.startOffset],a=!0),!a&&s.childNodes.length>0&&t(s.childNodes[0]).text()===this.text()&&["BR","IMG","HR"].indexOf(s.childNodes[0].tagName)<0&&(s=s.childNodes[0])}for(;1!=s.nodeType&&s.parentNode;)s=s.parentNode;for(var o=s;o&&"BODY"!=o.tagName;){if(o==this.$element.get(0))return s;o=t(o).parent()[0]}}return this.$element.get(0)},t.Editable.prototype.getSelectionParent=function(){var e,i=null;return this.window.getSelection?(e=this.window.getSelection(),e.rangeCount&&(i=e.getRangeAt(0).commonAncestorContainer,1!=i.nodeType&&(i=i.parentNode))):(e=this.document.selection)&&"Control"!=e.type&&(i=e.createRange().parentElement()),null!=i&&(t.inArray(this.$element.get(0),t(i).parents())>=0||i==this.$element.get(0))?i:null},t.Editable.prototype.nodeInRange=function(t,e){var i;if(t.intersectsNode)return t.intersectsNode(e);i=e.ownerthis.document.createRange();try{i.selectNode(e)}catch(s){i.selectNodeContents(e)}return-1==t.compareBoundaryPoints(Range.END_TO_START,i)&&1==t.compareBoundaryPoints(Range.START_TO_END,i)},t.Editable.prototype.getElementFromNode=function(e){for(1!=e.nodeType&&(e=e.parentNode);null!==e&&this.valid_nodes.indexOf(e.tagName)<0;)e=e.parentNode;return null!=e&&"LI"==e.tagName&&t(e).find(this.valid_nodes.join(",")).not("li").length>0?null:t.makeArray(t(e).parents()).indexOf(this.$element.get(0))>=0?e:null},t.Editable.prototype.nextNode=function(t,e){if(t.hasChildNodes())return t.firstChild;for(;t&&!t.nextSibling&&t!=e;)t=t.parentNode;return t&&t!=e?t.nextSibling:null},t.Editable.prototype.getRangeSelectedNodes=function(t){var e=[],i=t.startContainer,s=t.endContainer;if(i==s&&"TR"!=i.tagName){if(i.hasChildNodes()&&0!==i.children.length){for(var a=i.children,o=t.startOffset;o<t.endOffset;o++)a[o]&&e.push(a[o]);return 0===e.length&&e.push(i),e}return[i]}if(i==s&&"TR"==i.tagName){var n=i.childNodes,r=t.startOffset;if(n.length>r&&r>=0){var l=n[r];if("TD"==l.tagName||"TH"==l.tagName)return[l]}}for(;i&&i!=s;)e.push(i=this.nextNode(i,s));for(i=t.startContainer;i&&i!=t.commonAncestorContainer;)e.unshift(i),i=i.parentNode;return e},t.Editable.prototype.getSelectedNodes=function(){if(this.window.getSelection){var e=this.window.getSelection();if(!e.isCollapsed){for(var i=this.getRanges(),s=[],a=0;a<i.length;a++)s=t.merge(s,this.getRangeSelectedNodes(i[a]));return s}if(this.selectionInEditor()){var o=e.getRangeAt(0).startContainer;return 3==o.nodeType?[o.parentNode]:[o]}}return[]},t.Editable.prototype.getSelectionElements=function(){var e=this.getSelectedNodes(),i=[];return t.each(e,t.proxy(function(t,e){if(null!==e){var s=this.getElementFromNode(e);i.indexOf(s)<0&&s!=this.$element.get(0)&&null!==s&&i.push(s)}},this)),0===i.length&&i.push(this.$element.get(0)),i},t.Editable.prototype.getSelectionLink=function(){var e=this.getSelectionLinks();return e.length>0?t(e[0]).attr("href"):null},t.Editable.prototype.saveSelection=function(){if(!this.selectionDisabled){this.savedRanges=[];for(var t=this.getRanges(),e=0;e<t.length;e++)this.savedRanges.push(t[e].cloneRange())}},t.Editable.prototype.restoreSelection=function(){if(!this.selectionDisabled){var t,e,i=this.getSelection();if(this.savedRanges&&this.savedRanges.length)for(i.removeAllRanges(),t=0,e=this.savedRanges.length;e>t;t+=1)i.addRange(this.savedRanges[t]);this.savedRanges=null}},t.Editable.prototype.insertMarkersAtPoint=function(t){var e=t.clientX,i=t.clientY;this.removeMarkers();var s,a=null;if("undefined"!=typeof this.document.caretPositionFromPoint?(s=this.document.caretPositionFromPoint(e,i),a=this.document.createRange(),a.setStart(s.offsetNode,s.offset),a.setEnd(s.offsetNode,s.offset)):"undefined"!=typeof this.document.caretRangeFromPoint&&(s=this.document.caretRangeFromPoint(e,i),a=this.document.createRange(),a.setStart(s.startContainer,s.startOffset),a.setEnd(s.startContainer,s.startOffset)),null!==a&&"undefined"!=typeof this.window.getSelection){var o=this.window.getSelection();o.removeAllRanges(),o.addRange(a)}else if("undefined"!=typeof this.document.body.createTextRange)try{a=this.document.body.createTextRange(),a.moveToPoint(e,i);var n=a.duplicate();n.moveToPoint(e,i),a.setEndPoint("EndToEnd",n),a.select()}catch(r){}this.placeMarker(a,!0,0),this.placeMarker(a,!1,0)},t.Editable.prototype.saveSelectionByMarkers=function(){if(!this.selectionDisabled){this.selectionInEditor()||this.focus(),this.removeMarkers();for(var t=this.getRanges(),e=0;e<t.length;e++)if(t[e].startContainer!==this.document){var i=t[e];this.placeMarker(i,!0,e),this.placeMarker(i,!1,e)}}},t.Editable.prototype.hasSelectionByMarkers=function(){var t=this.$element.find('.f-marker[data-type="true"]');return t.length>0?!0:!1},t.Editable.prototype.restoreSelectionByMarkers=function(e){if(void 0===e&&(e=!0),!this.selectionDisabled){var i=this.$element.find('.f-marker[data-type="true"]');
if(0===i.length)return!1;this.$element.is(":focus")||this.browser.msie||this.$element.focus();var s=this.getSelection();(e||this.getRange()&&!this.getRange().collapsed||!t(i[0]).attr("data-collapsed"))&&(this.browser.msie&&t.Editable.getIEversion()<9||(this.clearSelection(),e=!0));for(var a=0;a<i.length;a++){var o=t(i[a]).data("id"),n=i[a],r=this.$element.find('.f-marker[data-type="false"][data-id="'+o+'"]');if(this.browser.msie&&t.Editable.getIEversion()<9)return this.setSelection(n,0,r,0),this.removeMarkers(),!1;var l;if(l=e?this.document.createRange():this.getRange(),r.length>0){r=r[0];try{l.setStartAfter(n),l.setEndBefore(r)}catch(d){}}e&&s.addRange(l)}this.removeMarkers()}},t.Editable.prototype.setSelection=function(t,e,i,s){var a=this.getSelection();if(a){this.clearSelection();try{i||(i=t),void 0===e&&(e=0),void 0===s&&(s=e);var o=this.getRange();o.setStart(t,e),o.setEnd(i,s),a.addRange(o)}catch(n){}}},t.Editable.prototype.buildMarker=function(e,i,s){return void 0===s&&(s=""),t('<span class="f-marker"'+s+' style="display:none; line-height: 0;" data-fr-verified="true" data-id="'+i+'" data-type="'+e+'">',this.document)[0]},t.Editable.prototype.placeMarker=function(e,i,s){var a="";e.collapsed&&(a=' data-collapsed="true"');try{var o=e.cloneRange();if(o.collapse(i),o.insertNode(this.buildMarker(i,s,a)),i===!0&&a)for(var n=this.$element.find('span.f-marker[data-type="true"][data-id="'+s+'"]').get(0).nextSibling;3===n.nodeType&&0===n.data.length;)t(n).remove(),n=this.$element.find('span.f-marker[data-type="true"][data-id="'+s+'"]').get(0).nextSibling}catch(r){}},t.Editable.prototype.removeMarkers=function(){this.$element.find(".f-marker").remove()},t.Editable.prototype.getSelectionTextInfo=function(t){var e,i,s=!1,a=!1;if(this.window.getSelection){var o=this.window.getSelection();o.rangeCount&&(e=o.getRangeAt(0),i=e.cloneRange(),i.selectNodeContents(t),i.setEnd(e.startContainer,e.startOffset),s=""===i.toString(),i.selectNodeContents(t),i.setStart(e.endContainer,e.endOffset),a=""===i.toString())}else this.document.selection&&"Control"!=this.document.selection.type&&(e=this.document.selection.createRange(),i=e.duplicate(),i.moveToElementText(t),i.setEndPoint("EndToStart",e),s=""===i.text,i.moveToElementText(t),i.setEndPoint("StartToEnd",e),a=""===i.text);return{atStart:s,atEnd:a}},t.Editable.prototype.endsWith=function(t,e){return-1!==t.indexOf(e,t.length-e.length)}}(jQuery),function(t){t.Editable.hexToRGB=function(t){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(e,function(t,e,i,s){return e+e+i+i+s+s});var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null},t.Editable.hexToRGBString=function(t){var e=this.hexToRGB(t);return e?"rgb("+e.r+", "+e.g+", "+e.b+")":""},t.Editable.RGBToHex=function(t){function e(t){return("0"+parseInt(t,10).toString(16)).slice(-2)}try{return t&&"transparent"!==t?/^#[0-9A-F]{6}$/i.test(t)?t:(t=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),("#"+e(t[1])+e(t[2])+e(t[3])).toUpperCase()):""}catch(i){return null}},t.Editable.getIEversion=function(){var t,e,i=-1;return"Microsoft Internet Explorer"==navigator.appName?(t=navigator.userAgent,e=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})"),null!==e.exec(t)&&(i=parseFloat(RegExp.$1))):"Netscape"==navigator.appName&&(t=navigator.userAgent,e=new RegExp("Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})"),null!==e.exec(t)&&(i=parseFloat(RegExp.$1))),i},t.Editable.browser=function(){var t={};if(this.getIEversion()>0)t.msie=!0;else{var e=navigator.userAgent.toLowerCase(),i=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],s={browser:i[1]||"",version:i[2]||"0"};i[1]&&(t[s.browser]=!0),parseInt(s.version,10)<9&&t.msie&&(t.oldMsie=!0),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0)}return t},t.Editable.isArray=function(t){return t&&!t.propertyIsEnumerable("length")&&"object"==typeof t&&"number"==typeof t.length},t.Editable.uniq=function(e){return t.grep(e,function(i,s){return s==t.inArray(i,e)})},t.Editable.cleanWhitespace=function(e){e.contents().filter(function(){return 1==this.nodeType&&t.Editable.cleanWhitespace(t(this)),3==this.nodeType&&!/\S/.test(this.nodeValue)}).remove()}}(jQuery),function(t){t.Editable.prototype.show=function(e){if(this.hideDropdowns(),void 0!==e){if(this.options.inlineMode||this.options.editInPopup)if(null!==e&&"touchend"!==e.type){if(this.options.showNextToCursor){var i=e.pageX,s=e.pageY;i<this.$element.offset().left&&(i=this.$element.offset().left),i>this.$element.offset().left+this.$element.width()&&(i=this.$element.offset().left+this.$element.width()),s<this.$element.offset.top&&(s=this.$element.offset().top),s>this.$element.offset().top+this.$element.height()&&(s=this.$element.offset().top+this.$element.height()),20>i&&(i=20),0>s&&(s=0),this.showByCoordinates(i,s)}else this.repositionEditor();t(".froala-editor:not(.f-basic)").hide(),this.$editor.show(),0!==this.options.buttons.length||this.options.editInPopup||this.$editor.hide()}else t(".froala-editor:not(.f-basic)").hide(),this.$editor.show(),this.repositionEditor();this.hidePopups(),this.options.editInPopup||this.showEditPopupWrapper(),this.$bttn_wrapper.show(),this.refreshButtons(),this.imageMode=!1}},t.Editable.prototype.hideDropdowns=function(){this.$bttn_wrapper.find(".fr-dropdown .fr-trigger").removeClass("active"),this.$bttn_wrapper.find(".fr-dropdown .fr-trigger")},t.Editable.prototype.hide=function(t){return this.initialized?(void 0===t&&(t=!0),t?this.hideOtherEditors():(this.closeImageMode(),this.imageMode=!1),this.$popup_editor.hide(),this.hidePopups(!1),void(this.link=!1)):!1},t.Editable.prototype.hideOtherEditors=function(){for(var e=1;e<=t.Editable.count;e++)e!=this._id&&t(window).trigger("hide."+e)},t.Editable.prototype.hideBttnWrapper=function(){this.options.inlineMode&&this.$bttn_wrapper.hide()},t.Editable.prototype.showBttnWrapper=function(){this.options.inlineMode&&this.$bttn_wrapper.show()},t.Editable.prototype.showEditPopupWrapper=function(){this.$edit_popup_wrapper&&(this.$edit_popup_wrapper.show(),setTimeout(t.proxy(function(){this.$edit_popup_wrapper.find("input").val(this.$element.text()).focus().select()},this),1))},t.Editable.prototype.hidePopups=function(t){void 0===t&&(t=!0),t&&this.hideBttnWrapper(),this.raiseEvent("hidePopups")},t.Editable.prototype.showEditPopup=function(){this.showEditPopupWrapper()}}(jQuery),function(t){t.Editable.prototype.getBoundingRect=function(){var e;if(this.isLink){e={};var i=this.$element;e.left=i.offset().left-this.$window.scrollLeft(),e.top=i.offset().top-this.$window.scrollTop(),e.width=i.outerWidth(),e.height=parseInt(i.css("padding-top").replace("px",""),10)+i.height(),e.right=1,e.bottom=1,e.ok=!0}else if(this.getRange()&&this.getRange().collapsed){var s=t(this.getSelectionElement());this.saveSelectionByMarkers();var a=this.$element.find(".f-marker:first");a.css("display","inline");var o=a.offset();a.css("display","none"),e={},e.left=o.left-this.$window.scrollLeft(),e.width=0,e.height=(parseInt(s.css("line-height").replace("px",""),10)||10)-10-this.$window.scrollTop(),e.top=o.top,e.right=1,e.bottom=1,e.ok=!0,this.removeMarkers()}else this.getRange()&&(e=this.getRange().getBoundingClientRect());return e},t.Editable.prototype.repositionEditor=function(t){var e,i,s;if(this.options.inlineMode||t){if(e=this.getBoundingRect(),this.showBttnWrapper(),e.ok||e.left>=0&&e.top>=0&&e.right>0&&e.bottom>0)i=e.left+e.width/2,s=e.top+e.height,this.iOS()&&this.iOSVersion()<8||(i+=this.$window.scrollLeft(),s+=this.$window.scrollTop()),this.showByCoordinates(i,s);else if(this.options.alwaysVisible)this.hide();else{var a=this.$element.offset();this.showByCoordinates(a.left,a.top+10)}0===this.options.buttons.length&&this.hide()}},t.Editable.prototype.showByCoordinates=function(t,e){t-=22,e+=8;var i=this.$document.find(this.options.scrollableContainer);"body"!=this.options.scrollableContainer&&(t-=i.offset().left,e-=i.offset().top,this.iPad()||(e+=i.scrollTop(),t+=i.scrollLeft()));var s=Math.max(this.$popup_editor.outerWidth(),250);t+s>=i.outerWidth()-50&&t+44-s>0?(this.$popup_editor.addClass("right-side"),t=i.outerWidth()-(t+44),"static"==i.css("position")&&(t=t+parseFloat(i.css("margin-left"),10)+parseFloat(i.css("margin-right"),10)),this.$popup_editor.css("top",e),this.$popup_editor.css("right",t),this.$popup_editor.css("left","auto")):t+s<i.outerWidth()-50?(this.$popup_editor.removeClass("right-side"),this.$popup_editor.css("top",e),this.$popup_editor.css("left",t),this.$popup_editor.css("right","auto")):(this.$popup_editor.removeClass("right-side"),this.$popup_editor.css("top",e),this.$popup_editor.css("left",Math.max(i.outerWidth()-s,10)/2),this.$popup_editor.css("right","auto")),this.$popup_editor.show()},t.Editable.prototype.positionPopup=function(e){if(t(this.$editor.find('button.fr-bttn[data-cmd="'+e+'"]')).length){var i=this.$editor.find('button.fr-bttn[data-cmd="'+e+'"]'),s=i.width(),a=i.height(),o=i.offset().left+s/2,n=i.offset().top+a;this.showByCoordinates(o,n)}}}(jQuery),function(t){t.Editable.prototype.refreshImageAlign=function(t){this.$image_editor.find('.fr-dropdown > button[data-name="align"] + ul li').removeClass("active");var e="floatImageNone",i="center";t.hasClass("fr-fil")?(i="left",e="floatImageLeft"):t.hasClass("fr-fir")&&(i="right",e="floatImageRight"),this.$image_editor.find('.fr-dropdown > button[data-name="align"].fr-trigger i').attr("class","fa fa-align-"+i),this.$image_editor.find('.fr-dropdown > button[data-name="align"] + ul li[data-val="'+e+'"]').addClass("active")},t.Editable.prototype.refreshImageDisplay=function(){var t=this.$element.find(".f-img-editor");this.$image_editor.find('.fr-dropdown > button[data-name="display"] + ul li').removeClass("active"),t.hasClass("fr-dib")?this.$image_editor.find('.fr-dropdown > button[data-name="display"] + ul li[data-val="fr-dib"]').addClass("active"):this.$image_editor.find('.fr-dropdown > button[data-name="display"] + ul li[data-val="fr-dii"]').addClass("active")},t.Editable.image_commands={align:{title:"Alignment",icon:"fa fa-align-center",refresh:t.Editable.prototype.refreshImageAlign,refreshOnShow:t.Editable.prototype.refreshImageAlign,seed:[{cmd:"floatImageLeft",title:"Align Left",icon:"fa fa-align-left"},{cmd:"floatImageNone",title:"Align Center",icon:"fa fa-align-center"},{cmd:"floatImageRight",title:"Align Right",icon:"fa fa-align-right"}],callback:function(t,e,i){this[i](t)},undo:!0},display:{title:"Text Wrap",icon:"fa fa-star",refreshOnShow:t.Editable.prototype.refreshImageDisplay,namespace:"Image",seed:[{title:"Inline",value:"fr-dii"},{title:"Break Text",value:"fr-dib"}],callback:function(t,e,i){this.displayImage(t,i)},undo:!0},linkImage:{title:"Insert Link",icon:{type:"font",value:"fa fa-link"},callback:function(t){this.linkImage(t)}},replaceImage:{title:"Replace Image",icon:{type:"font",value:"fa fa-exchange"},callback:function(t){this.replaceImage(t)}},removeImage:{title:"Remove Image",icon:{type:"font",value:"fa fa-trash-o"},callback:function(t){this.removeImage(t)}}},t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{allowedImageTypes:["jpeg","jpg","png","gif"],customImageButtons:{},defaultImageTitle:"Image title",defaultImageWidth:300,defaultImageDisplay:"block",defaultImageAlignment:"center",imageButtons:["display","align","linkImage","replaceImage","removeImage"],imageDeleteConfirmation:!0,imageDeleteURL:null,imageDeleteParams:{},imageMove:!0,imageResize:!0,imageLink:!0,imageTitle:!0,imageUpload:!0,imageUploadParams:{},imageUploadParam:"file",imageUploadToS3:!1,imageUploadURL:"http://i.froala.com/upload",maxImageSize:10485760,pasteImage:!0,textNearImage:!0}),t.Editable.prototype.hideImageEditorPopup=function(){this.$image_editor&&this.$image_editor.hide()},t.Editable.prototype.showImageEditorPopup=function(){this.$image_editor&&this.$image_editor.show(),this.options.imageMove||this.$element.attr("contenteditable",!1)},t.Editable.prototype.showImageWrapper=function(){this.$image_wrapper&&this.$image_wrapper.show()},t.Editable.prototype.hideImageWrapper=function(t){this.$image_wrapper&&(this.$element.attr("data-resize")||t||(this.closeImageMode(),this.imageMode=!1),this.$image_wrapper.hide(),this.$image_wrapper.find("input").blur())},t.Editable.prototype.showInsertImage=function(){this.hidePopups(),this.showImageWrapper()},t.Editable.prototype.showImageEditor=function(){this.hidePopups(),this.showImageEditorPopup()},t.Editable.prototype.insertImageHTML=function(){var e='<div class="froala-popup froala-image-popup" style="display: none;"><h4><span data-text="true">Insert Image</span><span data-text="true">Uploading image</span><i title="Cancel" class="fa fa-times" id="f-image-close-'+this._id+'"></i></h4>';return e+='<div id="f-image-list-'+this._id+'">',this.options.imageUpload&&(e+='<div class="f-popup-line drop-upload">',e+='<div class="f-upload" id="f-upload-div-'+this._id+'"><strong data-text="true">Drop Image</strong><br>(<span data-text="true">or click</span>)<form target="frame-'+this._id+'" enctype="multipart/form-data" encoding="multipart/form-data" action="'+this.options.imageUploadURL+'" method="post" id="f-upload-form-'+this._id+'"><input id="f-file-upload-'+this._id+'" type="file" name="'+this.options.imageUploadParam+'" accept="image/*"></form></div>',this.browser.msie&&t.Editable.getIEversion()<=9&&(e+='<iframe id="frame-'+this._id+'" name="frame-'+this._id+'" src="javascript:false;" style="width:0; height:0; border:0px solid #FFF; position: fixed; z-index: -1;"></iframe>'),e+="</div>"),this.options.imageLink&&(e+='<div class="f-popup-line"><label><span data-text="true">Enter URL</span>: </label><input id="f-image-url-'+this._id+'" type="text" placeholder="http://example.com"><button class="f-browse fr-p-bttn" id="f-browser-'+this._id+'"><i class="fa fa-search"></i></button><button data-text="true" class="f-ok fr-p-bttn f-submit" id="f-image-ok-'+this._id+'">OK</button></div>'),e+="</div>",e+='<p class="f-progress" id="f-progress-'+this._id+'"><span></span></p>',e+="</div>"},t.Editable.prototype.iFrameLoad=function(){var t=this.$image_wrapper.find("iframe#frame-"+this._id);if(!t.attr("data-loaded"))return t.attr("data-loaded",!0),!1;try{var e=this.$image_wrapper.find("#f-upload-form-"+this._id);if(this.options.imageUploadToS3){var i=e.attr("action"),s=e.find('input[name="key"]').val(),a=i+s;this.writeImage(a),this.options.imageUploadToS3.callback&&this.options.imageUploadToS3.callback.call(this,a,s)}else{var o=t.contents().text();this.parseImageResponse(o)}}catch(n){this.throwImageError(7)}},t.Editable.prototype.initImage=function(){this.buildInsertImage(),(!this.isLink||this.isImage)&&this.initImagePopup(),this.addListener("destroy",this.destroyImage)},t.Editable.initializers.push(t.Editable.prototype.initImage),t.Editable.prototype.destroyImage=function(){this.$image_editor&&this.$image_editor.html("").removeData().remove(),this.$image_wrapper&&this.$image_wrapper.html("").removeData().remove()},t.Editable.prototype.buildInsertImage=function(){this.$image_wrapper=t(this.insertImageHTML()),this.$popup_editor.append(this.$image_wrapper);var e=this;if(this.$image_wrapper.on("mouseup touchend",t.proxy(function(t){this.isResizing()||t.stopPropagation()},this)),this.addListener("hidePopups",t.proxy(function(){this.hideImageWrapper(!0)}),this),this.$progress_bar=this.$image_wrapper.find("p#f-progress-"+this._id),this.options.imageUpload){if(this.browser.msie&&t.Editable.getIEversion()<=9){var i=this.$image_wrapper.find("iframe").get(0);i.attachEvent?i.attachEvent("onload",function(){e.iFrameLoad()}):i.onload=function(){e.iFrameLoad()}}this.$image_wrapper.on("change",'input[type="file"]',function(){if(void 0!==this.files)e.uploadImage(this.files);else{var i=t(this).parents("form");i.find('input[type="hidden"]').remove();var s;for(s in e.options.imageUploadParams)i.prepend('<input type="hidden" name="'+s+'" value="'+e.options.imageUploadParams[s]+'" />');if(e.options.imageUploadToS3!==!1){for(s in e.options.imageUploadToS3.params)i.prepend('<input type="hidden" name="'+s+'" value="'+e.options.imageUploadToS3.params[s]+'" />');i.prepend('<input type="hidden" name="success_action_status" value="201" />'),i.prepend('<input type="hidden" name="X-Requested-With" value="xhr" />'),i.prepend('<input type="hidden" name="Content-Type" value="" />'),i.prepend('<input type="hidden" name="key" value="'+e.options.imageUploadToS3.keyStart+(new Date).getTime()+"-"+t(this).val().match(/[^\/\\]+$/)+'" />')}else i.prepend('<input type="hidden" name="XHR_CORS_TRARGETORIGIN" value="'+e.window.location.href+'" />');e.showInsertImage(),e.showImageLoader(!0),e.disable(),i.submit()}t(this).val("")})}this.buildDragUpload(),this.$image_wrapper.on("mouseup keydown","#f-image-url-"+this._id,t.proxy(function(t){var e=t.which;e&&27===e||t.stopPropagation()},this)),this.$image_wrapper.on("click","#f-image-ok-"+this._id,t.proxy(function(){this.writeImage(this.$image_wrapper.find("#f-image-url-"+this._id).val(),!0)},this)),this.$image_wrapper.on(this.mouseup,"#f-image-close-"+this._id,t.proxy(function(t){return this.isDisabled?!1:(t.stopPropagation(),this.$bttn_wrapper.show(),this.hideImageWrapper(!0),this.options.inlineMode&&0===this.options.buttons.length&&(this.imageMode?this.showImageEditor():this.hide()),this.imageMode||(this.restoreSelection(),this.focus()),void(this.options.inlineMode||this.imageMode?this.imageMode&&this.showImageEditor():this.hide()))},this)),this.$image_wrapper.on("click",function(t){t.stopPropagation()}),this.$image_wrapper.on("click","*",function(t){t.stopPropagation()})},t.Editable.prototype.deleteImage=function(e){if(this.options.imageDeleteURL){var i=this.options.imageDeleteParams;i.info=e.data("info"),i.src=e.attr("src"),t.ajax({type:"POST",url:this.options.imageDeleteURL,data:i,crossDomain:this.options.crossDomain,xhrFields:{withCredentials:this.options.withCredentials},headers:this.options.headers}).done(t.proxy(function(t){e.parent().parent().hasClass("f-image-list")?e.parent().remove():e.parent().removeClass("f-img-deleting"),this.triggerEvent("imageDeleteSuccess",[t],!1)},this)).fail(t.proxy(function(){e.parent().removeClass("f-img-deleting"),this.triggerEvent("imageDeleteError",["Error during image delete."],!1)},this))}else e.parent().removeClass("f-img-deleting"),this.triggerEvent("imageDeleteError",["Missing imageDeleteURL option."],!1)},t.Editable.prototype.imageHandle=function(){var e=this,i=t('<span data-fr-verified="true">').addClass("f-img-handle").on({movestart:function(i){e.hide(),e.$element.addClass("f-non-selectable").attr("contenteditable",!1),e.$element.attr("data-resize",!0),t(this).attr("data-start-x",i.startX),t(this).attr("data-start-y",i.startY)},move:function(i){var s=t(this),a=i.pageX-parseInt(s.attr("data-start-x"),10);s.attr("data-start-x",i.pageX),s.attr("data-start-y",i.pageY);var o=s.prevAll("img"),n=o.width();s.hasClass("f-h-ne")||s.hasClass("f-h-se")?o.attr("width",n+a):o.attr("width",n-a),e.triggerEvent("imageResize",[],!1)},moveend:function(){t(this).removeAttr("data-start-x"),t(this).removeAttr("data-start-y"),e.$element.removeClass("f-non-selectable"),e.isImage||e.$element.attr("contenteditable",!0),e.triggerEvent("imageResizeEnd"),t(this).trigger("mouseup")},touchend:function(){t(this).trigger("moveend")}});return i},t.Editable.prototype.disableImageResize=function(){if(this.browser.mozilla)try{document.execCommand("enableObjectResizing",!1,!1),document.execCommand("enableInlineTableEditing",!1,!1)}catch(t){}},t.Editable.prototype.isResizing=function(){return this.$element.attr("data-resize")},t.Editable.prototype.getImageStyle=function(t){var e="z-index: 1; position: relative; overflow: auto;",i=t,s="padding";return t.parent().hasClass("f-img-editor")&&(i=t.parent(),s="margin"),e+=" padding-left:"+i.css(s+"-left")+";",e+=" padding-right:"+i.css(s+"-right")+";",e+=" padding-bottom:"+i.css(s+"-bottom")+";",e+=" padding-top:"+i.css(s+"-top")+";",t.hasClass("fr-dib")?(e+=" vertical-align: top; display: block;",e+=t.hasClass("fr-fir")?" float: none; margin-right: 0; margin-left: auto;":t.hasClass("fr-fil")?" float: none; margin-left: 0; margin-right: auto;":" float: none; margin: auto;"):(e+=" display: inline-block;",e+=t.hasClass("fr-fir")?" float: right;":t.hasClass("fr-fil")?" float: left;":" float: none;"),e},t.Editable.prototype.getImageClass=function(t){var e=t.split(" ");return t="fr-fin",e.indexOf("fr-fir")>=0&&(t="fr-fir"),e.indexOf("fr-fil")>=0&&(t="fr-fil"),e.indexOf("fr-dib")>=0&&(t+=" fr-dib"),e.indexOf("fr-dii")>=0&&(t+=" fr-dii"),t},t.Editable.prototype.refreshImageButtons=function(t){this.$image_editor.find("button").removeClass("active");var e=t.css("float");e=t.hasClass("fr-fil")?"Left":t.hasClass("fr-fir")?"Right":"None",this.$image_editor.find('button[data-cmd="floatImage'+e+'"]').addClass("active"),this.raiseEvent("refreshImage",[t])},t.Editable.prototype.initImageEvents=function(){document.addEventListener&&!document.dropAssigned&&(document.dropAssigned=!0,document.addEventListener("drop",t.proxy(function(e){return t(".froala-element img.fr-image-move").length?(e.preventDefault(),e.stopPropagation(),t(".froala-element img.fr-image-move").removeClass("fr-image-move"),!1):void 0},this))),this.disableImageResize();var e=this;this.$element.on("mousedown",'img:not([contenteditable="false"])',function(i){return e.isDisabled?!1:void(e.isResizing()||(e.initialized&&i.stopPropagation(),e.$element.attr("contenteditable",!1),t(this).addClass("fr-image-move")))}),this.$element.on("mouseup",'img:not([contenteditable="false"])',function(){return e.isDisabled?!1:void(e.isResizing()||(e.options.imageMove||e.isImage||e.isHTML||e.$element.attr("contenteditable",!0),t(this).removeClass("fr-image-move")))}),this.$element.on("click touchend",'img:not([contenteditable="false"])',function(i){if(e.isDisabled)return!1;if(!e.isResizing()&&e.initialized){if(i.preventDefault(),i.stopPropagation(),e.closeImageMode(),e.$element.blur(),e.refreshImageButtons(t(this)),e.$image_editor.find('.f-image-alt input[type="text"]').val(t(this).attr("alt")||t(this).attr("title")),e.showImageEditor(),!t(this).parent().hasClass("f-img-editor")||"SPAN"!=t(this).parent().get(0).tagName){var s=e.getImageClass(t(this).attr("class"));t(this).wrap('<span data-fr-verified="true" class="f-img-editor '+s+'"></span>'),0!==t(this).parents(".f-img-wrap").length||e.isImage?t(this).parents(".f-img-wrap").attr("class",s+" f-img-wrap"):t(this).parents("a").length>0?t(this).parents("a:first").wrap('<span data-fr-verified="true" class="f-img-wrap '+s+'"></span>'):t(this).parent().wrap('<span data-fr-verified="true" class="f-img-wrap '+s+'"></span>')}if(t(this).parent().find(".f-img-handle").remove(),e.options.imageResize){var a=e.imageHandle();t(this).parent().append(a.clone(!0).addClass("f-h-ne")),t(this).parent().append(a.clone(!0).addClass("f-h-se")),t(this).parent().append(a.clone(!0).addClass("f-h-sw")),t(this).parent().append(a.clone(!0).addClass("f-h-nw"))}e.showByCoordinates(t(this).offset().left+t(this).width()/2,t(this).offset().top+t(this).height()),e.imageMode=!0,e.$bttn_wrapper.find(".fr-bttn").removeClass("active"),e.clearSelection()}}),this.$element.on("mousedown touchstart",".f-img-handle",t.proxy(function(){return e.isDisabled?!1:void this.$element.attr("data-resize",!0)},this)),this.$element.on("mouseup",".f-img-handle",t.proxy(function(i){if(e.isDisabled)return!1;var s=t(i.target).prevAll("img");setTimeout(t.proxy(function(){this.$element.removeAttr("data-resize"),s.click()},this),0)},this))},t.Editable.prototype.execImage=function(e,i,s){var a=this.$element.find("span.f-img-editor"),o=a.find("img"),n=t.Editable.image_commands[e]||this.options.customImageButtons[e];n&&n.callback&&n.callback.apply(this,[o,e,i,s])},t.Editable.prototype.bindImageRefreshListener=function(e){e.refresh&&this.addListener("refreshImage",t.proxy(function(t){e.refresh.apply(this,[t])},this))},t.Editable.prototype.buildImageButton=function(t,e){var i='<button class="fr-bttn" data-namespace="Image" data-cmd="'+e+'" title="'+t.title+'">';return i+=void 0!==this.options.icons[e]?this.prepareIcon(this.options.icons[e],t.title):this.prepareIcon(t.icon,t.title),i+="</button>",this.bindImageRefreshListener(t),i},t.Editable.prototype.buildImageAlignDropdown=function(t){this.bindImageRefreshListener(t);for(var e='<ul class="fr-dropdown-menu f-align">',i=0;i<t.seed.length;i++){var s=t.seed[i];e+='<li data-cmd="align" data-namespace="Image" data-val="'+s.cmd+'" title="'+s.title+'"><a href="#"><i class="'+s.icon+'"></i></a></li>'}return e+="</ul>"},t.Editable.prototype.buildImageDropdown=function(t){return dropdown=this.buildDefaultDropdown(t),btn=this.buildDropdownButton(t,dropdown)},t.Editable.prototype.image_command_dispatcher={align:function(t){var e=this.buildImageAlignDropdown(t),i=this.buildDropdownButton(t,e);return i}},t.Editable.prototype.buildImageButtons=function(){for(var e="",i=0;i<this.options.imageButtons.length;i++){var s=this.options.imageButtons[i];if(void 0!==t.Editable.image_commands[s]||void 0!==this.options.customImageButtons[s]){var a=t.Editable.image_commands[s]||this.options.customImageButtons[s];a.cmd=s;var o=this.image_command_dispatcher[s];e+=o?o.apply(this,[a]):a.seed?this.buildImageDropdown(a,s):this.buildImageButton(a,s)}}return e},t.Editable.prototype.initImagePopup=function(){this.$image_editor=t('<div class="froala-popup froala-image-editor-popup" style="display: none">');var e=t('<div class="f-popup-line f-popup-toolbar">').appendTo(this.$image_editor);e.append(this.buildImageButtons()),this.addListener("hidePopups",this.hideImageEditorPopup),this.options.imageTitle&&t('<div class="f-popup-line f-image-alt">').append('<label><span data-text="true">Title</span>: </label>').append(t('<input type="text">').on("mouseup keydown touchend",function(t){var e=t.which;e&&27===e||t.stopPropagation()})).append('<button class="fr-p-bttn f-ok" data-text="true" data-callback="setImageAlt" data-cmd="setImageAlt" title="OK">OK</button>').appendTo(this.$image_editor),this.$popup_editor.append(this.$image_editor),this.bindCommandEvents(this.$image_editor),this.bindDropdownEvents(this.$image_editor)},t.Editable.prototype.displayImage=function(t,e){var i=t.parents("span.f-img-editor");i.removeClass("fr-dii fr-dib").addClass(e),this.triggerEvent("imageDisplayed",[t,e]),t.click()},t.Editable.prototype.floatImageLeft=function(t){var e=t.parents("span.f-img-editor");e.removeClass("fr-fin fr-fil fr-fir").addClass("fr-fil"),this.isImage&&this.$element.css("float","left"),this.triggerEvent("imageFloatedLeft",[t]),t.click()},t.Editable.prototype.floatImageNone=function(t){var e=t.parents("span.f-img-editor");e.removeClass("fr-fin fr-fil fr-fir").addClass("fr-fin"),this.isImage||(e.parent().get(0)==this.$element.get(0)?e.wrap('<div style="text-align: center;"></div>'):e.parents(".f-img-wrap:first").css("text-align","center")),this.isImage&&this.$element.css("float","none"),this.triggerEvent("imageFloatedNone",[t]),t.click()},t.Editable.prototype.floatImageRight=function(t){var e=t.parents("span.f-img-editor");e.removeClass("fr-fin fr-fil fr-fir").addClass("fr-fir"),this.isImage&&this.$element.css("float","right"),this.triggerEvent("imageFloatedRight",[t]),t.click()},t.Editable.prototype.linkImage=function(t){this.imageMode=!0,this.showInsertLink();var e=t.parents("span.f-img-editor");"A"==e.parent().get(0).tagName?(this.$link_wrapper.find('input[type="text"]').val(e.parent().attr("href")),this.$link_wrapper.find(".f-external-link").attr("href",e.parent().attr("href")),"_blank"==e.parent().attr("target")?this.$link_wrapper.find('input[type="checkbox"]').prop("checked",!0):this.$link_wrapper.find('input[type="checkbox"]').prop("checked",!1),this.$link_wrapper.find("a.f-external-link, button.f-unlink").show()):(this.$link_wrapper.find('input[type="text"]').val("http://"),this.$link_wrapper.find(".f-external-link").attr("href","#"),this.$link_wrapper.find('input[type="checkbox"]').prop("checked",this.options.alwaysBlank),this.$link_wrapper.find("a.f-external-link, button.f-unlink").hide())},t.Editable.prototype.replaceImage=function(t){this.showInsertImage(),this.imageMode=!0,this.$image_wrapper.find('input[type="text"]').val(t.attr("src")),this.showByCoordinates(t.offset().left+t.width()/2,t.offset().top+t.height())},t.Editable.prototype.removeImage=function(e){var i=e.parents("span.f-img-editor");if(0===i.length)return!1;var s=e.get(0),a="Are you sure? Image will be deleted.";if(t.Editable.LANGS[this.options.language]&&(a=t.Editable.LANGS[this.options.language].translation[a]),!this.options.imageDeleteConfirmation||confirm(a)){if(this.triggerEvent("beforeRemoveImage",[t(s)],!1)){var o=i.parents(this.valid_nodes.join(","));i.parents(".f-img-wrap").length?i.parents(".f-img-wrap").remove():i.remove(),this.refreshImageList(!0),this.hide(),o.length&&o[0]!=this.$element.get(0)&&""===t(o[0]).text()&&t(o[0]).remove(),this.wrapText(),this.triggerEvent("afterRemoveImage",[e]),this.focus(),this.imageMode=!1}}else e.click()},t.Editable.prototype.setImageAlt=function(){var t=this.$element.find("span.f-img-editor");t.find("img").attr("alt",this.$image_editor.find('.f-image-alt input[type="text"]').val()),t.find("img").attr("title",this.$image_editor.find('.f-image-alt input[type="text"]').val()),this.hide(),this.closeImageMode(),this.triggerEvent("imageAltSet")},t.Editable.prototype.buildImageMove=function(){var e=this;this.isLink||this.initDrag(),e.$element.on("dragover dragenter dragend",function(){return!1}),e.$element.on("drop",function(i){if(e.isDisabled)return!1;if(e.closeImageMode(),e.hide(),e.imageMode=!1,e.initialized||(e.$element.unbind("mousedown.element"),e.lateInit()),!e.options.imageUpload||0!==t(".froala-element img.fr-image-move").length){if(t(".froala-element .fr-image-move").length>0&&e.options.imageMove){i.preventDefault(),i.stopPropagation(),e.insertMarkersAtPoint(i.originalEvent),e.restoreSelectionByMarkers();var s=t("<div>").append(t(".froala-element img.fr-image-move").clone().removeClass("fr-image-move").addClass("fr-image-dropped")).html();e.insertHTML(s);var a=t(".froala-element img.fr-image-move").parent();t(".froala-element img.fr-image-move").remove(),a.get(0)!=e.$element.get(0)&&a.is(":empty")&&a.remove(),e.clearSelection(),e.initialized?setTimeout(function(){e.$element.find(".fr-image-dropped").removeClass(".fr-image-dropped").click()},0):e.$element.find(".fr-image-dropped").removeClass(".fr-image-dropped"),e.sync(),e.hideOtherEditors()}else i.preventDefault(),i.stopPropagation(),t(".froala-element img.fr-image-move").removeClass("fr-image-move");return!1}if(i.originalEvent.dataTransfer&&i.originalEvent.dataTransfer.files&&i.originalEvent.dataTransfer.files.length){if(e.isDisabled)return!1;var o=i.originalEvent.dataTransfer.files;e.options.allowedImageTypes.indexOf(o[0].type.replace(/image\//g,""))>=0&&(e.insertMarkersAtPoint(i.originalEvent),e.showByCoordinates(i.originalEvent.pageX,i.originalEvent.pageY),e.uploadImage(o),i.preventDefault(),i.stopPropagation())}})},t.Editable.prototype.buildDragUpload=function(){var e=this;e.$image_wrapper.on("dragover","#f-upload-div-"+this._id,function(){return t(this).addClass("f-hover"),!1}),e.$image_wrapper.on("dragend","#f-upload-div-"+this._id,function(){return t(this).removeClass("f-hover"),!1}),e.$image_wrapper.on("drop","#f-upload-div-"+this._id,function(i){return i.preventDefault(),i.stopPropagation(),e.options.imageUpload?(t(this).removeClass("f-hover"),void e.uploadImage(i.originalEvent.dataTransfer.files)):!1})},t.Editable.prototype.showImageLoader=function(e){if(void 0===e&&(e=!1),e){var i="Please wait!";t.Editable.LANGS[this.options.language]&&(i=t.Editable.LANGS[this.options.language].translation[i]),this.$progress_bar.find("span").css("width","100%").text(i)}else this.$image_wrapper.find("h4").addClass("uploading");this.$image_wrapper.find("#f-image-list-"+this._id).hide(),this.$progress_bar.show(),this.showInsertImage()
},t.Editable.prototype.hideImageLoader=function(){this.$progress_bar.hide(),this.$progress_bar.find("span").css("width","0%").text(""),this.$image_wrapper.find("#f-image-list-"+this._id).show(),this.$image_wrapper.find("h4").removeClass("uploading")},t.Editable.prototype.writeImage=function(e,i,s){if(i&&(e=this.sanitizeURL(e),""===e))return!1;var a=new Image;a.onerror=t.proxy(function(){this.hideImageLoader(),this.throwImageError(1)},this),a.onload=this.imageMode?t.proxy(function(){var t=this.$element.find(".f-img-editor > img");t.attr("src",e),this.hide(),this.hideImageLoader(),this.$image_editor.show(),this.enable(),this.triggerEvent("imageReplaced",[t,s]),setTimeout(function(){t.trigger("click")},0)},this):t.proxy(function(){this.insertLoadedImage(e,s)},this),this.showImageLoader(!0),a.src=e},t.Editable.prototype.processInsertImage=function(e,i){void 0===i&&(i=!0),this.enable(),this.restoreSelection(),this.focus();var s="";parseInt(this.options.defaultImageWidth,10)&&(s=' width="'+this.options.defaultImageWidth+'"');var a="fr-fin";"left"==this.options.defaultImageAlignment&&(a="fr-fil"),"right"==this.options.defaultImageAlignment&&(a="fr-fir"),a+=" fr-di"+this.options.defaultImageDisplay[0];var o='<img class="'+a+' fr-just-inserted" alt="'+this.options.defaultImageTitle+'" src="'+e+'"'+s+">",n=this.getSelectionElements()[0],r=this.getRange(),l=!this.browser.msie&&t.Editable.getIEversion()>8?t(r.startContainer):null;l&&l.hasClass("f-img-wrap")?(1===r.startOffset?(l.after("<"+this.options.defaultTag+'><span class="f-marker" data-type="true" data-id="0"></span><br/><span class="f-marker" data-type="false" data-id="0"></span></'+this.options.defaultTag+">"),this.restoreSelectionByMarkers(),this.getSelection().collapseToStart()):0===r.startOffset&&(l.before("<"+this.options.defaultTag+'><span class="f-marker" data-type="true" data-id="0"></span><br/><span class="f-marker" data-type="false" data-id="0"></span></'+this.options.defaultTag+">"),this.restoreSelectionByMarkers(),this.getSelection().collapseToStart()),this.insertHTML(o)):this.getSelectionTextInfo(n).atStart&&n!=this.$element.get(0)&&"TD"!=n.tagName&&"TH"!=n.tagName&&"LI"!=n.tagName?t(n).before("<"+this.options.defaultTag+">"+o+"</"+this.options.defaultTag+">"):this.insertHTML(o),this.disable()},t.Editable.prototype.insertLoadedImage=function(e,i){this.triggerEvent("imageLoaded",[e],!1),this.processInsertImage(e,!1),this.browser.msie&&this.$element.find("img").each(function(t,e){e.oncontrolselect=function(){return!1}}),this.enable(),this.hide(),this.hideImageLoader(),this.wrapText(),this.cleanupLists();var s,a=this.$element.find("img.fr-just-inserted").get(0);a&&(s=a.previousSibling),s&&3==s.nodeType&&/\u200B/gi.test(s.textContent)&&t(s).remove(),this.triggerEvent("imageInserted",[this.$element.find("img.fr-just-inserted"),i]),setTimeout(t.proxy(function(){this.$element.find("img.fr-just-inserted").removeClass("fr-just-inserted").trigger("touchend")},this),50)},t.Editable.prototype.throwImageErrorWithMessage=function(t){this.enable(),this.triggerEvent("imageError",[{message:t,code:0}],!1),this.hideImageLoader()},t.Editable.prototype.throwImageError=function(t){this.enable();var e="Unknown image upload error.";1==t?e="Bad link.":2==t?e="No link in upload response.":3==t?e="Error during file upload.":4==t?e="Parsing response failed.":5==t?e="Image too large.":6==t?e="Invalid image type.":7==t&&(e="Image can be uploaded only to same domain in IE 8 and IE 9."),this.triggerEvent("imageError",[{code:t,message:e}],!1),this.hideImageLoader()},t.Editable.prototype.uploadImage=function(e){if(!this.triggerEvent("beforeImageUpload",[e],!1))return!1;if(void 0!==e&&e.length>0){var i;if(this.drag_support.formdata&&(i=this.drag_support.formdata?new FormData:null),i){var s;for(s in this.options.imageUploadParams)i.append(s,this.options.imageUploadParams[s]);if(this.options.imageUploadToS3!==!1){for(s in this.options.imageUploadToS3.params)i.append(s,this.options.imageUploadToS3.params[s]);i.append("success_action_status","201"),i.append("X-Requested-With","xhr"),i.append("Content-Type",e[0].type),i.append("key",this.options.imageUploadToS3.keyStart+(new Date).getTime()+"-"+e[0].name)}if(i.append(this.options.imageUploadParam,e[0]),e[0].size>this.options.maxImageSize)return this.throwImageError(5),!1;if(this.options.allowedImageTypes.indexOf(e[0].type.replace(/image\//g,""))<0)return this.throwImageError(6),!1}if(i){var a;if(this.options.crossDomain)a=this.createCORSRequest("POST",this.options.imageUploadURL);else{a=new XMLHttpRequest,a.open("POST",this.options.imageUploadURL);for(var o in this.options.headers)a.setRequestHeader(o,this.options.headers[o])}a.onload=t.proxy(function(){var e="Please wait!";t.Editable.LANGS[this.options.language]&&(e=t.Editable.LANGS[this.options.language].translation[e]),this.$progress_bar.find("span").css("width","100%").text(e);try{this.options.imageUploadToS3?201==a.status?this.parseImageResponseXML(a.responseXML):this.throwImageError(3):a.status>=200&&a.status<300?this.parseImageResponse(a.responseText):this.throwImageError(3)}catch(i){this.throwImageError(4)}},this),a.onerror=t.proxy(function(){this.throwImageError(3)},this),a.upload.onprogress=t.proxy(function(t){if(t.lengthComputable){var e=t.loaded/t.total*100|0;this.$progress_bar.find("span").css("width",e+"%")}},this),this.disable(),a.send(i),this.showImageLoader()}}},t.Editable.prototype.parseImageResponse=function(e){try{var i=t.parseJSON(e);i.link?this.writeImage(i.link,!1,e):i.error?this.throwImageErrorWithMessage(i.error):this.throwImageError(2)}catch(s){this.throwImageError(4)}},t.Editable.prototype.parseImageResponseXML=function(e){try{var i=t(e).find("Location").text(),s=t(e).find("Key").text();this.options.imageUploadToS3.callback.call(this,i,s),i?this.writeImage(i):this.throwImageError(2)}catch(a){this.throwImageError(4)}},t.Editable.prototype.setImageUploadURL=function(t){t&&(this.options.imageUploadURL=t),this.options.imageUploadToS3&&(this.options.imageUploadURL="https://"+this.options.imageUploadToS3.bucket+"."+this.options.imageUploadToS3.region+".amazonaws.com/")},t.Editable.prototype.closeImageMode=function(){this.$element.find("span.f-img-editor > img").each(t.proxy(function(e,i){t(i).removeClass("fr-fin fr-fil fr-fir fr-dib fr-dii").addClass(this.getImageClass(t(i).parent().attr("class"))),t(i).parents(".f-img-wrap").length>0?"A"==t(i).parent().parent().get(0).tagName?t(i).siblings("span.f-img-handle").remove().end().unwrap().parent().unwrap():t(i).siblings("span.f-img-handle").remove().end().unwrap().unwrap():t(i).siblings("span.f-img-handle").remove().end().unwrap()},this)),this.$element.find("span.f-img-editor").length&&(this.$element.find("span.f-img-editor").remove(),this.$element.parents("span.f-img-editor").remove()),this.$element.removeClass("f-non-selectable"),this.editableDisabled||this.isHTML||this.$element.attr("contenteditable",!0),this.$image_editor&&this.$image_editor.hide(),this.$link_wrapper&&this.options.linkText&&this.$link_wrapper.find('input[type="text"].f-lt').parent().removeClass("fr-hidden")},t.Editable.prototype.refreshImageList=function(e){if(!this.isLink&&!this.options.editInPopup){var i=[],s=[],a=this;if(this.$element.find("img").each(function(e,o){var n=t(o);if(i.push(n.attr("src")),s.push(n),0!==n.parents(".f-img-editor").length||n.hasClass("fr-dii")||n.hasClass("fr-dib")||(a.options.textNearImage?n.addClass(n.hasClass("fr-fin")?"fr-dib":n.hasClass("fr-fil")||n.hasClass("fr-fir")?"fr-dii":"block"==n.css("display")&&"none"==n.css("float")?"fr-dib":"fr-dii"):(n.addClass("fr-dib"),a.options.imageButtons.splice(a.options.imageButtons.indexOf("display"),1))),a.options.textNearImage||n.removeClass("fr-dii").addClass("fr-dib"),0===n.parents(".f-img-editor").length&&!n.hasClass("fr-fil")&&!n.hasClass("fr-fir")&&!n.hasClass("fr-fin"))if(n.hasClass("fr-dii"))n.addClass("right"==n.css("float")?"fr-fir":"left"==n.css("float")?"fr-fil":"fr-fin");else{var r=n.attr("style");n.hide(),n.addClass(0===parseInt(n.css("margin-right"),10)&&r?"fr-fir":0===parseInt(n.css("margin-left"),10)&&r?"fr-fil":"fr-fin"),n.show()}n.css("margin",""),n.css("float",""),n.removeAttr("style"),n.removeAttr("data-style")}),void 0===e)for(var o=0;o<this.imageList.length;o++)i.indexOf(this.imageList[o].attr("src"))<0&&this.triggerEvent("afterRemoveImage",[this.imageList[o]],!1);this.imageList=s}},t.Editable.prototype.insertImage=function(){this.options.inlineMode||(this.closeImageMode(),this.imageMode=!1,this.positionPopup("insertImage")),this.selectionInEditor()&&this.saveSelection(),this.showInsertImage(),this.imageMode=!1,this.$image_wrapper.find('input[type="text"]').val("")}}(jQuery),function(t){t.Editable.prototype.showLinkWrapper=function(){this.$link_wrapper&&(this.$link_wrapper.show(),this.$link_wrapper.trigger("hideLinkList"),this.$link_wrapper.trigger("hideLinkClassList"),this.$link_wrapper.find("input.f-lu").removeClass("fr-error"),this.imageMode||!this.options.linkText?this.$link_wrapper.find('input[type="text"].f-lt').parent().addClass("fr-hidden"):this.$link_wrapper.find('input[type="text"].f-lt').parent().removeClass("fr-hidden"),this.imageMode&&this.$link_wrapper.find('input[type="text"].f-lu').removeAttr("disabled"),this.phone()?this.$document.scrollTop(this.$link_wrapper.offset().top+30):setTimeout(t.proxy(function(){this.imageMode&&this.iPad()||this.$link_wrapper.find('input[type="text"].f-lu').focus().select()},this),0),this.link=!0),this.refreshDisabledState()},t.Editable.prototype.hideLinkWrapper=function(){this.$link_wrapper&&(this.$link_wrapper.hide(),this.$link_wrapper.find("input").blur()),this.refreshDisabledState()},t.Editable.prototype.showInsertLink=function(){this.hidePopups(),this.showLinkWrapper()},t.Editable.prototype.initLinkEvents=function(){var e=this,i=function(t){t.stopPropagation(),t.preventDefault()},s=function(i){if(i.stopPropagation(),i.preventDefault(),e.isDisabled)return!1;if(""!==e.text())return e.hide(),!1;e.link=!0,e.clearSelection(),e.removeMarkers(),e.selectionDisabled||(t(this).before('<span class="f-marker" data-type="true" data-id="0" data-fr-verified="true"></span>'),t(this).after('<span class="f-marker" data-type="false" data-id="0" data-fr-verified="true"></span>'),e.restoreSelectionByMarkers()),e.exec("createLink");var s=t(this).attr("href")||"";e.$link_wrapper.find("input.f-lt").val(t(this).text()),e.isLink?("#"==s&&(s=""),e.$link_wrapper.find("input#f-lu-"+e._id).val(s.replace(/\&amp;/g,"&")),e.$link_wrapper.find(".f-external-link").attr("href",s||"#")):(e.$link_wrapper.find("input.f-lu").val(s.replace(/\&amp;/g,"&")),e.$link_wrapper.find(".f-external-link").attr("href",s)),e.$link_wrapper.find('input[type="checkbox"]').prop("checked","_blank"==t(this).attr("target")),e.$link_wrapper.find("li.f-choose-link-class").each(t.proxy(function(e,i){t(this).hasClass(t(i).data("class"))&&t(i).click()},this)),e.showByCoordinates(t(this).offset().left+t(this).outerWidth()/2,t(this).offset().top+(parseInt(t(this).css("padding-top"),10)||0)+t(this).height()),e.showInsertLink(),t(this).hasClass("fr-file")?e.$link_wrapper.find("input.f-lu").attr("disabled","disabled"):e.$link_wrapper.find("input.f-lu").removeAttr("disabled"),e.closeImageMode()};this.$element.on("mousedown","a",t.proxy(function(t){this.isResizing()||t.stopPropagation()},this)),this.isLink?this.iOS()?(this.$element.on("touchstart",i),this.$element.on("touchend",s)):this.$element.on("click",s):this.iOS()?(this.$element.on("touchstart",'a:not([contenteditable="false"])',i),this.$element.on("touchend",'a:not([contenteditable="false"])',s),this.$element.on("touchstart",'a[contenteditable="false"]',i),this.$element.on("touchend",'a[contenteditable="false"]',i)):(this.$element.on("click",'a:not([contenteditable="false"])',s),this.$element.on("click",'a[contenteditable="false"]',i))},t.Editable.prototype.destroyLink=function(){this.$link_wrapper.html("").removeData().remove()},t.Editable.prototype.initLink=function(){this.buildCreateLink(),this.initLinkEvents(),this.addListener("destroy",this.destroyLink)},t.Editable.initializers.push(t.Editable.prototype.initLink),t.Editable.prototype.removeLink=function(){this.imageMode?("A"==this.$element.find(".f-img-editor").parent().get(0).tagName&&t(this.$element.find(".f-img-editor").get(0)).unwrap(),this.triggerEvent("imageLinkRemoved"),this.showImageEditor(),this.$element.find(".f-img-editor").find("img").click(),this.link=!1):(this.restoreSelection(),this.document.execCommand("unlink",!1,null),this.isLink||this.$element.find("a:empty").remove(),this.triggerEvent("linkRemoved"),this.hideLinkWrapper(),this.$bttn_wrapper.show(),(!this.options.inlineMode||this.isLink)&&this.hide(),this.link=!1)},t.Editable.prototype.writeLink=function(e,i,s,a,o){var n;this.options.noFollow&&(o=!0),this.options.alwaysBlank&&(a=!0);var r="",l="";o===!0&&/^https?:\/\//.test(e)&&(r='rel="nofollow"'),a===!0&&(l='target="_blank"');var d=e;if(e=this.sanitizeURL(e),this.options.convertMailAddresses){var h=/^\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,3}$/i;h.test(e)&&0!==e.indexOf("mailto:")&&(e="mailto:"+e)}if(0!==e.indexOf("mailto:")&&this.options.linkAutoPrefix&&!/^(https?:|ftps?:|)\/\//.test(e)&&(e=this.options.linkAutoPrefix+e),""===e)return this.$link_wrapper.find("input.f-lu").addClass("fr-error").focus(),this.triggerEvent("badLink",[d],!1),!1;if(this.$link_wrapper.find("input.f-lu").removeClass("fr-error"),this.imageMode){if("A"!=this.$element.find(".f-img-editor").parent().get(0).tagName)this.$element.find(".f-img-editor").wrap('<a data-fr-link="true" href="'+e+'" '+l+" "+r+"></a>");else{var p=this.$element.find(".f-img-editor").parent();a===!0?p.attr("target","_blank"):p.removeAttr("target"),o===!0?p.attr("rel","nofollow"):p.removeAttr("rel"),p.removeClass(Object.keys(this.options.linkClasses).join(" ")),p.attr("href",e).addClass(s)}this.triggerEvent("imageLinkInserted",[e]),this.showImageEditor(),this.$element.find(".f-img-editor").find("img").click(),this.link=!1}else{var f=null;this.isLink?""===i&&(i=this.$element.text()):(this.restoreSelection(),n=this.getSelectionLinks(),n.length>0&&(f=n[0].attributes,is_file=t(n[0]).hasClass("fr-file")),this.saveSelectionByMarkers(),this.document.execCommand("unlink",!1,e),this.$element.find('span[data-fr-link="true"]').each(function(e,i){t(i).replaceWith(t(i).html())}),this.restoreSelectionByMarkers()),this.isLink?(this.$element.text(i),n=[this.$element.attr("href",e).get(0)]):(this.removeMarkers(),(this.options.linkText||""===this.text())&&(this.insertHTML('<span class="f-marker" data-fr-verified="true" data-id="0" data-type="true"></span>'+(i||e)+'<span class="f-marker" data-fr-verified="true" data-id="0" data-type="false"></span>'),this.restoreSelectionByMarkers()),this.document.execCommand("createLink",!1,e),n=this.getSelectionLinks());for(var c=0;c<n.length;c++){if(f)for(var u=0;u<f.length;u++)"href"!=f[u].nodeName&&t(n[c]).attr(f[u].nodeName,f[u].value);a===!0?t(n[c]).attr("target","_blank"):t(n[c]).removeAttr("target"),o===!0&&/^https?:\/\//.test(e)?t(n[c]).attr("rel","nofollow"):t(n[c]).removeAttr("rel"),t(n[c]).data("fr-link",!0),t(n[c]).removeClass(Object.keys(this.options.linkClasses).join(" ")),t(n[c]).addClass(s)}this.$element.find("a:empty").remove(),this.triggerEvent("linkInserted",[e]),this.hideLinkWrapper(),this.$bttn_wrapper.show(),(!this.options.inlineMode||this.isLink)&&this.hide(),this.link=!1}},t.Editable.prototype.createLinkHTML=function(){var t='<div class="froala-popup froala-link-popup" style="display: none;">';t+='<h4><span data-text="true">Insert Link</span><a target="_blank" title="Open Link" class="f-external-link" href="#"><i class="fa fa-external-link"></i></a><i title="Cancel" class="fa fa-times" id="f-link-close-'+this._id+'"></i></h4>',t+='<div class="f-popup-line fr-hidden"><input type="text" placeholder="Text" class="f-lt" id="f-lt-'+this._id+'"></div>';var e="";if(this.options.linkList.length&&(e="f-bi"),t+='<div class="f-popup-line"><input type="text" placeholder="http://www.example.com" class="f-lu '+e+'" id="f-lu-'+this._id+'"/>',this.options.linkList.length){t+='<button class="fr-p-bttn f-browse-links" id="f-browse-links-'+this._id+'"><i class="fa fa-chevron-down"></i></button>',t+='<ul id="f-link-list-'+this._id+'">';for(var i=0;i<this.options.linkList.length;i++){var s=this.options.linkList[i];t+='<li class="f-choose-link" data-nofollow="'+s.nofollow+'" data-blank="'+s.blank+'" data-body="'+s.body+'" data-title="'+s.title+'" data-href="'+s.href+'">'+s.body+"</li>"}t+="</ul>"}if(t+="</div>",Object.keys(this.options.linkClasses).length){t+='<div class="f-popup-line"><input type="text" placeholder="Choose link type" class="f-bi" id="f-luc-'+this._id+'" disabled="disabled"/>',t+='<button class="fr-p-bttn f-browse-links" id="f-links-class-'+this._id+'"><i class="fa fa-chevron-down"></i></button>',t+='<ul id="f-link-class-list-'+this._id+'">';for(var a in this.options.linkClasses){var o=this.options.linkClasses[a];t+='<li class="f-choose-link-class" data-class="'+a+'">'+o+"</li>"}t+="</ul>",t+="</div>"}return t+='<div class="f-popup-line"><input type="checkbox" id="f-checkbox-'+this._id+'"> <label data-text="true" for="f-checkbox-'+this._id+'">Open in new tab</label><button data-text="true" type="button" class="fr-p-bttn f-ok f-submit" id="f-ok-'+this._id+'">OK</button>',this.options.unlinkButton&&(t+='<button type="button" data-text="true" class="fr-p-bttn f-ok f-unlink" id="f-unlink-'+this._id+'">UNLINK</button>'),t+="</div></div>"},t.Editable.prototype.buildCreateLink=function(){this.$link_wrapper=t(this.createLinkHTML()),this.$popup_editor.append(this.$link_wrapper);var e=this;this.addListener("hidePopups",this.hideLinkWrapper),this.$link_wrapper.on("mouseup touchend",t.proxy(function(t){this.isResizing()||(t.stopPropagation(),this.$link_wrapper.trigger("hideLinkList"))},this)),this.$link_wrapper.on("click",function(t){t.stopPropagation()}),this.$link_wrapper.on("click","*",function(t){t.stopPropagation()}),this.options.linkText&&this.$link_wrapper.on("mouseup keydown","input#f-lt-"+this._id,t.proxy(function(t){var e=t.which;e&&27===e||t.stopPropagation(),this.$link_wrapper.trigger("hideLinkList"),this.$link_wrapper.trigger("hideLinkClassList")},this)),this.$link_wrapper.on("mouseup keydown touchend touchstart","input#f-lu-"+this._id,t.proxy(function(t){var e=t.which;e&&27===e||t.stopPropagation(),this.$link_wrapper.trigger("hideLinkList"),this.$link_wrapper.trigger("hideLinkClassList")},this)),this.$link_wrapper.on("click keydown","input#f-checkbox-"+this._id,function(t){var e=t.which;e&&27===e||t.stopPropagation()}),this.$link_wrapper.on("touchend","button#f-ok-"+this._id,function(t){t.stopPropagation()}).on("click","button#f-ok-"+this._id,t.proxy(function(){var t,e=this.$link_wrapper.find("input#f-lt-"+this._id),i=this.$link_wrapper.find("input#f-lu-"+this._id),s=this.$link_wrapper.find("input#f-luc-"+this._id),a=this.$link_wrapper.find("input#f-checkbox-"+this._id);t=e?e.val():"";var o=i.val();this.isLink&&""===o&&(o="#");var n="";s&&(n=s.data("class")),this.writeLink(o,t,n,a.prop("checked"))},this)),this.$link_wrapper.on("click touch","button#f-unlink-"+this._id,t.proxy(function(){this.link=!0,this.removeLink()},this)),this.options.linkList.length&&(this.$link_wrapper.on("click touch","li.f-choose-link",function(){var i=e.$link_wrapper.find("button#f-browse-links-"+e._id),s=e.$link_wrapper.find("input#f-lt-"+e._id),a=e.$link_wrapper.find("input#f-lu-"+e._id),o=e.$link_wrapper.find("input#f-checkbox-"+e._id);s&&s.val(t(this).data("body")),a.val(t(this).data("href")),o.prop("checked",t(this).data("blank")),i.click()}).on("mouseup","li.f-choose-link",function(t){t.stopPropagation()}),this.$link_wrapper.on("click","button#f-browse-links-"+this._id,function(i){i.stopPropagation();var s=e.$link_wrapper.find("ul#f-link-list-"+e._id);e.$link_wrapper.trigger("hideLinkClassList"),t(this).find("i").toggleClass("fa-chevron-down"),t(this).find("i").toggleClass("fa-chevron-up"),s.toggle()}).on("mouseup","button#f-browse-links-"+this._id,function(t){t.stopPropagation()}),this.$link_wrapper.bind("hideLinkList",function(){var t=e.$link_wrapper.find("ul#f-link-list-"+e._id),i=e.$link_wrapper.find("button#f-browse-links-"+e._id);t&&t.is(":visible")&&i.click()})),Object.keys(this.options.linkClasses).length&&(this.$link_wrapper.on("mouseup keydown","input#f-luc-"+this._id,t.proxy(function(t){var e=t.which;e&&27===e||t.stopPropagation(),this.$link_wrapper.trigger("hideLinkList"),this.$link_wrapper.trigger("hideLinkClassList")},this)),this.$link_wrapper.on("click touch","li.f-choose-link-class",function(){var i=e.$link_wrapper.find("input#f-luc-"+e._id);i.val(t(this).text()),i.data("class",t(this).data("class")),e.$link_wrapper.trigger("hideLinkClassList")}).on("mouseup","li.f-choose-link-class",function(t){t.stopPropagation()}),this.$link_wrapper.on("click","button#f-links-class-"+this._id,function(i){i.stopPropagation(),e.$link_wrapper.trigger("hideLinkList");var s=e.$link_wrapper.find("ul#f-link-class-list-"+e._id);t(this).find("i").toggleClass("fa-chevron-down"),t(this).find("i").toggleClass("fa-chevron-up"),s.toggle()}).on("mouseup","button#f-links-class-"+this._id,function(t){t.stopPropagation()}),this.$link_wrapper.bind("hideLinkClassList",function(){var t=e.$link_wrapper.find("ul#f-link-class-list-"+e._id),i=e.$link_wrapper.find("button#f-links-class-"+e._id);t&&t.is(":visible")&&i.click()})),this.$link_wrapper.on(this.mouseup,"i#f-link-close-"+this._id,t.proxy(function(){this.$bttn_wrapper.show(),this.hideLinkWrapper(),(!this.options.inlineMode&&!this.imageMode||this.isLink||0===this.options.buttons.length)&&this.hide(),this.imageMode?this.showImageEditor():(this.restoreSelection(),this.focus())},this))},t.Editable.prototype.getSelectionLinks=function(){var t,e,i,s,a=[];if(window.getSelection){var o=window.getSelection();if(o.getRangeAt&&o.rangeCount){s=this.document.createRange();for(var n=0;n<o.rangeCount;++n)if(t=o.getRangeAt(n),e=t.commonAncestorContainer,e&&1!=e.nodeType&&(e=e.parentNode),e&&"a"==e.nodeName.toLowerCase())a.push(e);else{i=e.getElementsByTagName("a");for(var r=0;r<i.length;++r)s.selectNodeContents(i[r]),s.compareBoundaryPoints(t.END_TO_START,t)<1&&s.compareBoundaryPoints(t.START_TO_END,t)>-1&&a.push(i[r])}}}else if(this.document.selection&&"Control"!=this.document.selection.type)if(t=this.document.selection.createRange(),e=t.parentElement(),"a"==e.nodeName.toLowerCase())a.push(e);else{i=e.getElementsByTagName("a"),s=this.document.body.createTextRange();for(var l=0;l<i.length;++l)s.moveToElementText(i[l]),s.compareEndPoints("StartToEnd",t)>-1&&s.compareEndPoints("EndToStart",t)<1&&a.push(i[l])}return a},t.Editable.prototype.insertLink=function(){this.options.inlineMode||(this.closeImageMode(),this.imageMode=!1,this.positionPopup("createLink")),this.selectionInEditor()&&this.saveSelection(),this.showInsertLink();var e=this.getSelectionLink()||"",i=this.getSelectionLinks();i.length>0?(this.$link_wrapper.find('input[type="checkbox"]').prop("checked","_blank"==t(i[0]).attr("target")),this.$link_wrapper.find('input[type="text"].f-lt').val(t(i[0]).text()||""),t(i[0]).hasClass("fr-file")?this.$link_wrapper.find('input[type="text"].f-lu').attr("disabled","disabled"):this.$link_wrapper.find('input[type="text"].f-lu').removeAttr("disabled"),this.$link_wrapper.find("a.f-external-link, button.f-unlink").show()):(this.$link_wrapper.find('input[type="checkbox"]').prop("checked",this.options.alwaysBlank),this.$link_wrapper.find('input[type="text"].f-lt').val(this.text()),this.$link_wrapper.find('input[type="text"].f-lu').removeAttr("disabled"),this.$link_wrapper.find("a.f-external-link, button.f-unlink").hide()),this.$link_wrapper.find(".f-external-link").attr("href",e||"#"),this.$link_wrapper.find('input[type="text"].f-lu').val(e.replace(/\&amp;/g,"&")||"http://")}}(jQuery),function(t){t.Editable.prototype.browserFixes=function(){this.backspaceEmpty(),this.fixHR(),this.domInsert(),this.fixIME(),this.cleanInvisibleSpace(),this.cleanBR(),this.insertSpace()},t.Editable.prototype.insertSpace=function(){this.browser.mozilla&&this.$element.on("keypress",t.proxy(function(t){var e=t.which;this.isHTML||32!=e||(t.preventDefault(),this.insertSimpleHTML("&nbsp;"))},this))},t.Editable.prototype.cleanBR=function(){this.$element.on("keyup",t.proxy(function(){this.$element.find(this.valid_nodes.join(" > br:last, ")+" > br:last").each(t.proxy(function(e,i){var s=t(i).prev();["TH","TD"].indexOf(t(i).parent().get(0).tagName)<0&&s.length&&"BR"!=s.get(0).tagName&&t(i).parent().text().length>0&&this.isLastSibling(i)&&t(i).remove()},this))},this))},t.Editable.prototype.replaceU200B=function(e){for(var i=0;i<e.length;i++)3==e[i].nodeType&&/\u200B/gi.test(e[i].textContent)?e[i].textContent=e[i].textContent.replace(/\u200B/gi,""):1==e[i].nodeType&&this.replaceU200B(t(e[i]).contents())},t.Editable.prototype.cleanInvisibleSpace=function(){var e=function(e){var i=t(e).text();return e&&/\u200B/.test(t(e).text())&&i.replace(/\u200B/gi,"").length>0?!0:!1};this.$element.on("keyup",t.proxy(function(){var i=this.getSelectionElement();e(i)&&0===t(i).find("li").length&&(this.saveSelectionByMarkers(),this.replaceU200B(t(i).contents()),this.restoreSelectionByMarkers())},this))},t.Editable.prototype.fixHR=function(){this.$element.on("keypress",t.proxy(function(e){var i=t(this.getSelectionElement());if(i.is("hr")||i.parents("hr").length)return!1;var s=e.which;if(8==s){var a=t(this.getSelectionElements()[0]);a.prev().is("hr")&&this.getSelectionTextInfo(a.get(0)).atStart&&(this.saveSelectionByMarkers(),a.prev().remove(),this.restoreSelectionByMarkers(),e.preventDefault())}},this))},t.Editable.prototype.backspaceEmpty=function(){this.$element.on("keydown",t.proxy(function(t){var e=t.which;!this.isHTML&&8==e&&this.$element.hasClass("f-placeholder")&&t.preventDefault()},this))},t.Editable.prototype.domInsert=function(){this.$element.on("keydown",t.proxy(function(t){var e=t.which;8===e&&(this.no_verify=!0),13===e&&(this.add_br=!0)},this)),this.$element.on("DOMNodeInserted",t.proxy(function(e){if("SPAN"!==e.target.tagName||t(e.target).attr("data-fr-verified")||this.no_verify||this.textEmpty(e.target)||t(e.target).replaceWith(t(e.target).contents()),"BR"===e.target.tagName&&setTimeout(function(){t(e.target).removeAttr("type")},0),"A"===e.target.tagName&&setTimeout(function(){t(e.target).removeAttr("_moz_dirty")},0),this.options.paragraphy&&this.add_br&&"BR"===e.target.tagName&&(t(e.target).prev().length&&"TABLE"===t(e.target).prev().get(0).tagName||t(e.target).next().length&&"TABLE"===t(e.target).next().get(0).tagName)){t(e.target).wrap('<p class="fr-p-wrap">');var i=this.$element.find("p.fr-p-wrap").removeAttr("class");this.setSelection(i.get(0))}},this)),this.$element.on("keyup",t.proxy(function(t){var e=t.which;8===e&&(this.$element.find("span:not(.fr-verified)").attr("data-fr-verified",!0),this.no_verify=!1),13===e&&(this.add_br=!0)},this))},t.Editable.prototype.fixIME=function(){try{this.$element.get(0).msGetInputContext&&(this.$element.get(0).msGetInputContext().addEventListener("MSCandidateWindowShow",t.proxy(function(){this.ime=!0},this)),this.$element.get(0).msGetInputContext().addEventListener("MSCandidateWindowHide",t.proxy(function(){this.ime=!1,this.$element.trigger("keydown"),this.oldHTML=""},this)))}catch(e){}}}(jQuery),function(t){t.Editable.prototype.handleEnter=function(){var e=t.proxy(function(){var e=this.getSelectionElement();return"LI"==e.tagName||this.parents(t(e),"li").length>0?!0:!1},this);this.$element.on("keypress",t.proxy(function(t){if(!this.isHTML&&!e()){var i=t.which;if(13==i&&!t.shiftKey){t.preventDefault(),this.saveUndoStep(),this.insertSimpleHTML("<break></break>");var s=this.getSelectionElements();s[0]==this.$element.get(0)?this.enterInMainElement(s[0]):this.enterInElement(s[0])}}},this))},t.Editable.prototype.enterInMainElement=function(e){var i=t(e).find("break").get(0);if(t(i).parent().get(0)==e)this.isLastSibling(i)?this.insertSimpleHTML("</br>"+this.markers_html+this.br):t(e).hasClass("f-placeholder")?t(e).html("</br>"+this.markers_html+this.br):this.insertSimpleHTML("</br>"+this.markers_html),t(e).find("break").remove(),this.restoreSelectionByMarkers();else if(t(i).parents(this.$element).length){for(e=this.getSelectionElement();"BREAK"==e.tagName||0===t(e).text().length;)e=e.parentNode;if(this.getSelectionTextInfo(e).atEnd)t(e).after(this.breakEnd(this.getDeepParent(e),!0)),this.$element.find("break").remove(),this.restoreSelectionByMarkers();else if(this.getSelectionTextInfo(e).atStart){for(;i.parentNode!=this.$element.get(0);)i=i.parentNode;t(i).before("<br/>"),this.$element.find("break").remove(),this.$element.find("a:empty").replaceWith(this.markers_html+"<br/>"),this.restoreSelectionByMarkers()}else this.breakMiddle(this.getDeepParent(e),!0),this.restoreSelectionByMarkers()}else t(i).remove()},t.Editable.prototype.enterInElement=function(e){["TD","TH"].indexOf(e.tagName)<0?this.getSelectionTextInfo(e).atEnd?(t(e).after(this.breakEnd(e)),this.$element.find("break").remove(),this.restoreSelectionByMarkers()):this.getSelectionTextInfo(e).atStart?(t(e).before(this.options.paragraphy?"<"+this.options.defaultTag+this.attrs(e)+">"+this.br+"</"+this.options.defaultTag+">":"<br/>"),this.$element.find("break").remove()):"PRE"==e.tagName?(this.$element.find("break").after("<br/>"+this.markers_html),this.$element.find("break").remove(),this.restoreSelectionByMarkers()):(this.breakMiddle(e),this.restoreSelectionByMarkers()):this.enterInMainElement(e)},t.Editable.prototype.breakEnd=function(e,i){void 0===i&&(i=!1);var s=t(e).find("break").get(0),a=this.br;this.options.paragraphy||(a="<br/>");var o=this.markers_html+a;for(i&&(o=this.markers_html+t.Editable.INVISIBLE_SPACE);s!=e;)"A"!=s.tagName&&"BREAK"!=s.tagName&&(o="<"+s.tagName+this.attrs(s)+">"+o+"</"+s.tagName+">"),s=s.parentNode;return i&&"A"!=s.tagName&&"BREAK"!=s.tagName&&(o="<"+s.tagName+this.attrs(s)+">"+o+"</"+s.tagName+">"),this.options.paragraphy&&(o="<"+this.options.defaultTag+this.attrs(s)+">"+o+"</"+this.options.defaultTag+">"),i&&(o=a+o),o},t.Editable.prototype.breakMiddle=function(e,i){void 0===i&&(i=!1);for(var s=t(e).find("break").get(0),a=this.markers_html,o="";s!=e;)s=s.parentNode,o=o+"</"+s.tagName+">",a="<"+s.tagName+this.attrs(s)+">"+a;var n="<"+e.tagName+this.attrs(e)+">"+t(e).html()+"</"+e.tagName+">";n=n.replace(/<break><\/break>/,o+(i?this.br:"")+a),t(e).replaceWith(n)}}(jQuery),function(t){t.Editable.prototype.isFirstSibling=function(t){var e=t.previousSibling;return e?3==e.nodeType&&""===e.textContent?this.isFirstSibling(e):!1:!0},t.Editable.prototype.isLastSibling=function(t){var e=t.nextSibling;return e?3==e.nodeType&&""===e.textContent?this.isLastSibling(e):!1:!0},t.Editable.prototype.getDeepParent=function(t){return t.parentNode==this.$element.get(0)?t:this.getDeepParent(t.parentNode)},t.Editable.prototype.attrs=function(t){for(var e="",i=t.attributes,s=0;s<i.length;s++){var a=i[s];e+=" "+a.nodeName+'="'+a.value+'"'}return e}}(jQuery),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t,e){function i(t){function e(){s?(i(),F(e),a=!0,s=!1):a=!1}var i=t,s=!1,a=!1;this.kick=function(){s=!0,a||e()},this.end=function(t){var e=i;t&&(a?(i=s?function(){e(),t()}:t,s=!0):t())}}function s(){return!0}function a(){return!1}function o(t){t.preventDefault()}function n(t){O[t.target.tagName.toLowerCase()]||t.preventDefault()}function r(t){return 1===t.which&&!t.ctrlKey&&!t.altKey}function l(t,e){var i,s;if(t.identifiedTouch)return t.identifiedTouch(e);for(i=-1,s=t.length;++i<s;)if(t[i].identifier===e)return t[i]}function d(t,e){var i=l(t.changedTouches,e.identifier);return!i||i.pageX===e.pageX&&i.pageY===e.pageY?void 0:i}function h(t){var e;r(t)&&(e={target:t.target,startX:t.pageX,startY:t.pageY,timeStamp:t.timeStamp},N(document,H.move,p,e),N(document,H.cancel,f,e))}function p(t){var e=t.data;b(t,e,t,c)}function f(){c()}function c(){R(document,H.move,p),R(document,H.cancel,f)
}function u(t){var e,i;O[t.target.tagName.toLowerCase()]||(e=t.changedTouches[0],i={target:e.target,startX:e.pageX,startY:e.pageY,timeStamp:t.timeStamp,identifier:e.identifier},N(document,U.move+"."+e.identifier,m,i),N(document,U.cancel+"."+e.identifier,g,i))}function m(t){var e=t.data,i=d(t,e);i&&b(t,e,i,v)}function g(t){var e=t.data,i=l(t.changedTouches,e.identifier);i&&v(e.identifier)}function v(t){R(document,"."+t,m),R(document,"."+t,g)}function b(t,e,i,s){var a=i.pageX-e.startX,o=i.pageY-e.startY;D*D>a*a+o*o||E(t,e,i,a,o,s)}function y(){return this._handled=s,!1}function w(t){try{t._handled()}catch(e){return!1}}function E(t,e,i,s,a,o){var n,r;e.target,n=t.targetTouches,r=t.timeStamp-e.timeStamp,e.type="movestart",e.distX=s,e.distY=a,e.deltaX=s,e.deltaY=a,e.pageX=i.pageX,e.pageY=i.pageY,e.velocityX=s/r,e.velocityY=a/r,e.targetTouches=n,e.finger=n?n.length:1,e._handled=y,e._preventTouchmoveDefault=function(){t.preventDefault()},P(e.target,e),o(e.identifier)}function k(t){var e=t.data.timer;t.data.touch=t,t.data.timeStamp=t.timeStamp,e.kick()}function $(t){var e=t.data.event,i=t.data.timer;x(),I(e,i,function(){setTimeout(function(){R(e.target,"click",a)},0)})}function x(){R(document,H.move,k),R(document,H.end,$)}function C(t){var e=t.data.event,i=t.data.timer,s=d(t,e);s&&(t.preventDefault(),e.targetTouches=t.targetTouches,t.data.touch=s,t.data.timeStamp=t.timeStamp,i.kick())}function _(t){var e=t.data.event,i=t.data.timer,s=l(t.changedTouches,e.identifier);s&&(S(e),I(e,i))}function S(t){R(document,"."+t.identifier,C),R(document,"."+t.identifier,_)}function T(t,e,i){var s=i-t.timeStamp;t.type="move",t.distX=e.pageX-t.startX,t.distY=e.pageY-t.startY,t.deltaX=e.pageX-t.pageX,t.deltaY=e.pageY-t.pageY,t.velocityX=.3*t.velocityX+.7*t.deltaX/s,t.velocityY=.3*t.velocityY+.7*t.deltaY/s,t.pageX=e.pageX,t.pageY=e.pageY}function I(t,e,i){e.end(function(){return t.type="moveend",P(t.target,t),i&&i()})}function L(){return N(this,"movestart.move",w),!0}function M(){return R(this,"dragstart drag",o),R(this,"mousedown touchstart",n),R(this,"movestart",w),!0}function B(t){"move"!==t.namespace&&"moveend"!==t.namespace&&(N(this,"dragstart."+t.guid+" drag."+t.guid,o,e,t.selector),N(this,"mousedown."+t.guid,n,e,t.selector))}function A(t){"move"!==t.namespace&&"moveend"!==t.namespace&&(R(this,"dragstart."+t.guid+" drag."+t.guid),R(this,"mousedown."+t.guid))}var D=6,N=t.event.add,R=t.event.remove,P=function(e,i,s){t.event.trigger(i,s,e)},F=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(function(){t()},25)}}(),O={textarea:!0,input:!0,select:!0,button:!0},H={move:"mousemove",cancel:"mouseup dragstart",end:"mouseup"},U={move:"touchmove",cancel:"touchend",end:"touchend"};t.event.special.movestart={setup:L,teardown:M,add:B,remove:A,_default:function(t){function s(){T(o,n.touch,n.timeStamp),P(t.target,o)}var o,n;t._handled()&&(o={target:t.target,startX:t.startX,startY:t.startY,pageX:t.pageX,pageY:t.pageY,distX:t.distX,distY:t.distY,deltaX:t.deltaX,deltaY:t.deltaY,velocityX:t.velocityX,velocityY:t.velocityY,timeStamp:t.timeStamp,identifier:t.identifier,targetTouches:t.targetTouches,finger:t.finger},n={event:o,timer:new i(s),touch:e,timeStamp:e},t.identifier===e?(N(t.target,"click",a),N(document,H.move,k,n),N(document,H.end,$,n)):(t._preventTouchmoveDefault(),N(document,U.move+"."+t.identifier,C,n),N(document,U.end+"."+t.identifier,_,n)))}},t.event.special.move={setup:function(){N(this,"movestart.move",t.noop)},teardown:function(){R(this,"movestart.move",t.noop)}},t.event.special.moveend={setup:function(){N(this,"movestart.moveend",t.noop)},teardown:function(){R(this,"movestart.moveend",t.noop)}},N(document,"mousedown.move",h),N(document,"touchstart.move",u),"function"==typeof Array.prototype.indexOf&&!function(t){for(var e=["changedTouches","targetTouches"],i=e.length;i--;)-1===t.event.props.indexOf(e[i])&&t.event.props.push(e[i])}(t)}),window.WYSIWYGModernizr=function(t,e,i){function s(t){c.cssText=t}function a(t,e){return typeof t===e}var o,n,r,l="2.7.1",d={},h=e.documentElement,p="modernizr",f=e.createElement(p),c=f.style,u=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),m={},g=[],v=g.slice,b=function(t,i,s,a){var o,n,r,l,d=e.createElement("div"),f=e.body,c=f||e.createElement("body");if(parseInt(s,10))for(;s--;)r=e.createElement("div"),r.id=a?a[s]:p+(s+1),d.appendChild(r);return o=["&#173;",'<style id="s',p,'">',t,"</style>"].join(""),d.id=p,(f?d:c).innerHTML+=o,c.appendChild(d),f||(c.style.background="",c.style.overflow="hidden",l=h.style.overflow,h.style.overflow="hidden",h.appendChild(c)),n=i(d,t),f?d.parentNode.removeChild(d):(c.parentNode.removeChild(c),h.style.overflow=l),!!n},y=function(e){var i=t.matchMedia||t.msMatchMedia;if(i)return i(e).matches;var s;return b("@media "+e+" { #"+p+" { position: absolute; } }",function(e){s="absolute"==(t.getComputedStyle?getComputedStyle(e,null):e.currentStyle).position}),s},w={}.hasOwnProperty;r=a(w,"undefined")||a(w.call,"undefined")?function(t,e){return e in t&&a(t.constructor.prototype[e],"undefined")}:function(t,e){return w.call(t,e)},Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if("function"!=typeof e)throw new TypeError;var i=v.call(arguments,1),s=function(){if(this instanceof s){var a=function(){};a.prototype=e.prototype;var o=new a,n=e.apply(o,i.concat(v.call(arguments)));return Object(n)===n?n:o}return e.apply(t,i.concat(v.call(arguments)))};return s}),m.touch=function(){var i;return"ontouchstart"in t||t.DocumentTouch&&e instanceof DocumentTouch?i=!0:b(["@media (",u.join("touch-enabled),("),p,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(t){i=9===t.offsetTop}),i};for(var E in m)r(m,E)&&(n=E.toLowerCase(),d[n]=m[E](),g.push((d[n]?"":"no-")+n));return d.addTest=function(t,e){if("object"==typeof t)for(var s in t)r(t,s)&&d.addTest(s,t[s]);else{if(t=t.toLowerCase(),d[t]!==i)return d;e="function"==typeof e?e():e,"undefined"!=typeof enableClasses&&enableClasses&&(h.className+=" "+(e?"":"no-")+t),d[t]=e}return d},s(""),f=o=null,d._version=l,d._prefixes=u,d.mq=y,d.testStyles=b,d}(this,this.document),!function(t){t.Editable.prototype.hl=window.location,t.Editable.prototype.coreInit=function(){var t=this,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=function(t){for(var e=t.toString(),i=0,s=0;s<e.length;s++)i+=parseInt(e.charAt(s),10);return i>10?i%9+1:i},s=function(t,e,i){for(var s=Math.abs(i);s-->0;)t-=e;return 0>i&&(t+=123),t},a=function(t){return t},o=function(t){if(!t)return t;for(var o="",n=a("charCodeAt"),r=a("fromCharCode"),l=e.indexOf(t[0]),d=1;d<t.length-2;d++){for(var h=i(++l),p=t[n](d),f="";/[0-9-]/.test(t[d+1]);)f+=t[++d];f=parseInt(f,10)||0,p=s(p,h,f),p^=l-1&31,o+=String[r](p)}return o},n=function(){var e=window.Function;new e("w, p, i, t",o("TeugE3Hke1uvA-21tpD1C1D5dvjfrnggF4C4I4A2uyqcD3cugbdD3B6F2oG3uqltocnaG4uwdc1C-16A6C4F5A3F4F3gsaC3fcuI-8vwzusD1E5H5qcqpvD7tf1g1lC-7B3B15A4B-16uegazI2ebzC-13uvB-8tpB1A1D2E7B5srqH4C9B3C5A-13mC-9zI-8H1B-22B-16zzC1F3A1H1D2C3A8A1C1jF3hnqwjdkbC2tF4J4C4D-17oD-11E3NeWF-7xwD-13vG2G4D1A13F-7kqcukljA28B10B10C9rB-13jB-9E3B-7nbeaB3A4C2bB1pviorC-11szI3rromqF4C5F4I3A3B6zlC-11A3cdpwB-22xwE-11vG2G4D1lC-22lksD3qkmcrC5D7D3xnxxG-7aD5E3D2D1C2G2A4A1hxhooC2tpioB6B6B4E5G3E1uB17C11C11C3A-13oA-9H3ezrd1A3D5C2oB4C1mA-21oC1A-13D6C1B4sJ3lC5A1F5F-11kyG3I-7zC5A4C3vB1cD1yglpuuoC2uzyD7C2A5F1sguF3bB6E3D4VB-8H-8A5E2vC2B3D4gfh1A13A10zqwrhqE1A2B15B7A6D6cC5F3AJA1OA1LE7PG5WI4QA10c1A4QC4ZG3D4A3A3A6a1E2jbE4I3lA9d1doiuAiB1NaWB-11xwC-8vD2C3C7A1E4E1A1A3E4iB7mkbbpFlA3SzJf1A-9pH-8A-63A2A4B6A2F5G2D1F1A5vB6vnegH-9KcB10sB7aexxcobuD3A3C4F3A4F2C2H1B3qD3uszzxNdC6A6A3D4C5H4F4H3C-21B8eaG-10dD-8sI-7qD2E3C4F2A3E2D1gkD-16mD6UB4G1A29roilfA-9E4Jxb1ldxD-11A-9G3H-8sb1A3MA3B1A-9A2G1A-63A13B7fD5A5QA-8uIB4IB2yKC1GF4SA16VA7oUF2F4C3hwyYC5c1B2cJB2FC5C3cf1yOF1gEA10B3YB1F4H-9wH4H-7UB6a1A4d1H4ja5F2A3bHC3g1icA11A-31LC7D2C1IC1HA32B-31bd1B-13cG-10A-8sa4A11YC5tufdgA14B-33B-21oE1F3MC1zJA16B2D3jE6pkiRA16TB7PB4qC-9XF3ZC7sdeuEE1DJ2C2HC1D-11IH5H1E1UC11WE6C-11qg1C1A18pqYE4D4D4d1G2BA8bEA5D1C-9OH4A4yOA2OE2ysPA31SB10b1B6ZG4c1H3a2A9c2C7AB3GB2aA1B8iB-16deJF1OA6kikQD1F5e1I4VA12XC6mle1C2F3C2cziEF3EB3C1D1cxOC7E1E1bSA2H3RB7tzvc1H3XB12hmnenHC2GB8DB6C2E1eh1xuGC11D7ePD5UE4WB17C-21D-16D5b1C3f1H3YA7mgE1A2C2EH2laB-22xdiLB4G4A33SB11WE5rB4A-8B-7A-61xwWC5mAD3B2D2FC9C3E4xOG4C1A4NC2IE7dkieTA3A9B5whpmyTB11amjipAI2OB3LA2EOE1JE1TB16TA8PB5QC4YA22kb2A4C5fedDA11EB4DA2FA4A2KA27A3wOE3RC5yvmcPD8qF5pB3yudwBE5A1agfNA12IB1ID6C1B1JF4I4B16QB1C6B5g1PF3PC9ZA5E5D-11fkBC2A5C3D1D5B2G2aBH1ID2OC1rG-10qB-7F-7VB8d1B4KG-10C-8C-7uwA-16DD4A2G3nqEA4d2hNB4E1B1zufWC7wA4WD1D4jqhwc1G4g1G3gD2FB4LF3OD2ifB-33IA1KD2IA4YE4B2A8A5C1C1B3mrzhC6B1ltF5G2C-8=="))(t,a,a(o),t.hl)};n()},t.Editable.initializers.push(t.Editable.prototype.coreInit)}(jQuery),function(t){t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{allowedBlankTags:[],selfClosingTags:["br","button","input","img","hr","param","!--","source","embed","!"]}),t.Editable.TAG_ORDER=["main","section","header","footer","article","details","legend","summary","table","thead","tbody","tfoot","tr","th","td","ul","ol","li","h1","h2","h3","h4","h5","h6","pre","blockquote","p","br","a","span","strong","em","strike","u","iframe","object","param","video","source","embed"],t.Editable.prototype.isClosingTag=function(t){return t?null!==t.match(/^<\/([a-zA-Z0-9]+)([^<]+)*>$/gi):!1},t.Editable.prototype.tagName=function(t){return t.replace(/^<\/?([a-zA-Z0-9-!]+)([^<]+)*>$/gi,"$1").toLowerCase()},t.Editable.SELF_CLOSING_AFTER=["source"],t.Editable.prototype.isSelfClosingTag=function(t){var e=this.tagName(t);return this.options.selfClosingTags.indexOf(e.toLowerCase())>=0},t.Editable.prototype.tagKey=function(t){return t.type+(t.attrs||[]).sort().join("|")},t.Editable.prototype.extendedKey=function(t){return this.tagKey(t)+JSON.stringify(t.style)},t.Editable.prototype.mapDOM=function(e){var i=[],s={},a={},o=0,n=this;t(e).find(".f-marker").html(t.Editable.INVISIBLE_SPACE);var r=function(e,i){if(3===e.nodeType)return[];if(8===e.nodeType)return[{comment:!0,attrs:{},styles:{},idx:o++,sp:i,ep:i,text:e.textContent}];var s=e.tagName;"B"==s&&(s="STRONG"),"I"==s&&(!e.className||e.className.indexOf("fa-")<0)&&(s="EM"),e.style.display="";var a={},r=[],l=null;if(e.attributes)for(var d=0;d<e.attributes.length;d++){var h=e.attributes[d];"style"==h.nodeName?l=h.value:a[h.nodeName]=h.value}if(l){var p=l.match(/([^:]*):([^:;]*(;|$))/gi);if(p)for(var f=0;f<p.length;f++){var c=p[f].split(":"),u=c.slice(1).join(":").trim();";"==u[u.length-1]&&(u=u.substr(0,u.length-1)),r[c[0].trim()]=u}}var m=[];if(t.isEmptyObject(a)&&"SPAN"==e.tagName&&!t.isEmptyObject(r)){for(var g in r){var v={};v[g]=r[g],m.push({selfClosing:!1,attrs:a,styles:v,idx:o++,sp:i,ep:i+e.textContent.length,tagName:s})}return m}return[{selfClosing:n.options.selfClosingTags.indexOf(s.toLowerCase())>=0,attrs:a,styles:r,idx:o++,sp:i,ep:i+e.textContent.length,tagName:s}]},l=function(t,n){var d,h,p;if(t!=e)for(h=r(t,n),d=0;d<h.length;d++)p=h[d],i.push(p),s[p.sp]||(s[p.sp]={}),a[p.ep]||(a[p.ep]={}),s[p.sp][p.tagName]||(s[p.sp][p.tagName]=[]),a[p.ep][p.tagName]||(a[p.ep][p.tagName]=[]),s[p.sp][p.tagName].push(p),a[p.ep][p.tagName].push(p);var f=t.childNodes;if(f){for(d=0;d<f.length;d++)d>0&&8!=f[d-1].nodeType&&(n+=f[d-1].textContent.length),l(f[d],n);if(h)for(d=0;d<h.length;d++)p=h[d],p.ci=o++,s[p.ep]||(s[p.ep]={}),s[p.ep][p.tagName]||(s[p.ep][p.tagName]=[]),s[p.ep][p.tagName].push({shadow:!0,ci:o-1})}},d=function(){var e,a,o,n;for(e in s)for(var r in s[e])for(o=0;o<s[e][r].length;o++)if(a=s[e][r][o],!(a.selfClosing||a.dirty||a.shadow||a.comment))for(var l=o+1;l<s[e][r].length;l++)if(n=s[e][r][l],!(n.selfClosing||n.dirty||n.shadow||n.comment||1!=Object.keys(a.styles).length||1!=Object.keys(n.styles).length||n.sp==n.ep)){var d=Object.keys(a.styles)[0];if(n.styles[d]){a.sp=n.ep;for(var h=0;h<s[a.sp][a.tagName].length;h++){var p=s[a.sp][a.tagName][h];if(p.shadow&&p.ci==n.ci){s[a.sp][a.tagName].splice(h,0,a);break}}s[e][r].splice(o,1),o--;break}}for(e=0;e<i.length;e++)if(a=i[e],!a.dirty&&!a.selfClosing&&!a.comment)if(a.sp==a.ep&&t.isEmptyObject(a.attrs)&&t.isEmptyObject(a.style))a.dirty=!0;else if(s[a.ep]&&s[a.ep][a.tagName])for(o=0;o<s[a.ep][a.tagName].length;o++)if(n=s[a.ep][a.tagName][o],!n.dirty&&a!=n&&!a.selfClosing&&!n.shadow&&!n.comment&&t.isEmptyObject(n.attrs)&&JSON.stringify(n.styles)==JSON.stringify(a.styles)){a.ep=n.ep,n.dirty=!0,e--;break}for(e=0;e<i.length;e++)if(a=i[e],!a.dirty&&!a.selfClosing&&!a.comment)if(a.sp==a.ep&&t.isEmptyObject(a.attrs)&&t.isEmptyObject(a.style))a.dirty=!0;else if(s[a.sp]&&s[a.sp][a.tagName])for(o=s[a.sp][a.tagName].length-1;o>=0;o--)n=s[a.sp][a.tagName][o],n.dirty||a!=n&&(a.selfClosing||n.shadow||n.comment||a.ep==n.ep&&t.isEmptyObject(n.attrs)&&(a.styles=t.extend(a.styles,n.styles),n.dirty=!0))};l(e,0),d();for(var h=i.length-1;h>=0;h--)i.dirty&&i.splice(h,1);return i},t.Editable.prototype.sortNodes=function(t,e){if("BR"==t.tagName)return-1;if("BR"==e.tagName)return 1;if(t.comment)return 1;var i=t.ep-t.sp,s=e.ep-t.sp;return i==s?e.ci-t.ci:s-i},t.Editable.prototype.openTag=function(t){var e,i="<"+t.tagName.toLowerCase(),s=Object.keys(t.attrs).sort();for(e=0;e<s.length;e++){var a=s[e];i+=" "+a+'="'+t.attrs[a]+'"'}var o="",n=Object.keys(t.styles).sort();for(e=0;e<n.length;e++){var r=n[e];null!=t.styles[r]&&(o+=r.replace("_","-")+": "+t.styles[r]+"; ")}return""!==o&&(i+=' style="'+o.trim()+'"'),i+=">"},t.Editable.prototype.commentTag=function(t){var e="";if(t.selfClosing){var i;e="<"+t.tagName.toLowerCase();var s=Object.keys(t.attrs).sort();for(i=0;i<s.length;i++){var a=s[i];e+=" "+a+'="'+t.attrs[a]+'"'}var o="",n=Object.keys(t.styles).sort();for(i=0;i<n.length;i++){var r=n[i];null!=t.styles[r]&&(o+=r.replace("_","-")+": "+t.styles[r]+"; ")}""!==o&&(e+=' style="'+o.trim()+'"'),e+="/>"}else t.comment&&(e="<!--"+t.text+"-->");return e},t.Editable.prototype.closeTag=function(t){return"</"+t.tagName.toLowerCase()+">"},t.Editable.prototype.nodesOpenedAt=function(t,e){for(var i=[],s=t.length-1;s>=0&&t[s].sp==e;)i.push(t.pop()),s--;return i},t.Editable.prototype.cleanOutput=function(e,i){var s,a,o,n;i&&t(e).html(t(e).html().replace(/\u200B/gi,""));var r=this.mapDOM(e,i).sort(function(t,e){return e.sp-t.sp}),l=e.textContent;html="";var d=[],h=-1,p=t.proxy(function(){for(var e="";d.length;){var i=d.pop();i.selfClosing||i.comment?e+=this.commentTag(i):(!t.isEmptyObject(i.attrs)||this.options.allowedBlankTags.indexOf(i.tagName)>=0)&&(e=this.openTag(i)+e+this.closeTag(i))}html+=e},this),f={},c=[];for(s=0;s<=l.length;s++){if(f[s])for(a=f[s].length-1;a>=0;a--)if(c[c.length-1].tagName==f[s][a].tagName&&JSON.stringify(c[c.length-1].styles)==JSON.stringify(f[s][a].styles))html+=this.closeTag(f[s][a]),c.pop();else{for(var u=[];c[c.length-1].tagName!==f[s][a].tagName||JSON.stringify(c[c.length-1].styles)!==JSON.stringify(f[s][a].styles);)n=c.pop(),html+=this.closeTag(n),u.push(n);for(html+=this.closeTag(f[s][a]),c.pop();u.length;){var m=u.pop();html+=this.openTag(m),c.push(m)}}for(var g=this.nodesOpenedAt(r,s).sort(this.sortNodes).reverse();g.length;){var v=g.pop();if(!v.dirty)if(v.selfClosing||v.comment)v.ci>h||"BR"==v.tagName?(p(),html+=this.commentTag(v),h=v.ci):d.length?(d.push(v),h=v.ci):(html+=this.commentTag(v),h=v.ci);else if(v.ep>v.sp){v.ci>h&&p();var b=[];if("A"==v.tagName)for(var y=v.sp+1;y<v.ep;y++)if(f[y]&&f[y].length)for(o=0;o<f[y].length;o++)b.push(f[y][o]),html+=this.closeTag(f[y][o]),c.pop();var w=[];if("SPAN"==v.tagName&&("#123456"==v.styles["background-color"]||"#123456"===t.Editable.RGBToHex(v.styles["background-color"])||"#123456"==v.styles.color||"#123456"===t.Editable.RGBToHex(v.styles.color)))for(;c.length;){var E=c.pop();html+=this.closeTag(E),w.push(E)}for(html+=this.openTag(v),h=v.ci,c.push(v),f[v.ep]||(f[v.ep]=[]),f[v.ep].push(v);b.length;)v=b.pop(),html+=this.openTag(v),c.push(v);for(;w.length;)v=w.pop(),html+=this.openTag(v),c.push(v)}else v.sp==v.ep&&(d.push(v),h=v.ci)}p(),s!=l.length&&(html+=l[s])}return html=html.replace(/(<span[^>]*? class\s*=\s*["']?f-marker["']?[^>]+>)\u200B(<\/span>)/gi,"$1$2")},t.Editable.prototype.cleanify=function(e,i,s){if(this.browser.msie&&t.Editable.getIEversion()<9)return!1;var a;if(this.isHTML)return!1;void 0===e&&(e=!0),void 0===s&&(s=!0),this.no_verify=!0,this.$element.find("span").removeAttr("data-fr-verified"),s&&this.saveSelectionByMarkers(),e?a=this.getSelectionElements():(a=this.$element.find(this.valid_nodes.join(",")),0===a.length&&(a=[this.$element.get(0)]));var o,n;if(a[0]!=this.$element.get(0))for(var r=0;r<a.length;r++){var l=t(a[r]);0===l.find(this.valid_nodes.join(",")).length&&(o=l.html(),n=this.cleanOutput(l.get(0),i),n!==o&&l.html(n))}else 0===this.$element.find(this.valid_nodes.join(",")).length&&(o=this.$element.html(),n=this.cleanOutput(this.$element.get(0),i),n!==o&&this.$element.html(n));this.$element.find("[data-fr-idx]").removeAttr("data-fr-idx"),this.$element.find(".f-marker").html(""),s&&this.restoreSelectionByMarkers(),this.$element.find("span").attr("data-fr-verified",!0),this.no_verify=!1}}(jQuery),!function(t){t.Editable.commands=t.extend(t.Editable.commands,{table:{title:"Table",icon:"fa fa-table",callback:function(t,e,i){this.table_commands[e]?this.table_commands[e].apply(this,[e,i]):this.table_commands.insertTable.apply(this,[e,i]),this.cleanupTables()}}}),t.Editable.DEFAULTS.buttons[t.Editable.DEFAULTS.buttons.indexOf("insertHorizontalRule")]="table",t.Editable.prototype.table_commands={insertTable:function(t,e){this.insertTable(t,e)},insertRowAbove:function(){this.insertRow("above")},insertRowBelow:function(){this.insertRow("below")},insertColumnBefore:function(){this.insertColumn("before")},insertColumnAfter:function(){this.insertColumn("after")},deleteColumn:function(){this.deleteColumn()},deleteRow:function(){this.deleteRow()},insertCellBefore:function(){this.insertCell("before")},insertCellAfter:function(){this.insertCell("after")},mergeCells:function(){this.mergeCells()},deleteCell:function(){this.deleteCell()},splitVertical:function(){this.splitVertical()},splitHorizontal:function(){this.splitHorizontal()},insertHeader:function(){this.insertHeader()},deleteHeader:function(){this.deleteHeader()},deleteTable:function(){this.deleteTable()}},t.Editable.prototype.command_dispatcher=t.extend(t.Editable.prototype.command_dispatcher,{table:function(t){var e=this.buildDropdownTable(),i=this.buildDropdownButton(t,e,"fr-table");return this.bindTableDropdownEvents(),i}}),t.Editable.prototype.tableTab=function(){var e;this.currentCell&&(e=this.currentCell());var i=t(this.getSelectionElement());return i.parents("ul, ol").length>0?!0:e&&this.nextCell()?(this.setSelection(this.nextCell()),!1):void 0},t.Editable.prototype.tableShiftTab=function(){var e;this.currentCell&&(e=this.currentCell());var i=t(this.getSelectionElement());return i.parents("ul, ol").length>0?!0:e&&this.prevCell()?(this.setSelection(this.prevCell()),!1):void 0},t.Editable.prototype.initTable=function(){var e=this;this.$editor.on("click mouseup touch touchend",".fr-table a",function(i){i.preventDefault(),i.stopPropagation(),e.android()&&(t(this).parent().siblings().removeClass("hover"),t(this).parent().addClass("hover"))}),this.addListener("tab",this.tableTab),this.addListener("shift+tab",this.tableShiftTab)},t.Editable.initializers.push(t.Editable.prototype.initTable),t.Editable.prototype.buildDropdownTable=function(){var t='<ul class="fr-dropdown-menu fr-table">';t+='<li> <a href="#"><span data-text="true">Insert table</span> <i class="fa fa-chevron-right"></i></a><div class="select-table"> ',t+='<div class="fr-t-info">1 x 1</div>';for(var e=1;10>=e;e++){for(var i=1;10>=i;i++){var s="inline-block";(e>5||i>5)&&(s="none");var a="fr-bttn ";1==e&&1==i&&(a+=" hover"),t+='<span class="'+a+'" data-cmd="table" data-val="'+e+'" data-param="'+i+'" style="display: '+s+';"><span></span></span>'}t+='<div class="new-line"></div>'}return t+="</div> </li>",t+='<li><a href="#"><span data-text="true">Cell</span> <i class="fa fa-chevron-right"></i></a> <ul> <li data-cmd="table" data-val="insertCellBefore"><a href="#" data-text="true">Insert cell before</a></li><li data-cmd="table" data-val="insertCellAfter"><a href="#" data-text="true">Insert cell after</a></li><li data-cmd="table" data-val="deleteCell"><a href="#" data-text="true">Delete cell</a></li><li data-cmd="table" data-val="mergeCells"><a href="#" data-text="true">Merge cells</a></li><li data-cmd="table" data-val="splitHorizontal"><a href="#" data-text="true">Horizontal split</a></li><li data-cmd="table" data-val="splitVertical"><a href="#" data-text="true">Vertical split</a></li></ul></li>',t+='<li><a href="#"><span data-text="true">Row</span> <i class="fa fa-chevron-right"></i></a> <ul><li data-cmd="table" data-val="insertRowAbove"><a href="#" data-text="true">Insert row above</a></li><li data-cmd="table" data-val="insertRowBelow"><a href="#" data-text="true">Insert row below</a></li><li data-cmd="table" data-val="deleteRow"><a href="#" data-text="true">Delete row</a></li></ul></li>',t+='<li><a href="#"><span data-text="true">Column</span> <i class="fa fa-chevron-right"></i></a> <ul> <li data-cmd="table" data-val="insertColumnBefore"><a href="#" data-text="true">Insert column before</a></li> <li data-cmd="table" data-val="insertColumnAfter"><a href="#" data-text="true">Insert column after</a></li> <li data-cmd="table" data-val="deleteColumn"><a href="#" data-text="true">Delete column</a></li> </ul></li>',t+='<li data-cmd="table" data-val="deleteTable"><a href="#" data-text="true">Delete table</a></li>',t+="</ul>"},t.Editable.prototype.bindTableDropdownEvents=function(){var e=this;this.$bttn_wrapper.on("mouseenter",".fr-table .select-table > span",function(){var i=t(this).data("val"),s=t(this).data("param");e.$bttn_wrapper.find(".fr-table .select-table .fr-t-info").text(i+" x "+s),e.$bttn_wrapper.find(".fr-table .select-table > span").removeClass("hover");for(var a=1;10>=a;a++)for(var o=0;10>=o;o++){var n=e.$bttn_wrapper.find('.fr-table .select-table > span[data-val="'+a+'"][data-param="'+o+'"]');i>=a&&s>=o?n.addClass("hover"):(i+1>=a||5>=a)&&(s+1>=o||5>=o)?n.css("display","inline-block"):(a>5||o>5)&&n.css("display","none")}}),this.$bttn_wrapper.on("mouseleave",".fr-table .select-table",function(){e.$bttn_wrapper.find('.fr-table .select-table > span[data-val="1"][data-param="1"]').trigger("mouseenter")}),this.android()&&this.$bttn_wrapper.on("touchend",".fr-table .fr-trigger",function(){t(this).parents(".fr-table").find(".hover").removeClass("hover")})},t.Editable.prototype.tableMap=function(){var e=this.currentTable(),i=[];return e&&e.find("tr:not(:empty)").each(function(e,s){var a=t(s),o=0;a.find("th, td").each(function(s,a){for(var n=t(a),r=parseInt(n.attr("colspan"),10)||1,l=parseInt(n.attr("rowspan"),10)||1,d=e;e+l>d;d++)for(var h=o;o+r>h;h++)i[d]||(i[d]=[]),i[d][h]?o++:i[d][h]=a;o+=r})}),i},t.Editable.prototype.cellOrigin=function(t,e){for(var i=0;i<e.length;i++)for(var s=0;s<e[i].length;s++)if(e[i][s]==t)return{row:i,col:s}},t.Editable.prototype.canMergeCells=function(){var e=this.getSelectionCells();if(e.length<2)return!1;for(var i=this.tableMap(),s=0,a=32e3,o=0,n=32e3,r=0,l=0;l<e.length;l++){var d=t(e[l]),h=parseInt(d.attr("colspan"),10)||1,p=parseInt(d.attr("rowspan"),10)||1,f=this.cellOrigin(e[l],i);s+=h*p,a=Math.min(a,f.col),o=Math.max(o,f.col+h),n=Math.min(n,f.row),r=Math.max(r,f.row+p)}return s==(o-a)*(r-n)?{row:n,col:a,colspan:o-a,rowspan:r-n,map:i,cells:e}:null},t.Editable.prototype.getSelectionCells=function(){var e,i=[];if(this.browser.webkit||this.browser.msie){var s=this.getSelectionElements();for(e=0;e<s.length;e++)("TD"==s[e].tagName||"TH"==s[e].tagName)&&i.push(s[e])}else{var a=this.getRanges();for(e=0;e<a.length;e++){var o=a[e],n=!1;if("TD"==o.startContainer.tagName||"TH"==o.startContainer.tagName)i.push(o.startContainer),n=!0;else{var r=o.startContainer.childNodes,l=o.startOffset;if(r.length>l&&l>=0){var d=r[l];("TD"==d.tagName||"TH"==d.tagName)&&(i.push(d),n=!0)}}if(n===!1){var h=t(o.startContainer).parents("td:first, th:first");h.length>0&&i.push(h.get(0))}}}return i},t.Editable.prototype.currentCell=function(){var t=this.getSelectionCells();return t.length>0?t[0]:null},t.Editable.prototype.prevCell=function(){var e=this.currentCell();if(e){if(t(e).prev("td").length)return t(e).prev("td").get(0);if(t(e).parent().prev("tr").find("td").length)return t(e).parent().prev("tr").find("td:last").get(0)}return null},t.Editable.prototype.nextCell=function(){var e=this.currentCell();if(e){if(t(e).next("td").length)return t(e).next("td").get(0);if(t(e).parent().next("tr").find("td").length)return t(e).parent().next("tr").find("td").get(0)}return null},t.Editable.prototype.currentTable=function(){for(var e=t(this.getSelectionElement());e.get(0)!=this.$element.get(0)&&e.get(0)!=this.$document.find("body").get(0)&&"TABLE"!=e.get(0).tagName;)e=e.parent();return e.get(0)!=this.$element.get(0)?e:null},t.Editable.prototype.focusOnTable=function(){var t=this.currentTable();if(t){var e=t.find("td:first");this.setSelection(e.get(0))}},t.Editable.prototype.insertCell=function(e){for(var i=this.getSelectionCells(),s=0;s<i.length;s++){var a=t(i[s]);"before"==e?a.before(a.clone().removeAttr("colspan").removeAttr("rowspan").html(t.Editable.INVISIBLE_SPACE)):"after"==e&&a.after(a.clone().removeAttr("colspan").removeAttr("rowspan").html(t.Editable.INVISIBLE_SPACE))}"before"==e?this.triggerEvent("cellInsertedBefore"):"after"==e&&this.triggerEvent("cellInsertedAfter")},t.Editable.prototype.mergeCells=function(){var e=this.canMergeCells();if(e){var i=t(e.map[e.row][e.col]);i.attr("colspan",e.colspan),i.attr("rowspan",e.rowspan);for(var s=0;s<e.cells.length;s++){var a=e.cells[s];if(i.get(0)!=a){var o=t(a);i.append(o.html()),o.remove()}}this.setSelection(i.get(0))}this.hide(),this.triggerEvent("cellsMerged")},t.Editable.prototype.deleteCell=function(){for(var e=this.getSelectionCells(),i=0;i<e.length;i++){var s=t(e[i]);s.remove()}this.focusOnTable(),this.hide(),this.triggerEvent("cellDeleted")},t.Editable.prototype.insertHeader=function(){var t=this.currentTable();t&&t.find(" > thead").length>0&&this.triggerEvent("headerInserted")},t.Editable.prototype.deleteHeader=function(){},t.Editable.prototype.insertColumn=function(e){var i=this.currentCell();if(i)for(var s=t(i),a=this.tableMap(),o=this.cellOrigin(s.get(0),a),n=0;n<a.length;n++){var r=a[n][o.col],l=parseInt(t(r).attr("colspan"),10)||1,d=parseInt(t(r).attr("rowspan"),10)||1;if("before"==e){var h=a[n][o.col-1];h?h==r?t(h).attr("colspan",l+1):d>1?t(h).after("<"+h.tagName+">"+t.Editable.INVISIBLE_SPACE+"</"+h.tagName+">"):t(r).before("<"+r.tagName+">"+t.Editable.INVISIBLE_SPACE+"</"+r.tagName+">"):t(r).before("<"+r.tagName+">"+t.Editable.INVISIBLE_SPACE+"</"+r.tagName+">")}else if("after"==e){var p=a[n][o.col+1];p?p==r?t(p).attr("colspan",l+1):d>1?t(p).before("<"+p.tagName+">"+t.Editable.INVISIBLE_SPACE+"</"+p.tagName+">"):t(r).after("<"+r.tagName+">"+t.Editable.INVISIBLE_SPACE+"</"+r.tagName+">"):t(r).after("<"+r.tagName+">"+t.Editable.INVISIBLE_SPACE+"</"+r.tagName+">")}}this.hide(),"before"==e?this.triggerEvent("columnInsertedBefore"):"after"==e&&this.triggerEvent("columnInsertedAfter")},t.Editable.prototype.deleteColumn=function(){for(var e=this.getSelectionCells(),i=0;i<e.length;i++)for(var s=t(e[i]),a=this.tableMap(),o=this.cellOrigin(s.get(0),a),n=0;n<a.length;n++){var r=a[n][o.col],l=parseInt(t(r).attr("colspan"),10)||1;1==l?t(r).remove():t(r).attr("colspan",l-1)}this.focusOnTable(),this.hide(),this.triggerEvent("columnDeleted")},t.Editable.prototype.insertRow=function(e){var i,s=this.currentCell();if(s){var a=t(s),o=this.tableMap(),n=this.cellOrigin(a.get(0),o),r=0,l=null;for(i=0;i<o[n.row].length;i++){var d=o[n.row][i],h=parseInt(t(d).attr("rowspan"),10)||1;if("above"==e)if(0===n.row)r++;else{var p=o[n.row-1][i];p==d&&l!=d?t(d).attr("rowspan",h+1):r++}else if("below"==e)if(n.row==o.length-1)r++;else{var f=o[n.row+1][i];f==d&&l!=d?t(d).attr("rowspan",h+1):r++}l=o[n.row][i]}var c="<tr>";for(i=0;r>i;i++)c+="<td>"+t.Editable.INVISIBLE_SPACE+"</td>";c+="</tr>","below"==e?a.closest("tr").after(c):"above"==e&&a.closest("tr").before(c)}this.hide(),"below"==e?this.triggerEvent("rowInsertedBelow"):"above"==e&&this.triggerEvent("rowInsertedAbove")},t.Editable.prototype.deleteRow=function(){for(var e=this.getSelectionCells(),i=0;i<e.length;i++){for(var s=t(e[i]),a=this.tableMap(),o=this.cellOrigin(s.get(0),a),n=s.parents("tr:first"),r=0;r<a[o.row].length;r++){var l=a[o.row][r],d=parseInt(t(l).attr("rowspan"),10)||1;if(1==d)t(l).remove();else{var h=this.cellOrigin(l,a);if(t(l).attr("rowspan",d-1),h.row==o.row){var p=a[o.row+1];p&&p[r-1]&&(t(p[r-1]).after(t(l).clone()),t(l).remove())}}}n.remove()}this.focusOnTable(),this.hide(),this.triggerEvent("rowDeleted")},t.Editable.prototype.splitVertical=function(){for(var e=this.getSelectionCells(),i=0;i<e.length;i++){var s=t(e[i]),a=this.tableMap(),o=this.cellOrigin(s.get(0),a),n=parseInt(s.attr("colspan"),10)||1,r=parseInt(s.attr("rowspan"),10)||1;if(r>1){var l=Math.floor(r/2),d=o.row+(r-l),h=a[d][o.col-1];h||(h=a[d][o.col+n]),h?t(h).before(s.clone().attr("rowspan",l).html(t.Editable.INVISIBLE_SPACE)):s.parents("tr:first").after(t("<tr>").append(s.clone().attr("rowspan",l).html(t.Editable.INVISIBLE_SPACE))),s.attr("rowspan",r-l)}else{for(var p=t("<tr>").append(s.clone().html(t.Editable.INVISIBLE_SPACE)),f=null,c=0;c<a[o.row].length;c++){var u=a[o.row][c],m=parseInt(t(u).attr("rowspan"),10)||1;f!=u&&u!=s.get(0)&&t(u).attr("rowspan",m+1),f=u}s.parents("tr:first").after(p)}}this.hide(),this.triggerEvent("cellVerticalSplit")},t.Editable.prototype.splitHorizontal=function(){for(var e=this.getSelectionCells(),i=0;i<e.length;i++){var s=t(e[i]),a=this.tableMap(),o=this.cellOrigin(s.get(0),a),n=parseInt(s.attr("colspan"),10)||1;if(n>1){var r=Math.floor(n/2);s.after(s.clone().attr("colspan",r).html(t.Editable.INVISIBLE_SPACE)),s.attr("colspan",n-r)}else{for(var l=null,d=0;d<a.length;d++){var h=a[d][o.col],p=parseInt(t(h).attr("colspan"),10)||1;l!=h&&h!=s.get(0)&&t(h).attr("colspan",p+1),l=h}s.after(s.clone().html(t.Editable.INVISIBLE_SPACE))}}this.hide(),this.triggerEvent("cellHorizontalSplit")},t.Editable.prototype.insertTable=function(e,i){for(var s='<table data-last-table="true" width="100%">',a=0;e>a;a++){s+="<tr>";for(var o=0;i>o;o++)s+="<td>"+t.Editable.INVISIBLE_SPACE+"</td>";s+="</tr>"}s+="</table>",this.focus(),this.breakHTML(s);var n=this.$element.find('table[data-last-table="true"]');n.removeAttr("data-last-table"),this.setSelection(n.find("td:first").get(0)),this.hide(),this.triggerEvent("tableInserted")},t.Editable.prototype.deleteTable=function(){var t=this.currentTable();t&&(t.remove(),this.focus(),this.hide(),this.triggerEvent("tableDeleted"))},t.Editable.prototype.cleanupTables=function(){this.$element.find('td[colspan="1"], th[colspan="1"]').each(function(){t(this).removeAttr("colspan")}),this.$element.find('td[rowspan="1"], th[rowspan="1"]').each(function(){t(this).removeAttr("rowspan")})}}(jQuery),!function(t){t.Editable.commands=t.extend(t.Editable.commands,{insertOrderedList:{title:"Numbered List",icon:"fa fa-list-ol",refresh:function(){},callback:function(t){this.formatList(t)},undo:!0},insertUnorderedList:{title:"Bulleted List",icon:"fa fa-list-ul",refresh:function(){},callback:function(t){this.formatList(t)},undo:!0}}),t.Editable.prototype.refreshLists=function(){var e=t(this.getSelectionElement()),i=this.parents(e,"ul, ol");if(i.length>0){var s="insertUnorderedList";"OL"==i[0].tagName&&(s="insertOrderedList"),this.$editor.find('button[data-cmd="'+s+'"]').addClass("active")}},t.Editable.prototype.processBackspace=function(e){var i=e.prev();if(i.length){for(this.removeMarkers(),("UL"==i.get(0).tagName||"OL"==i.get(0).tagName)&&(i=i.find("li:last"));i.find("> ul, > ol").length;)i=i.find("> ul li:last, > ol li:last");var s=i.find("> p, > h1, > h3, > h4, > h5, > h6, > div, > pre, > blockquote");
0===i.text().length&&0===i.find("img, table, input, iframe, video").length?i.remove():(this.keep_enter=!0,e.find("> p, > h1, > h3, > h4, > h5, > h6, > div, > pre, > blockquote").each(function(e,i){t(i).replaceWith(t(i).html())}),this.keep_enter=!1,s.length?(t(s[s.length-1]).append('<span class="f-marker" data-type="false" data-id="0" data-fr-verified="true"></span><span class="f-marker" data-type="true" data-id="0" data-fr-verified="true"></span>'),t(s[s.length-1]).append(e.html())):(i.append('<span class="f-marker" data-type="false" data-id="0" data-fr-verified="true"></span><span class="f-marker" data-type="true" data-id="0" data-fr-verified="true"></span>'),i.append(e.html())),e.remove(),this.cleanupLists(),this.restoreSelectionByMarkers()),this.$element.find("breakli").remove()}else this.$element.find("breakli").remove(),this.parents(e,"ul").length?this.formatList("insertUnorderedList",!1):this.formatList("insertOrderedList",!1);this.sync()},t.Editable.prototype.liBackspace=function(){if(""!==this.text())return!0;var e,i=this.getSelectionElement(),s=this.parents(t(i),"table, li");if(s.length>0&&"TABLE"===s[0].tagName)return!0;if(e="LI"==i.tagName?t(i):this.parents(t(i),"li:first"),this.removeMarkers(),this.emptyElement(e.get(0))?(e.prepend("<breakli></breakli>"),1==e.find("br").length&&e.find("br").remove()):this.insertHTML("<breakli></breakli>"),e.find("breakli").prev().length&&"TABLE"===e.find("breakli").prev().get(0).tagName&&e.find("breakli").next().length&&"BR"===e.find("breakli").next().get(0).tagName)return this.setSelection(e.find("breakli").prev().find("td:first").get(0)),e.find("breakli").next().remove(),this.$element.find("breakli").remove(),!1;for(var a,o=e.html(),n=[],r=0;r<o.length;r++){if(chr=o.charAt(r),"<"!=chr)return this.$element.find("breakli").remove(),!0;var l=o.indexOf(">",r+1);if(-1!==l){a=o.substring(r,l+1);var d=this.tagName(a);if(r=l,"breakli"==d){if(!this.isClosingTag(a)&&!this.isClosingTag(n[n.length-1]))return this.processBackspace(e),!1}else n.push(a)}}return this.$element.find("breakli").remove(),!0},t.Editable.prototype.textLiEnter=function(e){this.removeMarkers(),this.insertSimpleHTML("<breakli></breakli>",!1);var i,s,a=e.html(),o=[],n={},r=[],l=0,d=e.prop("attributes"),h="";for(s=0;s<d.length;s++)h+=" "+d[s].name+'="'+d[s].value+'"';for(s=0;s<a.length;s++)if(chr=a.charAt(s),"<"==chr){var p=a.indexOf(">",s+1);if(-1!==p){i=a.substring(s,p+1);var f=this.tagName(i);if(s=p,"breakli"==f){if(!this.isClosingTag(i)){for(var c=o.length-1;c>=0;c--){var u=this.tagName(o[c]);r.push("</"+u+">")}r.push("</li>"),r.push("<li"+h+">");for(var m=0;m<o.length;m++)r.push(o[m]);r.push('<span class="f-marker" data-type="false" data-collapsed="true" data-id="0" data-fr-verified="true"></span><span class="f-marker" data-type="true" data-collapsed="true" data-id="0" data-fr-verified="true"></span>')}}else if(r.push(i),!this.isSelfClosingTag(i))if(this.isClosingTag(i)){var g=n[f].pop();o.splice(g,1)}else o.push(i),void 0===n[f]&&(n[f]=[]),n[f].push(o.length-1)}}else l++,r.push(chr);var v=t(e.parents("ul, ol")[0]);e.replaceWith("<li"+h+">"+r.join("")+"</li>"),v.find("p:empty + table").prev().remove(),v.find("p + table").each(function(e,i){var s=t(i);s.prev().append(s.clone()),s.remove()}),v.find("table + p").each(function(e,i){var s=t(i);s.append(s.prev().clone()),s.prev().remove()}),this.keep_enter=!0,v.find(this.valid_nodes.join(",")).each(function(e,i){""===t(i).text().trim()&&t(i).prepend(t.Editable.INVISIBLE_SPACE)}),this.keep_enter=!1},t.Editable.prototype.liEnter=function(){var e,i=this.getSelectionElement(),s=this.parents(t(i),"table, li");if(s.length>0&&"TABLE"==s[0].tagName)return!0;if(e="LI"==i.tagName?t(i):this.parents(t(i),"li:first"),this.getSelectionTextInfo(e.get(0)).atStart&&""===this.text())e.before("<li>"+t.Editable.INVISIBLE_SPACE+"</li>");else{if(0===this.trim(e.text()).length&&0===e.find("img, table, iframe, input, object").length)return this.outdent(!1),!1;this.textLiEnter(e),this.$element.find("breakli").remove(),this.restoreSelectionByMarkers()}return this.sync(),!1},t.Editable.prototype.listTab=function(){var e=t(this.getSelectionElement());return this.parents(e,"ul, ol").length>0?(this.indent(),!1):void 0},t.Editable.prototype.listShiftTab=function(){var e=t(this.getSelectionElement());return this.parents(e,"ul, ol").length>0?(this.outdent(),!1):void 0},t.Editable.prototype.indentList=function(t,e){return"LI"===t.get(0).tagName?(e?this.outdentLi(t):this.indentLi(t),this.cleanupLists(),!1):!0},t.Editable.prototype.initList=function(){this.addListener("tab",this.listTab),this.addListener("shift+tab",this.listShiftTab),this.addListener("refresh",this.refreshLists),this.addListener("indent",this.indentList),this.isImage||this.isLink||this.options.editInPopup||this.$element.on("keydown",t.proxy(function(e){if(["TEXTAREA","INPUT"].indexOf(e.target.tagName)<0&&!this.isHTML){var i=e.which,s=this.getSelectionElement();if("LI"==s.tagName||this.parents(t(s),"li").length>0){if(13==i&&!e.shiftKey&&this.options.multiLine)return this.liEnter();if(8==i)return this.liBackspace()}}},this))},t.Editable.initializers.push(t.Editable.prototype.initList),t.Editable.prototype.formatList=function(e,i){if(this.browser.msie&&t.Editable.getIEversion()<9)return document.execCommand(e,!1,!1),!1;void 0===i&&(i=!0);var s,a,o=!1,n=!0,r=!1,l=this.getSelectionElements(),d=this.parents(t(l[0]),"ul, ol");if(d.length&&("UL"===d[0].tagName?"insertUnorderedList"!=e&&(o=!0):"insertOrderedList"!=e&&(o=!0)),this.saveSelectionByMarkers(),o){s="ol","insertUnorderedList"===e&&(s="ul");var h=t(d[0]);h.replaceWith("<"+s+">"+h.html()+"</"+s+">")}else{for(var p=0;p<l.length;p++)if(a=t(l[p]),("TD"==a.get(0).tagName||"TH"==a.get(0).tagName)&&this.wrapTextInElement(a),this.parents(a,"li").length>0||"LI"==a.get(0).tagName){var f;f="LI"==a.get(0).tagName?a:t(a.parents("li")[0]);var c=this.parents(a,"ul, ol");if(c.length>0&&(s=c[0].tagName.toLowerCase(),f.before('<span class="close-'+s+'" data-fr-verified="true"></span>'),f.after('<span class="open-'+s+'" data-fr-verified="true"></span>')),0===this.parents(t(c[0]),"ol, ul").length||o)if(0===f.find(this.valid_nodes.join(",")).length){var u=f.html().replace(/\u200B/gi,"");this.options.paragraphy?(0===f.text().replace(/\u200B/gi,"").length&&(u+=f.find("br").length>0?"":this.br),u="<"+this.options.defaultTag+this.attrs(f.get(0))+">"+u,u=u+"</"+this.options.defaultTag+">"):u+=f.find("br").length>0?"":this.br,f.replaceWith(u)}else f.replaceWith(f.html().replace(/\u200B/gi,""));r=!0}else n=!1;r&&this.cleanupLists(),(n===!1||o===!0)&&(this.wrapText(),this.restoreSelectionByMarkers(),l=this.getSelectionElements(),this.saveSelectionByMarkers(),this.elementsToList(l,e),this.unwrapText(),this.cleanupLists())}this.options.paragraphy&&!o&&this.wrapText(!0),this.restoreSelectionByMarkers(),i&&this.repositionEditor(),e="insertUnorderedList"==e?"unorderedListInserted":"orderedListInserted",this.triggerEvent(e)},t.Editable.prototype.elementsToList=function(e,i){var s="<ol>";"insertUnorderedList"==i&&(s="<ul>"),e[0]==this.$element.get(0)&&(e=this.$element.find("> "+this.valid_nodes.join(", >")));for(var a=0;a<e.length;a++){var o=t(s);$element=t(e[a]),$element.get(0)!=this.$element.get(0)&&("TD"===$element.get(0).tagName||"TH"===$element.get(0).tagName?(this.wrapTextInElement($element,!0),this.elementsToList($element.find("> "+this.valid_nodes.join(", >")),i)):(""===$element.attr("class")&&$element.removeAttr("class"),o.append(t("<li>").html($element.get(0).tagName==this.options.defaultTag&&0===$element.get(0).attributes.length?$element.clone().html():$element.clone())),$element.replaceWith(o)))}},t.Editable.prototype.indentLi=function(e){var i=e.parents("ul, ol"),s=i.get(0).tagName.toLowerCase();e.find("> ul, > ol").length>0&&e.prev("li").length>0?(this.wrapTextInElement(e),e.find("> "+this.valid_nodes.join(" , > ")).each(function(e,i){t(i).wrap("<"+s+"></"+s+">").wrap("<li></li>")}),e.prev("li").append(e.find("> ul, > ol")),e.remove()):0===e.find("> ul, > ol").length&&e.prev("li").length>0&&(e.prev().append(t("<"+s+">").append(e.clone())),e.remove(),t(i.find("li").get().reverse()).each(function(e,i){var s=t(i);s.find(" > ul, > ol").length>0&&s.prev()&&s.prev().find(" > ul, > ol").length>0&&1===s.contents().length&&(s.prev().append(s.html()),s.remove())}))},t.Editable.prototype.outdentLi=function(e){var i=t(e.parents("ul, ol")[0]),s=this.parents(i,"ul, ol"),a=i.get(0).tagName.toLowerCase();0===e.prev("li").length&&this.parents(e,"li").length>0?(e.before('<span class="close-'+a+'" data-fr-verified="true"></span>'),e.before('<span class="close-li" data-fr-verified="true"></span>'),e.before('<span class="open-li" data-fr-verified="true"></span>'),e.after('<span class="open-'+a+'" data-fr-verified="true"></span>'),e.replaceWith(e.html())):(e.before('<span class="close-'+a+'" data-fr-verified="true"></span>'),e.after('<span class="open-'+a+'" data-fr-verified="true"></span>'),this.parents(e,"li").length>0&&(e.before('<span class="close-li" data-fr-verified="true"></span>'),e.after('<span class="open-li" data-fr-verified="true"></span>'))),s.length||e.replaceWith(0===e.find(this.valid_nodes.join(",")).length?e.html().replace(/\u200b/gi,"")+this.br:e.html().replace(/\u200b/gi,""))},t.Editable.prototype.listTextEmpty=function(e){var i=t(e).text().replace(/(\r\n|\n|\r|\t|\u200B)/gm,"");return(""===i||e===this.$element.get(0))&&1===t(e).find("br").length}}(jQuery),!function(t){t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{colors:["#61BD6D","#1ABC9C","#54ACD2","#2C82C9","#9365B8","#475577","#CCCCCC","#41A85F","#00A885","#3D8EB9","#2969B0","#553982","#28324E","#000000","#F7DA64","#FBA026","#EB6B56","#E25041","#A38F84","#EFEFEF","#FFFFFF","#FAC51C","#F37934","#D14841","#B8312F","#7C706B","#D1D5D8","REMOVE"],foreColors:[],backColors:[],colorsStep:7,defaultColorOption:"foreColor",backColorsDisabled:!1,foreColorsDisabled:!1}),t.Editable.prototype.refreshColors=function(){var t=this.getSelectionElement();this.$editor.find(".fr-color-picker button.fr-color-bttn").removeClass("active"),this.refreshColor(t,"background-color","backColor"),this.refreshColor(t,"color","foreColor")},t.Editable.prototype.refreshColor=function(e,i,s){for(;t(e).get(0)!=this.$element.get(0);){if("transparent"!==t(e).css(i)&&"rgba(0, 0, 0, 0)"!==t(e).css(i)){this.$editor.find('.fr-color-picker button.fr-color-bttn[data-param="'+s+'"][data-val="'+t.Editable.RGBToHex(t(e).css(i))+'"]').addClass("active");break}e=t(e).parent()}},t.Editable.commands=t.extend(t.Editable.commands,{color:{icon:"fa fa-tint",title:"Color",refreshOnShow:t.Editable.prototype.refreshColors,seed:[{cmd:"backColor"},{cmd:"foreColor"}],callback:function(t,e,i){this[i].apply(this,[e])},callbackWithoutSelection:function(e,i,s){"backColor"===s&&(s="background-color"),"foreColor"===s&&(s="color"),this._startInFontExec(s,e,i),"#123456"===i&&""===this.text()&&(this.cleanify(!0,!1),this.$element.find("span").each(function(e,i){var s=t(i),a=s.css("background-color");("#123456"===a||"#123456"===t.Editable.RGBToHex(a))&&s.css("background-color",""),a=s.css("color"),("#123456"===a||"#123456"===t.Editable.RGBToHex(a))&&s.css("color","")}))},undo:!0}}),t.Editable.prototype.command_dispatcher=t.extend(t.Editable.prototype.command_dispatcher,{color:function(t){var e=this.buildDropdownColor(t),i=this.buildDropdownButton(t,e,"fr-color-picker");return i}}),t.Editable.prototype.buildColorList=function(t){for(var e=this.options[t+"s"].length>0?this.options[t+"s"]:this.options.colors,i=this.options.defaultColorOption==t?"block":"none",s='<div class="fr-color-set fr-'+t+'" style="display: '+i+'">',a=0;a<e.length;a++){var o=e[a];s+="REMOVE"!==o?'<button type="button" class="fr-color-bttn" data-val="'+o+'" data-cmd="color" data-param="'+t+'" style="background: '+o+';">&nbsp;</button>':'<button type="button" class="fr-color-bttn" data-val="#123456" data-cmd="color" data-param="'+t+'" style="background: #FFF;"><i class="fa fa-eraser"></i></button>',a%this.options.colorsStep==this.options.colorsStep-1&&a>0&&(s+="<hr/>",a!=this.options.colorsStep-1&&a!=2*this.options.colorsStep-1||!this.options.colorsTopChoices||(s+='<div class="separator"></div>'))}return s+="</div>"},t.Editable.prototype.buildDropdownColor=function(){var e="",i='<div class="fr-dropdown-menu">';this.options.textColorsDisabled||(i+=this.buildColorList("foreColor")),this.options.backColorsDisabled||(i+=this.buildColorList("backColor")),i+="<p>";var s=this.options.textColorsDisabled||this.options.backColorsDisabled?"":"fr-50 ";this.options.textColorsDisabled||(e="foreColor"==this.options.defaultColorOption?"active":"",i+='<span class="fr-choose-color '+s+e+'" data-text="true" data-param="foreColor">Text</span>'),this.options.backColorsDisabled||(e="backColor"==this.options.defaultColorOption?"active":"",i+='<span class="fr-choose-color '+s+e+'" data-text="true" data-param="backColor">Background</span>'),i+="</p></div>",this.$bttn_wrapper.on(this.mousedown,".fr-choose-color",function(t){return t.preventDefault(),t.stopPropagation(),"mousedown"===t.type&&1!==t.which?!0:void 0});var a=this;return this.$bttn_wrapper.on(this.mouseup,".fr-choose-color",function(e){if(e.preventDefault(),e.stopPropagation(),"mouseup"===e.type&&1!==e.which)return!0;var i=t(this);i.siblings().removeClass("active"),i.addClass("active"),i.parents(".fr-dropdown-menu").find("button").attr("data-param",i.attr("data-param")),i.parents(".fr-dropdown-menu").find(".fr-color-set").hide(),i.parents(".fr-dropdown-menu").find(".fr-color-set.fr-"+i.attr("data-param")).show(),a.refreshColors()}),i},t.Editable.prototype.backColor=function(e){this.inlineStyle("background-color","backColor",e),this.saveSelectionByMarkers(),this.$element.find("span").each(function(e,i){var s=t(i),a=s.css("background-color");("#123456"===a||"#123456"===t.Editable.RGBToHex(a))&&(s.css("background-color",""),s.find("span").each(function(e,i){var s=t(i);s.css("background-color",""),""!==s.attr("style")||s.hasClass("f-marker")||s.replaceWith(s.contents())})),""!==s.attr("style")||s.hasClass("f-marker")||s.replaceWith(s.contents())}),this.restoreSelectionByMarkers(),this.cleanify();var i=this.$editor.find('button.fr-color-bttn[data-cmd="backColor"][data-val="'+e+'"]');i.addClass("active"),i.siblings().removeClass("active")},t.Editable.prototype.foreColor=function(e){this.inlineStyle("color","foreColor",e),this.saveSelectionByMarkers(),this.$element.find("span").each(function(e,i){var s=t(i),a=s.css("color");("#123456"===a||"#123456"===t.Editable.RGBToHex(a))&&(s.css("color",""),s.find("span").each(function(e,i){var s=t(i);s.css("color",""),""!==s.attr("style")||s.hasClass("f-marker")||s.replaceWith(s.contents())})),""!==s.attr("style")||s.hasClass("f-marker")||s.replaceWith(s.contents())}),this.restoreSelectionByMarkers(),this.cleanify();var i=this.$editor.find('button.fr-color-bttn[data-cmd="foreColor"][data-val="'+e+'"]');i.addClass("active"),i.siblings().removeClass("active")}}(jQuery),!function(t){t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{mediaManager:!0,imagesLoadURL:"http://i.froala.com/images",imagesLoadParams:{}}),t.Editable.prototype.showMediaManager=function(){this.$image_modal.show(),this.$overlay.show(),this.loadImages(),this.$document.find("body").css("overflow","hidden")},t.Editable.prototype.hideMediaManager=function(){this.$image_modal.hide(),this.$overlay.hide(),this.$document.find("body").css("overflow","")},t.Editable.prototype.mediaModalHTML=function(){var t='<div class="froala-modal"><div class="f-modal-wrapper"><h4><span data-text="true">Manage images</span><i title="Cancel" class="fa fa-times" id="f-modal-close-'+this._id+'"></i></h4>';return t+='<img class="f-preloader" id="f-preloader-'+this._id+'" alt="Loading..." src="'+this.options.preloaderSrc+'" style="display: none;">',t+=WYSIWYGModernizr.touch?'<div class="f-image-list f-touch" id="f-image-list-'+this._id+'"></div>':'<div class="f-image-list" id="f-image-list-'+this._id+'"></div>',t+="</div></div>"},t.Editable.prototype.buildMediaManager=function(){this.$image_modal=t(this.mediaModalHTML()).appendTo("body"),this.$preloader=this.$image_modal.find("#f-preloader-"+this._id),this.$media_images=this.$image_modal.find("#f-image-list-"+this._id),this.$overlay=t('<div class="froala-overlay">').appendTo("body"),this.$overlay.on("mouseup",t.proxy(function(t){this.isResizing()||t.stopPropagation()},this)),this.$image_modal.on("mouseup",t.proxy(function(t){this.isResizing()||t.stopPropagation()},this)),this.$image_modal.find("i#f-modal-close-"+this._id).click(t.proxy(function(){this.hideMediaManager()},this)),this.$media_images.on(this.mouseup,"img",t.proxy(function(e){e.stopPropagation();var i=e.currentTarget;this.writeImage(t(i).attr("src")),this.hideMediaManager()},this)),this.$media_images.on(this.mouseup,".f-delete-img",t.proxy(function(e){e.stopPropagation();var i=t(e.currentTarget).prev(),s="Are you sure? Image will be deleted.";t.Editable.LANGS[this.options.language]&&(s=t.Editable.LANGS[this.options.language].translation[s]),confirm(s)&&this.triggerEvent("beforeDeleteImage",[t(i)],!1)!==!1&&(t(i).parent().addClass("f-img-deleting"),this.deleteImage(t(i)))},this)),this.options.mediaManager&&(this.$image_wrapper.on("click","#f-browser-"+this._id,t.proxy(function(){this.showMediaManager()},this)).on("click","#f-browser-"+this._id+" i",t.proxy(function(){this.showMediaManager()},this)),this.$image_wrapper.find("#f-browser-"+this._id).show()),this.hideMediaManager()},t.Editable.prototype.destroyMediaManager=function(){this.hideMediaManager(),this.$overlay.html("").removeData().remove(),this.$image_modal.html("").removeData().remove()},t.Editable.prototype.initMediaManager=function(){return this.options.mediaManager?(this.buildMediaManager(),void this.addListener("destroy",this.destroyMediaManager)):!1},t.Editable.initializers.push(t.Editable.prototype.initMediaManager),t.Editable.prototype.processLoadedImages=function(t){try{if(t.error)this.throwImagesLoadErrorWithMessage(t.error);else{this.$media_images.empty();for(var e=0;e<t.length;e++)t[e].src?this.loadImage(t[e].src,t[e].info):this.loadImage(t[e])}}catch(i){this.throwLoadImagesError(4)}},t.Editable.prototype.throwImagesLoadErrorWithMessage=function(t){this.triggerEvent("imagesLoadError",[{message:t,code:0}],!1),this.hideImageLoader()},t.Editable.prototype.loadImages=function(){this.$preloader.show(),this.$media_images.empty(),this.options.imagesLoadURL?(t.support.cors=!0,t.getJSON(this.options.imagesLoadURL,this.options.imagesLoadParams,t.proxy(function(t){this.triggerEvent("imagesLoaded",[t],!1),this.processLoadedImages(t),this.$preloader.hide()},this)).fail(t.proxy(function(){this.throwLoadImagesError(2)},this))):this.throwLoadImagesError(3)},t.Editable.prototype.throwLoadImagesError=function(t){void 0===t&&(t=-1);var e="Unknown image upload error.";1==t?e="Bad link.":2==t?e="Error during request.":3==t?e="Missing imagesLoadURL option.":4==t&&(e="Parsing response failed."),this.triggerEvent("imagesLoadError",[{code:t,message:e}],!1),this.$preloader.hide()},t.Editable.prototype.loadImage=function(e,i){var s=new Image,a=t("<div>").addClass("f-empty");s.onload=t.proxy(function(){var s="Delete";t.Editable.LANGS[this.options.language]&&(s=t.Editable.LANGS[this.options.language].translation[s]);var o=t('<img src="'+e+'"/>');for(var n in i)o.attr("data-"+n,i[n]);a.append(o).append('<a class="f-delete-img"><span data-text="true">'+s+"</span></a>"),a.removeClass("f-empty"),this.$media_images.hide(),this.$media_images.show(),this.triggerEvent("imageLoaded",[e],!1)},this),s.onerror=t.proxy(function(){a.remove(),this.throwLoadImagesError(1)},this),s.src=e,this.$media_images.append(a)}}(jQuery),!function(t){t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{fontList:{"Arial,Helvetica":"Arial, Helvetica","Courier,Courier New":"Courier, Courier New",Georgia:"Georgia","Times New Roman,Times":"Times New Roman,Times","Trebuchet MS":"Trebuchet MS","Verdana, Geneva":"Verdana,Geneva"}}),t.Editable.prototype.refreshFontFamily=function(){var e=t(this.getSelectionElement());this.$editor.find('.fr-dropdown > button[data-name="fontFamily"] + ul li').removeClass("active"),this.$editor.find('.fr-dropdown > button[data-name="fontFamily"] + ul li[data-val="'+e.css("font-family").replace(/"/gi,'\\"')+'"]').addClass("active")},t.Editable.commands=t.extend(t.Editable.commands,{fontFamily:{title:"Font Family",icon:"fa fa-font",refreshOnShow:t.Editable.prototype.refreshFontFamily,callback:function(t,e){this.inlineStyle("font-family",t,e)},undo:!0,callbackWithoutSelection:function(t,e){this._startInFontExec("font-family",t,e)}}}),t.Editable.prototype.command_dispatcher=t.extend(t.Editable.prototype.command_dispatcher,{fontFamily:function(t){var e=this.buildDropdownFontFamily(),i=this.buildDropdownButton(t,e,"fr-family");return i}}),t.Editable.prototype.buildDropdownFontFamily=function(){var t='<ul class="fr-dropdown-menu">';for(var e in this.options.fontList){var i=this.options.fontList[e],s='<li data-cmd="fontFamily" data-val="'+e+'">';s+='<a href="#" data-text="true" title="'+i+'" style="font-family: '+e+';">'+i+"</a></li>",t+=s}return t+="</ul>"}}(jQuery),!function(t){t.Editable.prototype.refreshFontSize=function(){var e=t(this.getSelectionElement()),i=parseInt(e.css("font-size").replace(/px/g,""),10)||16;this.$editor.find('.fr-dropdown > button[data-name="fontSize"] + ul li').removeClass("active"),this.$editor.find('.fr-dropdown > button[data-name="fontSize"] + ul li[data-val="'+i+'px"]').addClass("active")},t.Editable.commands=t.extend(t.Editable.commands,{fontSize:{title:"Font Size",icon:"fa fa-text-height",refreshOnShow:t.Editable.prototype.refreshFontSize,seed:[{min:11,max:52}],undo:!0,callback:function(t,e){this.inlineStyle("font-size",t,e)},callbackWithoutSelection:function(t,e){this._startInFontExec("font-size",t,e)}}}),t.Editable.prototype.command_dispatcher=t.extend(t.Editable.prototype.command_dispatcher,{fontSize:function(t){var e=this.buildDropdownFontsize(t),i=this.buildDropdownButton(t,e);return i}}),t.Editable.prototype.buildDropdownFontsize=function(t){for(var e='<ul class="fr-dropdown-menu f-font-sizes">',i=0;i<t.seed.length;i++)for(var s=t.seed[i],a=s.min;a<=s.max;a++)e+='<li data-cmd="'+t.cmd+'" data-val="'+a+'px"><a href="#"><span>'+a+"px</span></a></li>";return e+="</ul>"}}(jQuery),!function(t){t.Editable.prototype.refreshBlockStyles=function(){var e=this.getSelectionElements()[0],i=e.tagName.toLowerCase();this.$bttn_wrapper.find(".fr-block-style").empty();var s=this.options.blockStyles[i];if(void 0===s&&(s=this.options.defaultBlockStyle),void 0!==s){this.$bttn_wrapper.find('.fr-dropdown > button[data-name="blockStyle"].fr-trigger').removeAttr("disabled");for(var a in s){var o=s[a],n="";t(e).hasClass(a)&&(n=' class="active"'),this.$bttn_wrapper.find(".fr-block-style").append(t("<li"+n+">").append(t('<a href="#" data-text="true">').text(o).addClass(a)).attr("data-cmd","blockStyle").attr("data-val",a))}}},t.Editable.commands=t.extend(t.Editable.commands,{blockStyle:{title:"Block Style",icon:"fa fa-magic",refreshOnShow:t.Editable.prototype.refreshBlockStyles,callback:function(t,e,i){this.blockStyle(e,i)},undo:!0}}),t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{defaultBlockStyle:{"f-italic":"Italic","f-typewriter":"Typewriter","f-spaced":"Spaced","f-uppercase":"Uppercase"},blockStylesToggle:!0,blockStyles:{}}),t.Editable.prototype.command_dispatcher=t.extend(t.Editable.prototype.command_dispatcher,{blockStyle:function(t){var e=this.buildDropdownBlockStyle(t),i=this.buildDropdownButton(t,e);return i}}),t.Editable.prototype.buildDropdownBlockStyle=function(){var t='<ul class="fr-dropdown-menu fr-block-style">';return t+="</ul>"},t.Editable.prototype.blockStyle=function(e){this.saveSelectionByMarkers(),this.wrapText(),this.restoreSelectionByMarkers();var i=this.getSelectionElements()[0].tagName;this.saveSelectionByMarkers();for(var s=this.getSelectionElements(),a=0;a<s.length;a++){var o=s[a];o!=this.$element.get(0)&&o.tagName==i&&(t(o).find(s).length>0||(t(o).hasClass(e)?(t(o).removeClass(e),""===t(o).attr("class")&&t(o).removeAttr("class")):(this.options.blockStylesToggle&&t(o).removeAttr("class"),t(o).addClass(e))))}this.cleanupLists(),this.restoreSelectionByMarkers(),this.triggerEvent("blockStyle")}}(jQuery),!function(t){t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{videoAllowedAttrs:["src","width","height","frameborder","allowfullscreen","webkitallowfullscreen","mozallowfullscreen","href","target","id","controls","value","name"],videoAllowedTags:["iframe","object","param","video","source","embed"],defaultVideoAlignment:"center",textNearVideo:!0}),t.Editable.VIDEO_PROVIDERS=[{test_regex:/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:m\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=|embed\/)?(.+)/g,url_text:"//www.youtube.com/embed/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.*(vimeo\.com\/)((channels\/[A-z]+\/)|(groups\/[A-z]+\/videos\/))?([0-9]+)/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:vimeo\.com)\/(?:channels\/[A-z]+\/|groups\/[A-z]+\/videos\/)?(.+)/g,url_text:"//player.vimeo.com/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.+(dailymotion.com|dai.ly)\/(video|hub)?\/?([^_]+)[^#]*(#video=([^_&]+))?/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:dailymotion\.com|dai\.ly)\/(?:video|hub)?\/?(.+)/g,url_text:"//www.dailymotion.com/embed/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.+(screen.yahoo.com)\/(videos-for-you|popular)?\/[^_&]+/,url_regex:"",url_text:"",html:'<iframe width="640" height="360" src="{url}?format=embed" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" allowtransparency="true"></iframe>'}],t.Editable.video_commands={floatVideoLeft:{title:"Float Left",icon:{type:"font",value:"fa fa-align-left"}},floatVideoNone:{title:"Float None",icon:{type:"font",value:"fa fa-align-justify"}},floatVideoRight:{title:"Float Right",icon:{type:"font",value:"fa fa-align-right"}},removeVideo:{title:"Remove Video",icon:{type:"font",value:"fa fa-trash-o"}}},t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{videoButtons:["floatVideoLeft","floatVideoNone","floatVideoRight","removeVideo"]}),t.Editable.commands=t.extend(t.Editable.commands,{insertVideo:{title:"Insert Video",icon:"fa fa-video-camera",callback:function(){this.insertVideo()},undo:!1}}),t.Editable.prototype.insertVideo=function(){this.options.inlineMode||(this.closeImageMode(),this.imageMode=!1,this.positionPopup("insertVideo")),this.selectionInEditor()&&this.saveSelection(),this.showInsertVideo(),this.$video_wrapper.find("textarea").val("")},t.Editable.prototype.insertVideoHTML=function(){var t='<div class="froala-popup froala-video-popup" style="display: none;"><h4><span data-text="true">Insert Video</span><i title="Cancel" class="fa fa-times" id="f-video-close-'+this._id+'"></i></h4><div class="f-popup-line"><textarea placeholder="Embedded code" id="f-video-textarea-'+this._id+'"></textarea></div><p class="or"><span data-text="true">or</span></p><div class="f-popup-line"><input type="text" placeholder="http://youtube.com/" id="f-video-input-'+this._id+'"/><button data-text="true" class="f-ok f-submit fr-p-bttn" id="f-video-ok-'+this._id+'">OK</button></div></div>';return t},t.Editable.prototype.buildInsertVideo=function(){this.$video_wrapper=t(this.insertVideoHTML()),this.$popup_editor.append(this.$video_wrapper),this.addListener("hidePopups",this.hideVideoWrapper),this.$video_wrapper.on("mouseup touchend",t.proxy(function(t){this.isResizing()||t.stopPropagation()},this)),this.$video_wrapper.on("mouseup keydown","input#f-video-input-"+this._id+", textarea#f-video-textarea-"+this._id,t.proxy(function(t){t.stopPropagation()},this));var e=this;this.$video_wrapper.on("change","input#f-video-input-"+this._id+", textarea#f-video-textarea-"+this._id,function(){"INPUT"==this.tagName?e.$video_wrapper.find("textarea#f-video-textarea-"+e._id).val(""):"TEXTAREA"==this.tagName&&e.$video_wrapper.find("input#f-video-input-"+e._id).val("")}),this.$video_wrapper.on("click","button#f-video-ok-"+this._id,t.proxy(function(){var t=this.$video_wrapper.find("input#f-video-input-"+this._id),e=this.$video_wrapper.find("textarea#f-video-textarea-"+this._id);""!==t.val()?this.writeVideo(t.val(),!1):""!==e.val()&&this.writeVideo(e.val(),!0)},this)),this.$video_wrapper.on(this.mouseup,"i#f-video-close-"+this._id,t.proxy(function(){this.$bttn_wrapper.show(),this.hideVideoWrapper(),this.options.inlineMode&&!this.imageMode&&0===this.options.buttons.length&&this.hide(),this.restoreSelection(),this.focus(),this.options.inlineMode||this.hide()},this)),this.$video_wrapper.on("click",function(t){t.stopPropagation()}),this.$video_wrapper.on("click","*",function(t){t.stopPropagation()})},t.Editable.prototype.destroyVideo=function(){this.$video_wrapper.html("").removeData().remove()},t.Editable.prototype.initVideo=function(){this.buildInsertVideo(),this.addVideoControls(),this.addListener("destroy",this.destroyVideo)},t.Editable.initializers.push(t.Editable.prototype.initVideo),t.Editable.prototype.hideVideoEditorPopup=function(){this.$video_editor&&(this.$video_editor.hide(),t("span.f-video-editor").removeClass("active"),this.$element.removeClass("f-non-selectable"),this.editableDisabled||this.isHTML||this.$element.attr("contenteditable",!0))},t.Editable.prototype.showVideoEditorPopup=function(){this.$video_editor&&this.$video_editor.show(),this.$element.removeAttr("contenteditable")},t.Editable.prototype.addVideoControlsHTML=function(){this.$video_editor=t('<div class="froala-popup froala-video-editor-popup" style="display: none">');for(var e=t('<div class="f-popup-line">').appendTo(this.$video_editor),i=0;i<this.options.videoButtons.length;i++){var s=this.options.videoButtons[i];if(void 0!==t.Editable.video_commands[s]){var a=t.Editable.video_commands[s],o='<button class="fr-bttn" data-callback="'+s+'" data-cmd="'+s+'" title="'+a.title+'">';o+=void 0!==this.options.icons[s]?this.prepareIcon(this.options.icons[s],a.title):this.prepareIcon(a.icon,a.title),o+="</button>",e.append(o)}}this.addListener("hidePopups",this.hideVideoEditorPopup),this.$popup_editor.append(this.$video_editor),this.bindCommandEvents(this.$video_editor)},t.Editable.prototype.floatVideoLeft=function(){t("span.f-video-editor.active").attr("class","f-video-editor active fr-fvl"),this.triggerEvent("videoFloatedLeft"),t("span.f-video-editor.active").click()},t.Editable.prototype.floatVideoRight=function(){t("span.f-video-editor.active").attr("class","f-video-editor active fr-fvr"),this.triggerEvent("videoFloatedRight"),t("span.f-video-editor.active").click()},t.Editable.prototype.floatVideoNone=function(){t("span.f-video-editor.active").attr("class","f-video-editor active fr-fvn"),this.triggerEvent("videoFloatedNone"),t("span.f-video-editor.active").click()},t.Editable.prototype.removeVideo=function(){t("span.f-video-editor.active").remove(),this.hide(),this.triggerEvent("videoRemoved"),this.focus()},t.Editable.prototype.refreshVideo=function(){this.$element.find("iframe, object").each(function(e,i){for(var s=t(i),a=0;a<t.Editable.VIDEO_PROVIDERS.length;a++){var o=t.Editable.VIDEO_PROVIDERS[a];if(o.test_regex.test(s.attr("src"))){0===s.parents(".f-video-editor").length&&s.wrap('<span class="f-video-editor fr-fvn" data-fr-verified="true">');break}}}),this.options.textNearVideo||this.$element.find(".f-video-editor").attr("contenteditable",!1).addClass("fr-tnv")},t.Editable.prototype.addVideoControls=function(){this.addVideoControlsHTML(),this.addListener("sync",this.refreshVideo),this.$element.on("click touchend","span.f-video-editor",t.proxy(function(e){if(this.isDisabled)return!1;e.preventDefault(),e.stopPropagation();var i=e.currentTarget;
this.clearSelection(),t(i).addClass("active"),this.showByCoordinates(t(i).offset().left+t(i).width()/2,t(i).offset().top+t(i).height()),this.showVideoEditorPopup(),this.refreshVideoButtons(i)},this))},t.Editable.prototype.refreshVideoButtons=function(e){var i=t(e).attr("class");this.$video_editor.find("[data-cmd]").removeClass("active"),i.indexOf("fr-fvl")>=0?this.$video_editor.find('[data-cmd="floatVideoLeft"]').addClass("active"):i.indexOf("fr-fvr")>=0?this.$video_editor.find('[data-cmd="floatVideoRight"]').addClass("active"):this.$video_editor.find('[data-cmd="floatVideoNone"]').addClass("active")},t.Editable.prototype.writeVideo=function(e,i){var s=null;if(i)s=this.clean(e,!0,!1,this.options.videoAllowedTags,this.options.videoAllowedAttrs);else for(var a=0;a<t.Editable.VIDEO_PROVIDERS.length;a++){var o=t.Editable.VIDEO_PROVIDERS[a];if(o.test_regex.test(e)){e=e.replace(o.url_regex,o.url_text),s=o.html.replace(/\{url\}/,e);break}}if(s){this.restoreSelection(),this.$element.focus();var n="fr-fvn";"left"==this.options.defaultVideoAlignment&&(n="fr-fvl"),"right"==this.options.defaultVideoAlignment&&(n="fr-fvr"),this.textNearVideo||(n+=" fr-tnv"),this.insertHTML('<span class="f-video-editor '+n+'" data-fr-verified="true">'+s+"</span>"),this.$bttn_wrapper.show(),this.hideVideoWrapper(),this.hide(),this.triggerEvent("videoInserted",[s])}else this.triggerEvent("videoError")},t.Editable.prototype.showVideoWrapper=function(){this.$video_wrapper&&(this.$video_wrapper.show(),this.$video_wrapper.find(".f-popup-line input").val(""))},t.Editable.prototype.hideVideoWrapper=function(){this.$video_wrapper&&(this.$video_wrapper.hide(),this.$video_wrapper.find("input").blur())},t.Editable.prototype.showInsertVideo=function(){this.hidePopups(),this.showVideoWrapper()}}(jQuery),!function(t){t.Editable.commands=t.extend(t.Editable.commands,{uploadFile:{title:"Upload File",icon:"fa fa-paperclip",callback:function(){this.insertFile()},undo:!1}}),t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{allowedFileTypes:["*"],fileDeleteUrl:null,fileDeleteParams:{},fileUploadParams:{},fileUploadURL:"http://i.froala.com/upload",fileUploadParam:"file",maxFileSize:10485760}),t.Editable.prototype.showFileWrapper=function(){this.$file_wrapper&&this.$file_wrapper.show()},t.Editable.prototype.hideFileWrapper=function(){this.$file_wrapper&&(this.$file_wrapper.hide(),this.$file_wrapper.find("input").blur())},t.Editable.prototype.showFileUpload=function(){this.hidePopups(),this.showFileWrapper()},t.Editable.prototype.insertFile=function(){this.closeImageMode(),this.imageMode=!1,this.showFileUpload(),this.saveSelectionByMarkers(),this.options.inlineMode||this.positionPopup("uploadFile")},t.Editable.prototype.fileUploadHTML=function(){var e='<div class="froala-popup froala-file-popup" style="display: none;"><h4><span data-text="true">Upload file</span><i title="Cancel" class="fa fa-times" id="f-file-close-'+this._id+'"></i></h4>';return e+='<div id="f-file-list-'+this._id+'">',e+='<div class="f-popup-line drop-upload">',e+='<div class="f-upload" id="f-file-upload-div-'+this._id+'"><strong data-text="true">Drop File</strong><br>(<span data-text="true">or click</span>)<form target="file-frame-'+this._id+'" enctype="multipart/form-data" encoding="multipart/form-data" action="'+this.options.fileUploadURL+'" method="post" id="f-file-form-'+this._id+'"><input id="f-file-upload-'+this._id+'" type="file" name="'+this.options.fileUploadParam+'" accept="/*"></form></div>',this.browser.msie&&t.Editable.getIEversion()<=9&&(e+='<iframe id="file-frame-'+this._id+'" name="file-frame-'+this._id+'" src="javascript:false;" style="width:0; height:0; border:0px solid #FFF; position: fixed; z-index: -1;" data-loaded="true"></iframe>'),e+="</div>",e+="</div>",e+='<p class="f-progress" id="f-file-progress-'+this._id+'"><span></span></p>',e+="</div>"},t.Editable.prototype.buildFileDrag=function(){var e=this;e.$file_wrapper.on("dragover","#f-file-upload-div-"+this._id,function(){return t(this).addClass("f-hover"),!1}),e.$file_wrapper.on("dragend","#f-file-upload-div-"+this._id,function(){return t(this).removeClass("f-hover"),!1}),e.$file_wrapper.on("drop","#f-file-upload-div-"+this._id,function(i){i.preventDefault(),i.stopPropagation(),t(this).removeClass("f-hover"),e.uploadFile(i.originalEvent.dataTransfer.files)}),e.$element.on("drop",function(i){var s=i.originalEvent.dataTransfer.files;if(0===t(".froala-element img.fr-image-move").length&&i.originalEvent.dataTransfer&&s&&s.length){if(e.isDisabled)return!1;e.options.allowedImageTypes.indexOf(s[0].type.replace(/image\//g,""))<0&&(e.closeImageMode(),e.hide(),e.imageMode=!1,e.initialized||(e.$element.unbind("mousedown.element"),e.lateInit()),e.insertMarkersAtPoint(i.originalEvent),e.showByCoordinates(i.originalEvent.pageX,i.originalEvent.pageY),e.uploadFile(s),i.preventDefault(),i.stopPropagation())}})},t.Editable.prototype.buildFileUpload=function(){this.$file_wrapper=t(this.fileUploadHTML()),this.$popup_editor.append(this.$file_wrapper),this.buildFileDrag();var e=this;if(this.$file_wrapper.on("mouseup touchend",t.proxy(function(t){this.isResizing()||t.stopPropagation()},this)),this.addListener("hidePopups",t.proxy(function(){this.hideFileWrapper()}),this),this.$file_progress_bar=this.$file_wrapper.find("p#f-file-progress-"+this._id),this.browser.msie&&t.Editable.getIEversion()<=9){var i=this.$file_wrapper.find("iframe").get(0);i.attachEvent?i.attachEvent("onload",function(){e.iFrameLoad()}):i.onload=function(){e.iFrameLoad()}}this.$file_wrapper.on("change",'input[type="file"]',function(){if(void 0!==this.files)e.uploadFile(this.files);else{var i=t(this).parents("form");i.find('input[type="hidden"]').remove();var s;for(s in e.options.fileUploadParams)i.prepend('<input type="hidden" name="'+s+'" value="'+e.options.fileUploadParams[s]+'" />');e.$file_wrapper.find("#f-file-list-"+e._id).hide(),e.$file_progress_bar.show(),e.$file_progress_bar.find("span").css("width","100%").text("Please wait!"),e.showFileUpload(),i.submit()}t(this).val("")}),this.$file_wrapper.on(this.mouseup,"#f-file-close-"+this._id,t.proxy(function(t){t.stopPropagation(),t.preventDefault(),this.$bttn_wrapper.show(),this.hideFileWrapper(),this.restoreSelection(),this.focus(),this.hide()},this)),this.$file_wrapper.on("click",function(t){t.stopPropagation()}),this.$file_wrapper.on("click","*",function(t){t.stopPropagation()})},t.Editable.initializers.push(t.Editable.prototype.buildFileUpload),t.Editable.prototype.uploadFile=function(e){if(!this.triggerEvent("beforeFileUpload",[e],!1))return!1;if(void 0!==e&&e.length>0){var i;if(this.drag_support.formdata&&(i=this.drag_support.formdata?new FormData:null),i){var s;for(s in this.options.fileUploadParams)i.append(s,this.options.fileUploadParams[s]);if(i.append(this.options.fileUploadParam,e[0]),e[0].size>this.options.maxFileSize)return this.throwFileError(5),!1;if(this.options.allowedFileTypes.indexOf(e[0].type)<0&&this.options.allowedFileTypes.indexOf("*")<0)return this.throwFileError(6),!1}if(i){var a;if(this.options.crossDomain)a=this.createCORSRequest("POST",this.options.fileUploadURL);else{a=new XMLHttpRequest,a.open("POST",this.options.fileUploadURL);for(var o in this.options.headers)a.setRequestHeader(o,this.options.headers[o])}var n=e[0].name;a.onload=t.proxy(function(){this.$file_progress_bar.find("span").css("width","100%").text("Please wait!");try{a.status>=200&&a.status<300?this.parseFileResponse(a.responseText,n):this.throwFileError(3)}catch(t){this.throwFileError(4)}},this),a.onerror=t.proxy(function(){this.throwFileError(3)},this),a.upload.onprogress=t.proxy(function(t){if(t.lengthComputable){var e=t.loaded/t.total*100|0;this.$file_progress_bar.find("span").css("width",e+"%")}},this),a.send(i),this.$file_wrapper.find("#f-file-list-"+this._id).hide(),this.$file_progress_bar.show(),this.showFileUpload()}}},t.Editable.prototype.throwFileError=function(t){var e="Unknown file upload error.";1==t?e="Bad link.":2==t?e="No link in upload response.":3==t?e="Error during file upload.":4==t?e="Parsing response failed.":5==t?e="File too large.":6==t?e="Invalid file type.":7==t&&(e="File can be uploaded only to same domain in IE 8 and IE 9."),this.triggerEvent("fileError",[{code:t,message:e}],!1),this.hideFileLoader()},t.Editable.prototype.hideFileLoader=function(){this.$file_progress_bar.hide(),this.$file_progress_bar.find("span").css("width","0%").text(""),this.$file_wrapper.find("#f-file-list-"+this._id).show()},t.Editable.prototype.throwFileErrorWithMessage=function(t){this.triggerEvent("fileError",[{message:t,code:0}],!1),this.hideFileLoader()},t.Editable.prototype.parseFileResponse=function(e,i){try{var s=t.parseJSON(e);s.link?this.writeFile(s.link,i):s.error?this.throwFileErrorWithMessage(s.error):this.throwFileError(2)}catch(a){this.throwFileError(4)}},t.Editable.prototype.writeFile=function(t,e){this.restoreSelectionByMarkers(),this.focus(),this.insertHTML('<a class="fr-file" href="'+this.sanitizeURL(t)+'">'+e+"</a>"),this.hide(),this.hideFileLoader(),this.focus(),this.triggerEvent("fileUploaded",[e,t])}}(jQuery),!function(t){t.Editable.DEFAULTS=t.extend(t.Editable.DEFAULTS,{maxCharacters:-1,countCharacters:!0}),t.Editable.prototype.validKeyCode=function(t,e){return e?!1:t>47&&58>t||32==t||13==t||t>64&&91>t||t>95&&112>t||t>185&&193>t||t>218&&223>t},t.Editable.prototype.charNumber=function(){return this.getText().length},t.Editable.prototype.checkCharNumber=function(t,e,i){if(e.options.maxCharacters<0)return!0;if(e.charNumber()<e.options.maxCharacters)return!0;var s=i.which,a=(i.ctrlKey||i.metaKey)&&!i.altKey;return e.validKeyCode(s,a)?!1:!0},t.Editable.prototype.checkCharNumberOnPaste=function(e,i,s){if(i.options.maxCharacters<0)return!0;var a=t("<div>").html(s).text().length;return a+i.charNumber()<=i.options.maxCharacters?s:""},t.Editable.prototype.updateCharNumber=function(t,e){if(e.options.countCharacters){var i=e.charNumber()+(e.options.maxCharacters>0?"/"+e.options.maxCharacters:"");e.$box.attr("data-chars",i)}},t.Editable.prototype.initCharNumber=function(){this.$original_element.on("editable.keydown",this.checkCharNumber),this.$original_element.on("editable.onPaste",this.checkCharNumberOnPaste),this.$original_element.on("editable.keyup",this.updateCharNumber),this.$original_element.on("editable.contentChanged",this.updateCharNumber),this.updateCharNumber(null,this)},t.Editable.initializers.push(t.Editable.prototype.initCharNumber)}(jQuery);